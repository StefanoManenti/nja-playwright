globalThis.jotaiAtomCache = globalThis.jotaiAtomCache || {
  cache: /* @__PURE__ */ new Map(),
  get(name, inst) {
    if (this.cache.has(name)) {
      return this.cache.get(name);
    }
    this.cache.set(name, inst);
    return inst;
  }
};
import { ServiceBadInputError, ServiceExternalBadOutputError, ServiceUnhandledResponseError } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/util/src/index.ts";
import { currentContractInfoAtom } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/atoms/current-contract-info-atoms.ts";
import { API, generateOperationID } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/utils/index.ts";
import { areCheckBypassed } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/utils/flags.ts";
import { atomWithErrorReset } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/utils/atomWithRetryableQuery.ts";
export var StatoPdr = /* @__PURE__ */ ((StatoPdr2) => {
  StatoPdr2["Attivo"] = "ATTIVO";
  StatoPdr2["Disalimentato"] = "DISALIMENTATO";
  StatoPdr2["DisalimentatoA40"] = "DISALIMENTATO - A40";
  StatoPdr2["NonAttivabile"] = "NON ATTIVABILE";
  StatoPdr2["Libero"] = "LIBERO";
  StatoPdr2["LiberoA40"] = "LIBERO - A40";
  StatoPdr2["Inesistente"] = "INESISTENTE";
  StatoPdr2["OkTecnico"] = "OK_TECNICO";
  StatoPdr2["Errore"] = "ERRORE";
  StatoPdr2["Altro_Fornitore"] = "ATTIVO_ALTRO_FORNITORE";
  return StatoPdr2;
})(StatoPdr || {});
const url = `${API}/webOrderCommonServices/checkPdr`;
async function checkPdr(payload) {
  if (areCheckBypassed()) {
    return {
      status: "INESISTENTE" /* Inesistente */
    };
  }
  const logHash = generateOperationID();
  const response = await fetch(url, {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      Accept: "application/json"
    },
    body: JSON.stringify({
      PDR: payload.pdr,
      MatrContatRich: payload.matricola,
      source: "SALESUP",
      codiceAgente: "FAKE001002",
      logHash,
      idLead: payload.idLead,
      plicoCode: payload.plicoCode,
      salesProcessForLog: payload.salesProcessForLog
    })
  });
  if (response.status !== 200) {
    throw new ServiceUnhandledResponseError(response.statusText, logHash);
  }
  const data = await response.json();
  switch (data.esito) {
    case "KO_RESPONSE_NULL":
      throw new ServiceExternalBadOutputError(data.esito, logHash, data);
    case "KO_BAD_REQUEST":
    case "KO_INPUT_NON_VALIDO":
      throw new ServiceBadInputError(data.esito, logHash, data);
    case "OK":
      break;
    default:
      throw new ServiceUnhandledResponseError(data.esito, logHash, data);
  }
  const stato = data.stato;
  if (["ATTIVO", "DISALIMENTATO", "DISALIMENTATO - A40", "NON ATTIVABILE", "LIBERO", "LIBERO - A40", "INESISTENTE", "OK_TECNICO", "ATTIVO_ALTRO_FORNITORE", "ERRORE"].indexOf(stato) === -1) {
    throw new ServiceUnhandledResponseError(data.esito, logHash, data);
  }
  return {
    status: stato,
    logHash
  };
}
export const atomWithCheckPdr = (pdr) => {
  return atomWithErrorReset(async (get) => {
    const contract = get(currentContractInfoAtom);
    const idLead = contract.idLead;
    const plicoCode = await contract.plicoCode;
    const salesProcessForLog = await contract.salesProcessForLog;
    return checkPdr({
      idLead,
      plicoCode,
      salesProcessForLog,
      pdr
    });
  });
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBLFNBQ0VBLHNCQUNBQywrQkFDQUMscUNBQ0s7QUFDUCxTQUFTQywrQkFBK0I7QUFDeEMsU0FBU0MsS0FBS0MsMkJBQTJCO0FBQ3pDLFNBQVNDLHdCQUF3QjtBQUNqQyxTQUFTQywwQkFBMEI7QUFpQjVCLFdBQUtDLFdBQUwsa0JBQUtBLGNBQUw7QUFXTEMsd0JBQVM7QUFZVEMsK0JBQWdCO0FBV2hCQyxrQ0FBbUI7QUFhbkJDLCtCQUFnQjtBQVloQkMsd0JBQVM7QUFlVEMsMkJBQVk7QUFTWkMsNkJBQWM7QUFXZEMsMkJBQVk7QUFXWkMsd0JBQVM7QUFDVEMsaUNBQWtCO0FBMUdSVjtBQUFBQTtBQTZHWixNQUFNVyxNQUFNLEdBQUdmLEdBQUc7QUFFbEIsZUFBZWdCLFNBQVNDLFNBTXJCO0FBQ0QsTUFBSWYsaUJBQWlCLEdBQUc7QUFDdEIsV0FBTztBQUFBLE1BQ0xnQixRQUFRZDtBQUFBQSxJQUNWO0FBQUEsRUFDRjtBQUVBLFFBQU1lLFVBQVVsQixvQkFBb0I7QUFFcEMsUUFBTW1CLFdBQVcsTUFBTUMsTUFBTU4sS0FBSztBQUFBLElBQ2hDTyxRQUFRO0FBQUEsSUFDUkMsU0FBUztBQUFBLE1BQ1AsZ0JBQWdCO0FBQUEsTUFDaEJDLFFBQVE7QUFBQSxJQUNWO0FBQUEsSUFDQUMsTUFBTUMsS0FBS0MsVUFBVTtBQUFBLE1BQ25CQyxLQUFLWCxRQUFRWTtBQUFBQSxNQUNiQyxnQkFBZ0JiLFFBQVFjO0FBQUFBLE1BQ3hCQyxRQUFRO0FBQUEsTUFDUkMsY0FBYztBQUFBLE1BQ2RkO0FBQUFBLE1BQ0FlLFFBQVFqQixRQUFRaUI7QUFBQUEsTUFDaEJDLFdBQVdsQixRQUFRa0I7QUFBQUEsTUFDbkJDLG9CQUFvQm5CLFFBQVFtQjtBQUFBQSxJQUM5QixDQUFDO0FBQUEsRUFDSCxDQUFDO0FBRUQsTUFBSWhCLFNBQVNGLFdBQVcsS0FBSztBQUMzQixVQUFNLElBQUlwQiw4QkFBOEJzQixTQUFTaUIsWUFBWWxCLE9BQU87QUFBQSxFQUN0RTtBQUVBLFFBQU1tQixPQUFRLE1BQU1sQixTQUFTbUIsS0FBSztBQUVsQyxVQUFRRCxLQUFLRSxPQUFLO0FBQUEsSUFDaEIsS0FBSztBQUNILFlBQU0sSUFBSTNDLDhCQUE4QnlDLEtBQUtFLE9BQU9yQixTQUFTbUIsSUFBSTtBQUFBLElBQ25FLEtBQUs7QUFBQSxJQUNMLEtBQUs7QUFDSCxZQUFNLElBQUkxQyxxQkFBcUIwQyxLQUFLRSxPQUFPckIsU0FBU21CLElBQUk7QUFBQSxJQUMxRCxLQUFLO0FBQ0g7QUFBQSxJQUNGO0FBQ0UsWUFBTSxJQUFJeEMsOEJBQThCd0MsS0FBS0UsT0FBT3JCLFNBQVNtQixJQUFJO0FBQUEsRUFDckU7QUFFQSxRQUFNRyxRQUFRSCxLQUFLRztBQUVuQixNQUNFLENBQ0UsVUFDQSxpQkFDQSx1QkFDQSxrQkFDQSxVQUNBLGdCQUNBLGVBQ0EsY0FDQSwwQkFDQSxRQUFRLEVBQ1JDLFFBQVFELEtBQUssTUFBTSxJQUNyQjtBQUNBLFVBQU0sSUFBSTNDLDhCQUE4QndDLEtBQUtFLE9BQU9yQixTQUFTbUIsSUFBSTtBQUFBLEVBQ25FO0FBRUEsU0FBTztBQUFBLElBQ0xwQixRQUFRdUI7QUFBQUEsSUFDUnRCO0FBQUFBLEVBQ0Y7QUFDRjtBQUVPLGFBQU13QixtQkFBbUJBLENBQUNkLFFBQWdCO0FBQy9DLFNBQU8xQixtQkFBbUIsT0FBT3lDLFFBQVE7QUFDdkMsVUFBTUMsV0FBV0QsSUFBSTdDLHVCQUF1QjtBQUM1QyxVQUFNbUMsU0FBU1csU0FBU1g7QUFDeEIsVUFBTUMsWUFBWSxNQUFNVSxTQUFTVjtBQUNqQyxVQUFNQyxxQkFBcUIsTUFBTVMsU0FBU1Q7QUFFMUMsV0FBT3BCLFNBQVM7QUFBQSxNQUNka0I7QUFBQUEsTUFDQUM7QUFBQUEsTUFDQUM7QUFBQUEsTUFDQVA7QUFBQUEsSUFDRixDQUFDO0FBQUEsRUFDSCxDQUFDO0FBQ0giLCJuYW1lcyI6WyJTZXJ2aWNlQmFkSW5wdXRFcnJvciIsIlNlcnZpY2VFeHRlcm5hbEJhZE91dHB1dEVycm9yIiwiU2VydmljZVVuaGFuZGxlZFJlc3BvbnNlRXJyb3IiLCJjdXJyZW50Q29udHJhY3RJbmZvQXRvbSIsIkFQSSIsImdlbmVyYXRlT3BlcmF0aW9uSUQiLCJhcmVDaGVja0J5cGFzc2VkIiwiYXRvbVdpdGhFcnJvclJlc2V0IiwiU3RhdG9QZHIiLCJBdHRpdm8iLCJEaXNhbGltZW50YXRvIiwiRGlzYWxpbWVudGF0b0E0MCIsIk5vbkF0dGl2YWJpbGUiLCJMaWJlcm8iLCJMaWJlcm9BNDAiLCJJbmVzaXN0ZW50ZSIsIk9rVGVjbmljbyIsIkVycm9yZSIsIkFsdHJvX0Zvcm5pdG9yZSIsInVybCIsImNoZWNrUGRyIiwicGF5bG9hZCIsInN0YXR1cyIsImxvZ0hhc2giLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsIkFjY2VwdCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiUERSIiwicGRyIiwiTWF0ckNvbnRhdFJpY2giLCJtYXRyaWNvbGEiLCJzb3VyY2UiLCJjb2RpY2VBZ2VudGUiLCJpZExlYWQiLCJwbGljb0NvZGUiLCJzYWxlc1Byb2Nlc3NGb3JMb2ciLCJzdGF0dXNUZXh0IiwiZGF0YSIsImpzb24iLCJlc2l0byIsInN0YXRvIiwiaW5kZXhPZiIsImF0b21XaXRoQ2hlY2tQZHIiLCJnZXQiLCJjb250cmFjdCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlcyI6WyJjaGVja1Bkci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gIFNlcnZpY2VCYWRJbnB1dEVycm9yLFxyXG4gIFNlcnZpY2VFeHRlcm5hbEJhZE91dHB1dEVycm9yLFxyXG4gIFNlcnZpY2VVbmhhbmRsZWRSZXNwb25zZUVycm9yLFxyXG59IGZyb20gJ0BuYWotd28vdXRpbCc7XHJcbmltcG9ydCB7IGN1cnJlbnRDb250cmFjdEluZm9BdG9tIH0gZnJvbSAnLi4vLi4vYXRvbXMvY3VycmVudC1jb250cmFjdC1pbmZvLWF0b21zJztcclxuaW1wb3J0IHsgQVBJLCBnZW5lcmF0ZU9wZXJhdGlvbklEIH0gZnJvbSAnLi4vLi4vdXRpbHMnO1xyXG5pbXBvcnQgeyBhcmVDaGVja0J5cGFzc2VkIH0gZnJvbSAnLi4vLi4vdXRpbHMvZmxhZ3MnO1xyXG5pbXBvcnQgeyBhdG9tV2l0aEVycm9yUmVzZXQgfSBmcm9tICcuLi8uLi91dGlscy9hdG9tV2l0aFJldHJ5YWJsZVF1ZXJ5JztcclxuXHJcbnR5cGUgV1NPdXRwdXQgPSB7XHJcbiAgZXNpdG86ICdPSycgfCAnS09fUkVTUE9OU0VfTlVMTCcgfCAnS09fQkFEX1JFUVVFU1QnIHwgJ0tPX0lOUFVUX05PTl9WQUxJRE8nO1xyXG4gIHN0YXRvOiBTdGF0b1BkcjtcclxuICBjb250YXRvcmVQcmVzZW50ZTogYm9vbGVhbjtcclxuICBwZHI/OiBzdHJpbmc7XHJcbiAgbWF0cmljb2xhPzogc3RyaW5nO1xyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgQ2hlY2tQZHJWYWx1ZSA9IHtcclxuICBzdGF0dXM6IFN0YXRvUGRyO1xyXG4gIC8qKiBsb2doYXNoIHN1Ym1pdHRlZCB3aXRoIHRoZSByZXF1ZXN0ICovXHJcbiAgbG9nSGFzaDogc3RyaW5nO1xyXG4gIC8vIHBkcj86IHN0cmluZztcclxufTtcclxuXHJcbmV4cG9ydCBlbnVtIFN0YXRvUGRyIHtcclxuICAvKipcclxuICAgKiBfX1NpZ25pZmljYXRvIGZ1bnppb25hbGU6X19cclxuICAgKiBQRFIgZW5lcmdpenphdG8uXHJcbiAgICpcclxuICAgKiBfX1NpZ25pZmljYXRvOl9fXHJcbiAgICogUHVudG8gQXR0aXZvLlxyXG4gICAqXHJcbiAgICogX19BemlvbmUgd2ViOl9fXHJcbiAgICogS08gcGVyIHB1bnRvIG5vbiBhdHRpdmFiaWxlIHBlcmNow6kgZ2nDoCBhdHRpdm8uXHJcbiAgICovXHJcbiAgQXR0aXZvID0gJ0FUVElWTycsXHJcbiAgLyoqXHJcbiAgICogX19TaWduaWZpY2F0byBmdW56aW9uYWxlOl9fXHJcbiAgICogUGRSIGRpc2FsaW1lbnRhdG8uXHJcbiAgICpcclxuICAgKiBfX1NpZ25pZmljYXRvOl9fXHJcbiAgICogRGlzYWxpbWVudGF0by5cclxuICAgKlxyXG4gICAqIF9fQXppb25lIHdlYjpfX1xyXG4gICAqIE9LIC0gcHJvc2VndWlyZSBjb24gY29udHJvbGxvIHN1Y2Nlc3Npdm8uXHJcbiAgICogQ29uZmVybWFyZSBzYWxlcyBwcm9jZXNzIEEwMSDigJMgQXR0aXZhemlvbmUgc2VtcGxpY2VcclxuICAgKi9cclxuICBEaXNhbGltZW50YXRvID0gJ0RJU0FMSU1FTlRBVE8nLFxyXG4gIC8qKlxyXG4gICAqIF9fU2lnbmlmaWNhdG8gZnVuemlvbmFsZTpfX1xyXG4gICAqIFBkUiBkaXNhbGltZW50YXRvLlxyXG4gICAqXHJcbiAgICogX19TaWduaWZpY2F0bzpfX1xyXG4gICAqIERpc2FsaW1lbnRhdG8gbWEgc29nZ2V0dG8gYWQgQTQwLlxyXG4gICAqXHJcbiAgICogX19BemlvbmUgd2ViOl9fXHJcbiAgICogT0sgLSBQcm9zZWd1aXJlIGNvbiBjb250cm9sbG8gc3VjY2Vzc2l2byBtYSBtb2RpZmljYW5kbyBpbCB0aXBvIHByb2Nlc3NvIGluIEFUVElWQVpJT05FIENPTiBBQ0NFUlRBTUVOVE9cclxuICAgKi9cclxuICBEaXNhbGltZW50YXRvQTQwID0gJ0RJU0FMSU1FTlRBVE8gLSBBNDAnLFxyXG4gIC8qKlxyXG4gICAqIF9fU2lnbmlmaWNhdG8gZnVuemlvbmFsZTpfX1xyXG4gICAqIC0gUGRSIHNvZ2dldHRvIGEgY2Vzc2F6aW9uZSBhbW1pbmlzdHJhdGl2YVxyXG4gICAqIC0gb3BwdXJlIFBkUiBkaXNhbGltZW50YXRvIHBlciBpbnRlcnZlbnRvIHRlY25pY28gcGVyIG1lc3NhIGluIHNpY3VyZXp6YSBkZWxs4oCZaW1waWFudG9cclxuICAgKiAtIG9wcHVyZSBQdW50byBjb24gbWlzdXJhdG9yZSBpbnN0YWxsYXRvIGUgYXBlcnRvLCBtYSBub24gZXJvZ2EgZ2FzIHBlcmNow6kgc290dG9wb3N0byBhZCBpbnRlcnJ1emlvbmUgcGVyIG1vcm9zaXTDoCBjb21wbGVzc2EgKGVzLiB0YWdsaW8gY29sb25uYSlcclxuICAgKlxyXG4gICAqIF9fU2lnbmlmaWNhdG86X19cclxuICAgKiBQdW50byBub24gZGlzcG9uaWJpbGUgcGVyIGzigJlhdHRpdmF6aW9uZVxyXG4gICAqXHJcbiAgICogX19BemlvbmUgd2ViOl9fXHJcbiAgICogS08gcGVyIHB1bnRvIG5vbiBhdHRpdmFiaWxlIC0gY29udGF0dGFyZSBkaXN0cmlidXRvcmVcclxuICAgKi9cclxuICBOb25BdHRpdmFiaWxlID0gJ05PTiBBVFRJVkFCSUxFJyxcclxuICAvKipcclxuICAgKiBfX1NpZ25pZmljYXRvIGZ1bnppb25hbGU6X19cclxuICAgKiAtIElsIFBkUiBlc2lzdGUgZWQgw6ggbGliZXJvLCBtYSBub24gaGEgdW4gbWlzdXJhdG9yZSBpbnN0YWxsYXRvLlxyXG4gICAqIC0gb3BwdXJlIEFsbOKAmWluZGlyaXp6byBzcGVjaWZpY2F0byBlc2lzdGUgdW4gZWxlbmNvIGRpIFBkUiBsaWJlcmkuXHJcbiAgICpcclxuICAgKiBfX1NpZ25pZmljYXRvOl9fXHJcbiAgICogTGliZXJvXHJcbiAgICpcclxuICAgKiBfX0F6aW9uZSB3ZWI6X19cclxuICAgKiBPSyAtIHByb3NlZ3VpcmUgY29uIGNvbnRyb2xsbyBzdWNjZXNzaXZvLiBDb25mZXJtYXJlIHNhbGVzIHByb2Nlc3MgQTAxIOKAkyBBdHRpdmF6aW9uZSBzZW1wbGljZVxyXG4gICAqL1xyXG4gIExpYmVybyA9ICdMSUJFUk8nLFxyXG4gIC8qKlxyXG4gICAqIF9fU2lnbmlmaWNhdG8gZnVuemlvbmFsZTpfX1xyXG4gICAqIC0gSWwgUGRSIGVzaXN0ZSBlZCDDqCBsaWJlcm8sIG1hIG5vbiBoYSB1biBtaXN1cmF0b3JlIGluc3RhbGxhdG8uXHJcbiAgICogLSBvcHB1cmUgQWxs4oCZaW5kaXJpenpvIHNwZWNpZmljYXRvIGVzaXN0ZSB1biBlbGVuY28gZGkgUGRSIGxpYmVyaS5cclxuICAgKlxyXG4gICAqIF9fU2lnbmlmaWNhdG86X19cclxuICAgKiBMaWJlcm8gbWEgc29nZ2V0dG8gYWQgQTQwXHJcbiAgICpcclxuICAgKiBfX0F6aW9uZSB3ZWI6X19cclxuICAgKiBPSyAtIFByb3NlZ3VpcmUgY29uIGNvbnRyb2xsbyBzdWNjZXNzaXZvIG1hIG1vZGlmaWNhbmRvIGlsIHRpcG8gcHJvY2Vzc28gaW4gQVRUSVZBWklPTkUgQ09OIEFDQ0VSVEFNRU5UT1xyXG4gICAqXHJcbiAgICogVE9ETyBfX0FUVEVOWklPTkU6X19cclxuICAgKiBJbiBkb2N1bWVudGF6aW9uZSBlcmEgc2NyaXR0byBcIkRJU0FMSU1FTlRBVE8gLSBBNDBcIiBtYSBhYmJpYW1vIG1vZG8gZGkgcGVuc2FyZSBjaGUgc2lhIFwiTElCRVJPIC0gQTQwXCJcclxuICAgKi9cclxuICBMaWJlcm9BNDAgPSAnTElCRVJPIC0gQTQwJyxcclxuICAvKipcclxuICAgKiBfX1NpZ25pZmljYXRvIGZ1bnppb25hbGVfXzogSWwgUERSIGZvcm5pdG8gZGFsIGNsaWVudGUgbm9uIGVzaXN0ZS5cclxuICAgKlxyXG4gICAqIF9fU2lnbmlmaWNhdG9fXzogUHVudG8gaW5lc2lzdGVudGUgLSBwdW50byBub24gdHJvdmF0byBpbiBpbnRlZ3JhemlvbmUuXHJcbiAgICpcclxuICAgKiBfX0F6aW9uZSB3ZWJfXzogQWxlcnQgY2hlIG5vbiBzaSB0cm92YSBpbCBwdW50byBlIHNlIHNpIHZ1b2xlIGNvbXVucXVlXHJcbiAgICogY29udGludWFyZSAow6ggc29sbyB1biBhbGVydCwgc2kgcHXDsiBjb211bnF1ZSBwcm9jZWRlcmUgYWxsJ2luc2VyaW1lbnRvKS5cclxuICAgKi9cclxuICBJbmVzaXN0ZW50ZSA9ICdJTkVTSVNURU5URScsXHJcbiAgLyoqXHJcbiAgICogX19TaWduaWZpY2F0byBmdW56aW9uYWxlOl9fXHJcbiAgICogUERSIGNoaXVzbyBwZXIgbW9yb3NpdMOgXHJcbiAgICpcclxuICAgKiBfX1NpZ25pZmljYXRvOl9fXHJcbiAgICogUHVudG8gYXR0aXZhYmlsZVxyXG4gICAqXHJcbiAgICogX19BemlvbmUgd2ViOl9fXHJcbiAgICogT0ssIGlsIGZsdXNzbyBwcm9zZWd1ZSBzZW56YSBtb2RpZmljYXJlIGlsIHNhbGVzIHByb2Nlc3NcclxuICAgKi9cclxuICBPa1RlY25pY28gPSAnT0tfVEVDTklDTycsXHJcbiAgLyoqXHJcbiAgICogX19TaWduaWZpY2F0byBmdW56aW9uYWxlOl9fXHJcbiAgICogZXJyb3JlIHN1bGxhIGNoaWFtYXRhXHJcbiAgICpcclxuICAgKiBfX1NpZ25pZmljYXRvOl9fXHJcbiAgICogY2hpYW1hdGEgZm9ybWFsbWVudGUgbm9uIGNvcnJldHRhXHJcbiAgICpcclxuICAgKiBfX0F6aW9uZSB3ZWI6X19cclxuICAgKiBBbGVydCBjaGUgbm9uIHNpIHRyb3ZhIGlsIHB1bnRvIGUgc2Ugc2kgdnVvbGUgY29tdW5xdWUgY29udGludWFyZSAow6ggc29sbyB1biBhbGVydCwgc2kgcHXDsiBjb211bnF1ZSBwcm9jZWRlcmUgYWxsJ2luc2VyaW1lbnRvXHJcbiAgICovXHJcbiAgRXJyb3JlID0gJ0VSUk9SRScsXHJcbiAgQWx0cm9fRm9ybml0b3JlID0gJ0FUVElWT19BTFRST19GT1JOSVRPUkUnLFxyXG59XHJcblxyXG5jb25zdCB1cmwgPSBgJHtBUEl9L3dlYk9yZGVyQ29tbW9uU2VydmljZXMvY2hlY2tQZHJgO1xyXG5cclxuYXN5bmMgZnVuY3Rpb24gY2hlY2tQZHIocGF5bG9hZDoge1xyXG4gIHBkcj86IHN0cmluZztcclxuICBtYXRyaWNvbGE/OiBzdHJpbmc7XHJcbiAgaWRMZWFkOiBzdHJpbmc7XHJcbiAgcGxpY29Db2RlOiBzdHJpbmc7XHJcbiAgc2FsZXNQcm9jZXNzRm9yTG9nOiBzdHJpbmc7XHJcbn0pIHtcclxuICBpZiAoYXJlQ2hlY2tCeXBhc3NlZCgpKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdGF0dXM6IFN0YXRvUGRyLkluZXNpc3RlbnRlLFxyXG4gICAgfSBhcyBDaGVja1BkclZhbHVlO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgbG9nSGFzaCA9IGdlbmVyYXRlT3BlcmF0aW9uSUQoKTtcclxuXHJcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcclxuICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgaGVhZGVyczoge1xyXG4gICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICBBY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgIH0sXHJcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgIFBEUjogcGF5bG9hZC5wZHIsXHJcbiAgICAgIE1hdHJDb250YXRSaWNoOiBwYXlsb2FkLm1hdHJpY29sYSxcclxuICAgICAgc291cmNlOiAnU0FMRVNVUCcsXHJcbiAgICAgIGNvZGljZUFnZW50ZTogJ0ZBS0UwMDEwMDInLFxyXG4gICAgICBsb2dIYXNoOiBsb2dIYXNoLFxyXG4gICAgICBpZExlYWQ6IHBheWxvYWQuaWRMZWFkLFxyXG4gICAgICBwbGljb0NvZGU6IHBheWxvYWQucGxpY29Db2RlLFxyXG4gICAgICBzYWxlc1Byb2Nlc3NGb3JMb2c6IHBheWxvYWQuc2FsZXNQcm9jZXNzRm9yTG9nLFxyXG4gICAgfSksXHJcbiAgfSk7XHJcblxyXG4gIGlmIChyZXNwb25zZS5zdGF0dXMgIT09IDIwMCkge1xyXG4gICAgdGhyb3cgbmV3IFNlcnZpY2VVbmhhbmRsZWRSZXNwb25zZUVycm9yKHJlc3BvbnNlLnN0YXR1c1RleHQsIGxvZ0hhc2gpO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgZGF0YSA9IChhd2FpdCByZXNwb25zZS5qc29uKCkpIGFzIFdTT3V0cHV0O1xyXG5cclxuICBzd2l0Y2ggKGRhdGEuZXNpdG8pIHtcclxuICAgIGNhc2UgJ0tPX1JFU1BPTlNFX05VTEwnOlxyXG4gICAgICB0aHJvdyBuZXcgU2VydmljZUV4dGVybmFsQmFkT3V0cHV0RXJyb3IoZGF0YS5lc2l0bywgbG9nSGFzaCwgZGF0YSk7XHJcbiAgICBjYXNlICdLT19CQURfUkVRVUVTVCc6XHJcbiAgICBjYXNlICdLT19JTlBVVF9OT05fVkFMSURPJzpcclxuICAgICAgdGhyb3cgbmV3IFNlcnZpY2VCYWRJbnB1dEVycm9yKGRhdGEuZXNpdG8sIGxvZ0hhc2gsIGRhdGEpO1xyXG4gICAgY2FzZSAnT0snOlxyXG4gICAgICBicmVhaztcclxuICAgIGRlZmF1bHQ6XHJcbiAgICAgIHRocm93IG5ldyBTZXJ2aWNlVW5oYW5kbGVkUmVzcG9uc2VFcnJvcihkYXRhLmVzaXRvLCBsb2dIYXNoLCBkYXRhKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IHN0YXRvID0gZGF0YS5zdGF0bztcclxuXHJcbiAgaWYgKFxyXG4gICAgW1xyXG4gICAgICAnQVRUSVZPJyxcclxuICAgICAgJ0RJU0FMSU1FTlRBVE8nLFxyXG4gICAgICAnRElTQUxJTUVOVEFUTyAtIEE0MCcsXHJcbiAgICAgICdOT04gQVRUSVZBQklMRScsXHJcbiAgICAgICdMSUJFUk8nLFxyXG4gICAgICAnTElCRVJPIC0gQTQwJyxcclxuICAgICAgJ0lORVNJU1RFTlRFJyxcclxuICAgICAgJ09LX1RFQ05JQ08nLFxyXG4gICAgICAnQVRUSVZPX0FMVFJPX0ZPUk5JVE9SRScsXHJcbiAgICAgICdFUlJPUkUnLFxyXG4gICAgXS5pbmRleE9mKHN0YXRvKSA9PT0gLTFcclxuICApIHtcclxuICAgIHRocm93IG5ldyBTZXJ2aWNlVW5oYW5kbGVkUmVzcG9uc2VFcnJvcihkYXRhLmVzaXRvLCBsb2dIYXNoLCBkYXRhKTtcclxuICB9XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBzdGF0dXM6IHN0YXRvLFxyXG4gICAgbG9nSGFzaCxcclxuICB9IGFzIENoZWNrUGRyVmFsdWU7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBhdG9tV2l0aENoZWNrUGRyID0gKHBkcjogc3RyaW5nKSA9PiB7XHJcbiAgcmV0dXJuIGF0b21XaXRoRXJyb3JSZXNldChhc3luYyAoZ2V0KSA9PiB7XHJcbiAgICBjb25zdCBjb250cmFjdCA9IGdldChjdXJyZW50Q29udHJhY3RJbmZvQXRvbSk7XHJcbiAgICBjb25zdCBpZExlYWQgPSBjb250cmFjdC5pZExlYWQ7XHJcbiAgICBjb25zdCBwbGljb0NvZGUgPSBhd2FpdCBjb250cmFjdC5wbGljb0NvZGU7XHJcbiAgICBjb25zdCBzYWxlc1Byb2Nlc3NGb3JMb2cgPSBhd2FpdCBjb250cmFjdC5zYWxlc1Byb2Nlc3NGb3JMb2c7XHJcblxyXG4gICAgcmV0dXJuIGNoZWNrUGRyKHtcclxuICAgICAgaWRMZWFkLFxyXG4gICAgICBwbGljb0NvZGUsXHJcbiAgICAgIHNhbGVzUHJvY2Vzc0ZvckxvZyxcclxuICAgICAgcGRyLFxyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn07XHJcbiJdLCJmaWxlIjoiQzovVXNlcnMvYWludHJvbmEvRGVza3RvcC9BcHAvcmVhY3QvbmFqL2xpYnMvZGF0YS1hY2Nlc3Mvc3JjL2xpYi9hcGkvd2Vib3JkZXIvY2hlY2tQZHIudHMifQ==