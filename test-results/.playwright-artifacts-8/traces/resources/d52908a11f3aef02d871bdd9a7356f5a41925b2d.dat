globalThis.jotaiAtomCache = globalThis.jotaiAtomCache || {
  cache: /* @__PURE__ */ new Map(),
  get(name, inst) {
    if (this.cache.has(name)) {
      return this.cache.get(name);
    }
    this.cache.set(name, inst);
    return inst;
  }
};
import { checkMattoncini } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/offerta/corrispettivi/coupon.ts";
import { mf, PriceCalculatorV2 } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/offerta/corrispettivi/utils.ts";
export function parseCommercializzazioneVendita(payload, commodity, scontistica = {}) {
  if (payload == null) {
    return null;
  }
  let qty, unit;
  if (typeof payload === "string") {
    const match = payload.replace("&euro;", "€").match(/^([0-9,]+) +([^ ]+)(?: *\(([^)]+)\))?$/);
    if (!match) {
      return null;
    }
    [, qty, unit] = match;
  } else if (typeof payload === "object") {
    qty = payload.qty;
    unit = payload.unit;
  } else {
    return null;
  }
  const p = new PriceCalculatorV2().addDiscount({
    condition: commodity === "POWER" && checkMattoncini(scontistica.coupon?.infoLuce, "LS002A"),
    percent: scontistica.coupon?.infoLuce?.percentValue,
    from: "original",
    digits: 2
  }).addDiscount({
    condition: commodity === "GAS" && checkMattoncini(scontistica.coupon?.infoGas, "GS002A"),
    percent: scontistica.coupon?.infoGas?.percentValue,
    from: "original",
    digits: 2
  });
  return {
    name: {
      main: "Copertura costi di commercializzazione e vendita"
    },
    price: {
      type: "normal",
      unit: "€/anno",
      ...p.apply(mf(qty, 12))
      // Nel WO va mostrato solo il prezzo mese
      // info: '',
    }
  };
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUNBLFNBQVNBLHVCQUF1QjtBQUdoQyxTQUFTQyxJQUFJQyx5QkFBeUI7QUFFL0IsZ0JBQVNDLGdDQUNkQyxTQUNBQyxXQUNBQyxjQUEyQixDQUFDLEdBQ2hCO0FBRVosTUFBSUYsV0FBVyxNQUFNO0FBQ25CLFdBQU87QUFBQSxFQUNUO0FBRUEsTUFBSUcsS0FBYUM7QUFFakIsTUFBSSxPQUFPSixZQUFZLFVBQVU7QUFDL0IsVUFBTUssUUFBUUwsUUFDWE0sUUFBUSxVQUFVLEdBQUcsRUFDckJELE1BQU0sd0NBQXdDO0FBQ2pELFFBQUksQ0FBQ0EsT0FBTztBQUNWLGFBQU87QUFBQSxJQUNUO0FBRUEsT0FBR0YsS0FBS0MsSUFBSSxJQUFJQztBQUFBQSxFQUNsQixXQUFXLE9BQU9MLFlBQVksVUFBVTtBQUN0Q0csVUFBTUgsUUFBUUc7QUFDZEMsV0FBT0osUUFBUUk7QUFBQUEsRUFDakIsT0FBTztBQUNMLFdBQU87QUFBQSxFQUNUO0FBRUEsUUFBTUcsSUFBSSxJQUFJVCxrQkFBa0IsRUFDN0JVLFlBQVk7QUFBQSxJQUNYQyxXQUNFUixjQUFjLFdBQ2RMLGdCQUFnQk0sWUFBWVEsUUFBUUMsVUFBVSxRQUFRO0FBQUEsSUFDeERDLFNBQVNWLFlBQVlRLFFBQVFDLFVBQVVFO0FBQUFBLElBQ3ZDQyxNQUFNO0FBQUEsSUFDTkMsUUFBUTtBQUFBLEVBQ1YsQ0FBQyxFQUNBUCxZQUFZO0FBQUEsSUFDWEMsV0FDRVIsY0FBYyxTQUNkTCxnQkFBZ0JNLFlBQVlRLFFBQVFNLFNBQVMsUUFBUTtBQUFBLElBQ3ZESixTQUFTVixZQUFZUSxRQUFRTSxTQUFTSDtBQUFBQSxJQUN0Q0MsTUFBTTtBQUFBLElBQ05DLFFBQVE7QUFBQSxFQUNWLENBQUM7QUFFSCxTQUFPO0FBQUEsSUFDTEUsTUFBTTtBQUFBLE1BQ0pDLE1BQU07QUFBQSxJQUNSO0FBQUEsSUFDQUMsT0FBTztBQUFBLE1BQ0xDLE1BQU07QUFBQSxNQUNOaEIsTUFBTTtBQUFBLE1BQ04sR0FBR0csRUFBRWMsTUFBTXhCLEdBQUdNLEtBQUssRUFBRSxDQUFDO0FBQUE7QUFBQTtBQUFBLElBR3hCO0FBQUEsRUFDRjtBQUNGIiwibmFtZXMiOlsiY2hlY2tNYXR0b25jaW5pIiwibWYiLCJQcmljZUNhbGN1bGF0b3JWMiIsInBhcnNlQ29tbWVyY2lhbGl6emF6aW9uZVZlbmRpdGEiLCJwYXlsb2FkIiwiY29tbW9kaXR5Iiwic2NvbnRpc3RpY2EiLCJxdHkiLCJ1bml0IiwibWF0Y2giLCJyZXBsYWNlIiwicCIsImFkZERpc2NvdW50IiwiY29uZGl0aW9uIiwiY291cG9uIiwiaW5mb0x1Y2UiLCJwZXJjZW50IiwicGVyY2VudFZhbHVlIiwiZnJvbSIsImRpZ2l0cyIsImluZm9HYXMiLCJuYW1lIiwibWFpbiIsInByaWNlIiwidHlwZSIsImFwcGx5Il0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VzIjpbImNvbW1lcmNpYWxpenphemlvbmUtdmVuZGl0YS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBPZmZlcnRhU3RhdGVGb3JDb3JyaXNwZXR0aXZpIH0gZnJvbSAnLi4vdHlwZXMnO1xyXG5pbXBvcnQgeyBjaGVja01hdHRvbmNpbmkgfSBmcm9tICcuL2NvdXBvbic7XHJcbmltcG9ydCB7IFJvdyB9IGZyb20gJy4vcHJpY2VzJztcclxuaW1wb3J0IHsgU2NvbnRpc3RpY2EgfSBmcm9tICcuL3Njb250aXN0aWNhJztcclxuaW1wb3J0IHsgbWYsIFByaWNlQ2FsY3VsYXRvclYyIH0gZnJvbSAnLi91dGlscyc7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VDb21tZXJjaWFsaXp6YXppb25lVmVuZGl0YShcclxuICBwYXlsb2FkOiBPZmZlcnRhU3RhdGVGb3JDb3JyaXNwZXR0aXZpWydjb3N0aURpQ29tbWVyY2lhbGl6emF6aW9uZSddWydsdWNlJ10sXHJcbiAgY29tbW9kaXR5OiAnUE9XRVInIHwgJ0dBUycsXHJcbiAgc2NvbnRpc3RpY2E6IFNjb250aXN0aWNhID0ge31cclxuKTogUm93IHwgbnVsbCB7XHJcbiAgLy8gXCI3LDUgJmV1cm87L21lc2UgIChwYXJpIGEgOTAgJmV1cm87L2Fubm8gKVwiXHJcbiAgaWYgKHBheWxvYWQgPT0gbnVsbCkge1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICBsZXQgcXR5OiBzdHJpbmcsIHVuaXQ6IHN0cmluZztcclxuXHJcbiAgaWYgKHR5cGVvZiBwYXlsb2FkID09PSAnc3RyaW5nJykge1xyXG4gICAgY29uc3QgbWF0Y2ggPSBwYXlsb2FkXHJcbiAgICAgIC5yZXBsYWNlKCcmZXVybzsnLCAn4oKsJylcclxuICAgICAgLm1hdGNoKC9eKFswLTksXSspICsoW14gXSspKD86ICpcXCgoW14pXSspXFwpKT8kLyk7XHJcbiAgICBpZiAoIW1hdGNoKSB7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIFssIHF0eSwgdW5pdF0gPSBtYXRjaCBhcyBbc3RyaW5nLCBzdHJpbmcsIHN0cmluZ107XHJcbiAgfSBlbHNlIGlmICh0eXBlb2YgcGF5bG9hZCA9PT0gJ29iamVjdCcpIHtcclxuICAgIHF0eSA9IHBheWxvYWQucXR5O1xyXG4gICAgdW5pdCA9IHBheWxvYWQudW5pdDtcclxuICB9IGVsc2Uge1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICBjb25zdCBwID0gbmV3IFByaWNlQ2FsY3VsYXRvclYyKClcclxuICAgIC5hZGREaXNjb3VudCh7XHJcbiAgICAgIGNvbmRpdGlvbjpcclxuICAgICAgICBjb21tb2RpdHkgPT09ICdQT1dFUicgJiZcclxuICAgICAgICBjaGVja01hdHRvbmNpbmkoc2NvbnRpc3RpY2EuY291cG9uPy5pbmZvTHVjZSwgJ0xTMDAyQScpLFxyXG4gICAgICBwZXJjZW50OiBzY29udGlzdGljYS5jb3Vwb24/LmluZm9MdWNlPy5wZXJjZW50VmFsdWUsXHJcbiAgICAgIGZyb206ICdvcmlnaW5hbCcsXHJcbiAgICAgIGRpZ2l0czogMixcclxuICAgIH0pXHJcbiAgICAuYWRkRGlzY291bnQoe1xyXG4gICAgICBjb25kaXRpb246XHJcbiAgICAgICAgY29tbW9kaXR5ID09PSAnR0FTJyAmJlxyXG4gICAgICAgIGNoZWNrTWF0dG9uY2luaShzY29udGlzdGljYS5jb3Vwb24/LmluZm9HYXMsICdHUzAwMkEnKSxcclxuICAgICAgcGVyY2VudDogc2NvbnRpc3RpY2EuY291cG9uPy5pbmZvR2FzPy5wZXJjZW50VmFsdWUsXHJcbiAgICAgIGZyb206ICdvcmlnaW5hbCcsXHJcbiAgICAgIGRpZ2l0czogMixcclxuICAgIH0pO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgbmFtZToge1xyXG4gICAgICBtYWluOiAnQ29wZXJ0dXJhIGNvc3RpIGRpIGNvbW1lcmNpYWxpenphemlvbmUgZSB2ZW5kaXRhJyxcclxuICAgIH0sXHJcbiAgICBwcmljZToge1xyXG4gICAgICB0eXBlOiAnbm9ybWFsJyxcclxuICAgICAgdW5pdDogJ+KCrC9hbm5vJyxcclxuICAgICAgLi4ucC5hcHBseShtZihxdHksIDEyKSksXHJcbiAgICAgIC8vIE5lbCBXTyB2YSBtb3N0cmF0byBzb2xvIGlsIHByZXp6byBtZXNlXHJcbiAgICAgIC8vIGluZm86ICcnLFxyXG4gICAgfSxcclxuICB9O1xyXG59XHJcbiJdLCJmaWxlIjoiQzovVXNlcnMvYWludHJvbmEvRGVza3RvcC9BcHAvcmVhY3QvbmFqL2xpYnMvZGF0YS1hY2Nlc3Mvc3JjL2xpYi9vZmZlcnRhL2NvcnJpc3BldHRpdmkvY29tbWVyY2lhbGl6emF6aW9uZS12ZW5kaXRhLnRzIn0=