globalThis.jotaiAtomCache = globalThis.jotaiAtomCache || {
  cache: /* @__PURE__ */ new Map(),
  get(name, inst) {
    if (this.cache.has(name)) {
      return this.cache.get(name);
    }
    this.cache.set(name, inst);
    return inst;
  }
};
import { equals } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/util/src/index.ts";
import { CommodityObj } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/atoms/CommodityObj.ts";
import { OperativeMode } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/troubleshooting/types.ts";
export function sortProducts(a, b) {
  if (a.panel !== b.panel) {
    return (b.panel ? 1 : 0) - (a.panel ? 1 : 0);
  }
  if (a.broadband !== b.broadband) {
    return (b.broadband ? 1 : 0) - (a.broadband ? 1 : 0);
  }
  if (a.commodity?.power !== b.commodity?.power) {
    return (b.commodity?.power ? 1 : 0) - (a.commodity?.power ? 1 : 0);
  }
  return 0;
}
export function combineProducts(products) {
  if (products.length < 2) {
    return products;
  }
  for (let j = 0; j < products.length; j++) {
    for (let i = j + 1; i < products.length; i++) {
      const joinResult = products[j].join(products[i]);
      if (joinResult) {
        const workingProducts = [...combineProducts([...products.slice(0, j), joinResult, ...products.slice(j + 1, i), ...products.slice(i + 1)])];
        console.log("b", products.toString(), "==>", workingProducts.toString());
        return workingProducts;
      }
    }
  }
  return products;
}
export class CommodityWorkingProduct {
  constructor(commodity, operativeMode, addons = {}) {
    this.commodity = commodity;
    this.operativeMode = operativeMode;
    this.addons = addons;
    this.broadband = addons.broadband;
    this.panel = addons.panel;
  }
  get key() {
    return this.commodity.toString();
  }
  get description() {
    return [this.commodity.power && "power", this.commodity.gas && "gas", this.addons.broadband && "broadband", this.addons.panel && "panel"].filter(Boolean).join("+");
  }
  toString() {
    return this.description;
  }
  join(product) {
    if (product.panel) {
      return;
    }
    const checkOperativeMode = (operativeModes) => equals(this.operativeMode, ...operativeModes) && equals(product.operativeMode, ...operativeModes);
    const broadbandCheck = !product.broadband || checkOperativeMode([OperativeMode.BROADBAND, OperativeMode.SWITCH_IN, OperativeMode.SWITCH_IN_TRANSFER]);
    const commodityCheck = !product.commodity || product.operativeMode === this.operativeMode && this.operativeMode !== OperativeMode.NEW_ACTIVATION && product.operativeMode !== OperativeMode.NEW_ACTIVATION && this.commodity.toString() !== product.commodity.toString();
    if (broadbandCheck && commodityCheck) {
      return new CommodityWorkingProduct(new CommodityObj({
        power: this.commodity.power || product.commodity?.power,
        gas: this.commodity.gas || product.commodity?.gas
      }), this.operativeMode, {
        broadband: this.broadband || product.broadband,
        panel: this.panel || product.panel
      });
    }
  }
}
export class BroadbandWorkingProduct {
  constructor() {
    this.operativeMode = OperativeMode.BROADBAND;
    this.broadband = true;
  }
  get key() {
    return "broadband-standalone";
  }
  get description() {
    return "broadband";
  }
  toString() {
    return this.description;
  }
  join(product) {
    if (product instanceof CommodityWorkingProduct) {
      return product.join(this);
    }
  }
}
export class PanelWorkingProduct {
  constructor() {
    this.operativeMode = OperativeMode.VIRTUAL_PANEL;
    this.panel = true;
  }
  get key() {
    return "panel-standalone";
  }
  get description() {
    return "panel";
  }
  toString() {
    return this.description;
  }
  join(product) {
    return;
  }
}

//# sourceMappingURL=data:application/json;base64,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QUFDRiIsIm5hbWVzIjpbImVxdWFscyIsIkNvbW1vZGl0eU9iaiIsIk9wZXJhdGl2ZU1vZGUiLCJzb3J0UHJvZHVjdHMiLCJhIiwiYiIsInBhbmVsIiwiYnJvYWRiYW5kIiwiY29tbW9kaXR5IiwicG93ZXIiLCJjb21iaW5lUHJvZHVjdHMiLCJwcm9kdWN0cyIsImxlbmd0aCIsImoiLCJpIiwiam9pblJlc3VsdCIsImpvaW4iLCJ3b3JraW5nUHJvZHVjdHMiLCJzbGljZSIsImNvbnNvbGUiLCJsb2ciLCJ0b1N0cmluZyIsIkNvbW1vZGl0eVdvcmtpbmdQcm9kdWN0IiwiY29uc3RydWN0b3IiLCJvcGVyYXRpdmVNb2RlIiwiYWRkb25zIiwia2V5IiwiZGVzY3JpcHRpb24iLCJnYXMiLCJmaWx0ZXIiLCJCb29sZWFuIiwicHJvZHVjdCIsImNoZWNrT3BlcmF0aXZlTW9kZSIsIm9wZXJhdGl2ZU1vZGVzIiwiYnJvYWRiYW5kQ2hlY2siLCJCUk9BREJBTkQiLCJTV0lUQ0hfSU4iLCJTV0lUQ0hfSU5fVFJBTlNGRVIiLCJjb21tb2RpdHlDaGVjayIsIk5FV19BQ1RJVkFUSU9OIiwiQnJvYWRiYW5kV29ya2luZ1Byb2R1Y3QiLCJQYW5lbFdvcmtpbmdQcm9kdWN0IiwiVklSVFVBTF9QQU5FTCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlcyI6WyJXb3JraW5nUHJvZHVjdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBlcXVhbHMgfSBmcm9tICdAbmFqLXdvL3V0aWwnO1xyXG5pbXBvcnQgeyBDb21tb2RpdHlPYmogfSBmcm9tICcuLi9hdG9tcy9Db21tb2RpdHlPYmonO1xyXG5pbXBvcnQgeyBPcGVyYXRpdmVNb2RlIH0gZnJvbSAnLi90eXBlcyc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFdvcmtpbmdQcm9kdWN0IHtcclxuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xyXG4gIGtleTogc3RyaW5nO1xyXG5cclxuICAvLyBvZmZlcj86IE9mZmVyO1xyXG5cclxuICBjb21tb2RpdHk/OiBDb21tb2RpdHlPYmo7XHJcbiAgb3BlcmF0aXZlTW9kZT86IE9wZXJhdGl2ZU1vZGU7XHJcbiAgYnJvYWRiYW5kPzogYm9vbGVhbjtcclxuICBwYW5lbD86IGJvb2xlYW47XHJcbiAgLy8gaW5zdXJhbmNlPzogYm9vbGVhbjtcclxuXHJcbiAgam9pbihwcm9kdWN0OiBXb3JraW5nUHJvZHVjdCk6IFdvcmtpbmdQcm9kdWN0IHwgdW5kZWZpbmVkO1xyXG59XHJcblxyXG4vKiogQHNlZSBBcnJheS5zb3J0ICovXHJcbmV4cG9ydCBmdW5jdGlvbiBzb3J0UHJvZHVjdHMoYTogV29ya2luZ1Byb2R1Y3QsIGI6IFdvcmtpbmdQcm9kdWN0KSB7XHJcbiAgaWYgKGEucGFuZWwgIT09IGIucGFuZWwpIHtcclxuICAgIHJldHVybiAoYi5wYW5lbCA/IDEgOiAwKSAtIChhLnBhbmVsID8gMSA6IDApO1xyXG4gIH1cclxuICBpZiAoYS5icm9hZGJhbmQgIT09IGIuYnJvYWRiYW5kKSB7XHJcbiAgICByZXR1cm4gKGIuYnJvYWRiYW5kID8gMSA6IDApIC0gKGEuYnJvYWRiYW5kID8gMSA6IDApO1xyXG4gIH1cclxuICBpZiAoYS5jb21tb2RpdHk/LnBvd2VyICE9PSBiLmNvbW1vZGl0eT8ucG93ZXIpIHtcclxuICAgIHJldHVybiAoYi5jb21tb2RpdHk/LnBvd2VyID8gMSA6IDApIC0gKGEuY29tbW9kaXR5Py5wb3dlciA/IDEgOiAwKTtcclxuICB9XHJcbiAgcmV0dXJuIDA7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjb21iaW5lUHJvZHVjdHMoXHJcbiAgcHJvZHVjdHM6IHJlYWRvbmx5IFdvcmtpbmdQcm9kdWN0W11cclxuKTogcmVhZG9ubHkgV29ya2luZ1Byb2R1Y3RbXSB7XHJcbiAgaWYgKHByb2R1Y3RzLmxlbmd0aCA8IDIpIHtcclxuICAgIHJldHVybiBwcm9kdWN0cztcclxuICB9XHJcblxyXG4gIGZvciAobGV0IGogPSAwOyBqIDwgcHJvZHVjdHMubGVuZ3RoOyBqKyspIHtcclxuICAgIGZvciAobGV0IGkgPSBqICsgMTsgaSA8IHByb2R1Y3RzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IGpvaW5SZXN1bHQgPSBwcm9kdWN0c1tqXSEuam9pbihwcm9kdWN0c1tpXSEpO1xyXG4gICAgICBpZiAoam9pblJlc3VsdCkge1xyXG4gICAgICAgIGNvbnN0IHdvcmtpbmdQcm9kdWN0cyA9IFtcclxuICAgICAgICAgIC4uLmNvbWJpbmVQcm9kdWN0cyhbXHJcbiAgICAgICAgICAgIC4uLnByb2R1Y3RzLnNsaWNlKDAsIGopLFxyXG4gICAgICAgICAgICBqb2luUmVzdWx0LFxyXG4gICAgICAgICAgICAuLi5wcm9kdWN0cy5zbGljZShqICsgMSwgaSksXHJcbiAgICAgICAgICAgIC4uLnByb2R1Y3RzLnNsaWNlKGkgKyAxKSxcclxuICAgICAgICAgIF0pLFxyXG4gICAgICAgIF07XHJcbiAgICAgICAgY29uc29sZS5sb2coXHJcbiAgICAgICAgICAnYicsXHJcbiAgICAgICAgICBwcm9kdWN0cy50b1N0cmluZygpLFxyXG4gICAgICAgICAgJz09PicsXHJcbiAgICAgICAgICB3b3JraW5nUHJvZHVjdHMudG9TdHJpbmcoKVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgcmV0dXJuIHdvcmtpbmdQcm9kdWN0cztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHByb2R1Y3RzO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQ29tbW9kaXR5V29ya2luZ1Byb2R1Y3QgaW1wbGVtZW50cyBXb3JraW5nUHJvZHVjdCB7XHJcbiAgYnJvYWRiYW5kPzogYm9vbGVhbjtcclxuICBwYW5lbD86IGJvb2xlYW47XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHVibGljIHJlYWRvbmx5IGNvbW1vZGl0eTogQ29tbW9kaXR5T2JqLFxyXG4gICAgcHVibGljIHJlYWRvbmx5IG9wZXJhdGl2ZU1vZGU6IE9wZXJhdGl2ZU1vZGUsXHJcbiAgICByZWFkb25seSBhZGRvbnM6IHtcclxuICAgICAgYnJvYWRiYW5kPzogYm9vbGVhbjtcclxuICAgICAgcGFuZWw/OiBib29sZWFuO1xyXG4gICAgICAvLyBpbnN1cmFuY2U/OiBib29sZWFuO1xyXG4gICAgfSA9IHt9XHJcbiAgKSB7XHJcbiAgICB0aGlzLmJyb2FkYmFuZCA9IGFkZG9ucy5icm9hZGJhbmQ7XHJcbiAgICB0aGlzLnBhbmVsID0gYWRkb25zLnBhbmVsO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGtleSgpIHtcclxuICAgIHJldHVybiB0aGlzLmNvbW1vZGl0eS50b1N0cmluZygpO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGRlc2NyaXB0aW9uKCkge1xyXG4gICAgcmV0dXJuIFtcclxuICAgICAgdGhpcy5jb21tb2RpdHkucG93ZXIgJiYgJ3Bvd2VyJyxcclxuICAgICAgdGhpcy5jb21tb2RpdHkuZ2FzICYmICdnYXMnLFxyXG4gICAgICB0aGlzLmFkZG9ucy5icm9hZGJhbmQgJiYgJ2Jyb2FkYmFuZCcsXHJcbiAgICAgIHRoaXMuYWRkb25zLnBhbmVsICYmICdwYW5lbCcsXHJcbiAgICBdXHJcbiAgICAgIC5maWx0ZXIoQm9vbGVhbilcclxuICAgICAgLmpvaW4oJysnKTtcclxuICB9XHJcblxyXG4gIHRvU3RyaW5nKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuZGVzY3JpcHRpb247XHJcbiAgfVxyXG5cclxuICBqb2luKHByb2R1Y3Q6IFdvcmtpbmdQcm9kdWN0KTogV29ya2luZ1Byb2R1Y3QgfCB1bmRlZmluZWQge1xyXG4gICAgaWYgKHByb2R1Y3QucGFuZWwpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNoZWNrT3BlcmF0aXZlTW9kZSA9IChvcGVyYXRpdmVNb2RlczogT3BlcmF0aXZlTW9kZVtdKSA9PlxyXG4gICAgICBlcXVhbHModGhpcy5vcGVyYXRpdmVNb2RlLCAuLi5vcGVyYXRpdmVNb2RlcykgJiZcclxuICAgICAgZXF1YWxzKHByb2R1Y3Qub3BlcmF0aXZlTW9kZSwgLi4ub3BlcmF0aXZlTW9kZXMpO1xyXG5cclxuICAgIGNvbnN0IGJyb2FkYmFuZENoZWNrID1cclxuICAgICAgIXByb2R1Y3QuYnJvYWRiYW5kIHx8XHJcbiAgICAgIGNoZWNrT3BlcmF0aXZlTW9kZShbXHJcbiAgICAgICAgT3BlcmF0aXZlTW9kZS5CUk9BREJBTkQsXHJcbiAgICAgICAgT3BlcmF0aXZlTW9kZS5TV0lUQ0hfSU4sXHJcbiAgICAgICAgT3BlcmF0aXZlTW9kZS5TV0lUQ0hfSU5fVFJBTlNGRVIsXHJcbiAgICAgIF0pO1xyXG5cclxuICAgIGNvbnN0IGNvbW1vZGl0eUNoZWNrID1cclxuICAgICAgIXByb2R1Y3QuY29tbW9kaXR5IHx8XHJcbiAgICAgIChwcm9kdWN0Lm9wZXJhdGl2ZU1vZGUgPT09IHRoaXMub3BlcmF0aXZlTW9kZSAmJlxyXG4gICAgICAgIHRoaXMub3BlcmF0aXZlTW9kZSAhPT0gT3BlcmF0aXZlTW9kZS5ORVdfQUNUSVZBVElPTiAmJlxyXG4gICAgICAgIHByb2R1Y3Qub3BlcmF0aXZlTW9kZSAhPT0gT3BlcmF0aXZlTW9kZS5ORVdfQUNUSVZBVElPTiAmJlxyXG4gICAgICAgIHRoaXMuY29tbW9kaXR5LnRvU3RyaW5nKCkgIT09IHByb2R1Y3QuY29tbW9kaXR5LnRvU3RyaW5nKCkpO1xyXG5cclxuICAgIGlmIChicm9hZGJhbmRDaGVjayAmJiBjb21tb2RpdHlDaGVjaykge1xyXG4gICAgICByZXR1cm4gbmV3IENvbW1vZGl0eVdvcmtpbmdQcm9kdWN0KFxyXG4gICAgICAgIG5ldyBDb21tb2RpdHlPYmooe1xyXG4gICAgICAgICAgcG93ZXI6IHRoaXMuY29tbW9kaXR5LnBvd2VyIHx8IHByb2R1Y3QuY29tbW9kaXR5Py5wb3dlcixcclxuICAgICAgICAgIGdhczogdGhpcy5jb21tb2RpdHkuZ2FzIHx8IHByb2R1Y3QuY29tbW9kaXR5Py5nYXMsXHJcbiAgICAgICAgfSksXHJcbiAgICAgICAgdGhpcy5vcGVyYXRpdmVNb2RlLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGJyb2FkYmFuZDogdGhpcy5icm9hZGJhbmQgfHwgcHJvZHVjdC5icm9hZGJhbmQsXHJcbiAgICAgICAgICBwYW5lbDogdGhpcy5wYW5lbCB8fCBwcm9kdWN0LnBhbmVsLFxyXG4gICAgICAgIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBCcm9hZGJhbmRXb3JraW5nUHJvZHVjdCBpbXBsZW1lbnRzIFdvcmtpbmdQcm9kdWN0IHtcclxuICBvcGVyYXRpdmVNb2RlID0gT3BlcmF0aXZlTW9kZS5CUk9BREJBTkQ7XHJcbiAgYnJvYWRiYW5kID0gdHJ1ZTtcclxuXHJcbiAgZ2V0IGtleSgpIHtcclxuICAgIHJldHVybiAnYnJvYWRiYW5kLXN0YW5kYWxvbmUnO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGRlc2NyaXB0aW9uKCkge1xyXG4gICAgcmV0dXJuICdicm9hZGJhbmQnO1xyXG4gIH1cclxuXHJcbiAgdG9TdHJpbmcoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5kZXNjcmlwdGlvbjtcclxuICB9XHJcblxyXG4gIGpvaW4ocHJvZHVjdDogV29ya2luZ1Byb2R1Y3QpOiBXb3JraW5nUHJvZHVjdCB8IHVuZGVmaW5lZCB7XHJcbiAgICBpZiAocHJvZHVjdCBpbnN0YW5jZW9mIENvbW1vZGl0eVdvcmtpbmdQcm9kdWN0KSB7XHJcbiAgICAgIHJldHVybiBwcm9kdWN0LmpvaW4odGhpcyk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgUGFuZWxXb3JraW5nUHJvZHVjdCBpbXBsZW1lbnRzIFdvcmtpbmdQcm9kdWN0IHtcclxuICBvcGVyYXRpdmVNb2RlID0gT3BlcmF0aXZlTW9kZS5WSVJUVUFMX1BBTkVMO1xyXG4gIHBhbmVsID0gdHJ1ZTtcclxuXHJcbiAgZ2V0IGtleSgpIHtcclxuICAgIHJldHVybiAncGFuZWwtc3RhbmRhbG9uZSc7XHJcbiAgfVxyXG5cclxuICBnZXQgZGVzY3JpcHRpb24oKSB7XHJcbiAgICByZXR1cm4gJ3BhbmVsJztcclxuICB9XHJcblxyXG4gIHRvU3RyaW5nKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuZGVzY3JpcHRpb247XHJcbiAgfVxyXG5cclxuICBqb2luKHByb2R1Y3Q6IFdvcmtpbmdQcm9kdWN0KTogV29ya2luZ1Byb2R1Y3QgfCB1bmRlZmluZWQge1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxufVxyXG4iXSwiZmlsZSI6IkM6L1VzZXJzL2FpbnRyb25hL0Rlc2t0b3AvQXBwL3JlYWN0L25hai9saWJzL2RhdGEtYWNjZXNzL3NyYy9saWIvdHJvdWJsZXNob290aW5nL1dvcmtpbmdQcm9kdWN0LnRzIn0=