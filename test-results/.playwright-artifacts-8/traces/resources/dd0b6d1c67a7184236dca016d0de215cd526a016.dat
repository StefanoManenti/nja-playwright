globalThis.jotaiAtomCache = globalThis.jotaiAtomCache || {
  cache: /* @__PURE__ */ new Map(),
  get(name, inst) {
    if (this.cache.has(name)) {
      return this.cache.get(name);
    }
    this.cache.set(name, inst);
    return inst;
  }
};
import { atomAction, createOptimisticAtom, PreconditionFailedError } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/util/src/index.ts";
import { atom } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/node_modules/.vite/apps/naj/deps/jotai.js?v=0189a8d1";
import { atomWithCheckIban } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/api/weborder/checkIban.ts";
import { checkModelloAtom } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/api/weborder/checkModello.ts";
import { atomWithCheckTaxIdWithName } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/api/weborder/checkTaxIdWithName.ts";
import { isSamePaymentHolder } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/atoms-generators/atomWithPaymentHolder.ts";
import { isExistingAccount } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/atoms-generators/ExistingAccount.ts";
import { NewAccount } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/atoms-generators/NewAccount.ts";
import { TransferAccount } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/atoms-generators/TransferAccount.ts";
import { gasAtom, powerAtom } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/troubleshooting/atoms.ts";
import { Bill, Payment } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/troubleshooting/types.ts";
import { customerAtom } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/atoms/customer-atoms.ts";
import { atomWithNested, atomWithNestedReadable } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/atoms/utils/atom-with-nested.ts";
export const NEW_ACCOUNT = Symbol("NEW_ACCOUNT");
export const accountCodeSelectedAtom = globalThis.jotaiAtomCache.get("C:\\Users\\aintrona\\Desktop\\App\\react\\naj\\libs\\data-access\\src\\lib\\atoms\\account-selected-atoms.ts/accountCodeSelectedAtom", atom(NEW_ACCOUNT));
accountCodeSelectedAtom.debugLabel = "accountCodeSelectedAtom";
export const optimisticAccountCodeSelectedAtom = globalThis.jotaiAtomCache.get("C:\\Users\\aintrona\\Desktop\\App\\react\\naj\\libs\\data-access\\src\\lib\\atoms\\account-selected-atoms.ts/optimisticAccountCodeSelectedAtom", createOptimisticAtom(accountCodeSelectedAtom));
optimisticAccountCodeSelectedAtom.debugLabel = "optimisticAccountCodeSelectedAtom";
export const accountSelectedAtom = globalThis.jotaiAtomCache.get("C:\\Users\\aintrona\\Desktop\\App\\react\\naj\\libs\\data-access\\src\\lib\\atoms\\account-selected-atoms.ts/accountSelectedAtom", atom(async (get) => {
  const code = get(optimisticAccountCodeSelectedAtom);
  if (!code) return;
  if (typeof code === "object") {
    return code;
  }
  if (code === NEW_ACCOUNT) {
    const power = get(powerAtom);
    const gas = get(gasAtom);
    return new NewAccount(customerAtom, !!power, !!gas);
  }
  const customer = await get(customerAtom);
  const accounts = await get(customer.accounts);
  return accounts?.get(code);
}));
accountSelectedAtom.debugLabel = "accountSelectedAtom";
export const updateAccountForTransfer$ = globalThis.jotaiAtomCache.get("C:\\Users\\aintrona\\Desktop\\App\\react\\naj\\libs\\data-access\\src\\lib\\atoms\\account-selected-atoms.ts/updateAccountForTransfer$", atomAction(async (get, set, args) => {
  const account = await set(TransferAccount.new$, args);
  set(accountCodeSelectedAtom, account);
}));
updateAccountForTransfer$.debugLabel = "updateAccountForTransfer$";
function isTransferAccount(account) {
  return account instanceof TransferAccount;
}
export const accountTransferSelectedAtom = globalThis.jotaiAtomCache.get("C:\\Users\\aintrona\\Desktop\\App\\react\\naj\\libs\\data-access\\src\\lib\\atoms\\account-selected-atoms.ts/accountTransferSelectedAtom", atom(async (get) => {
  const account = await get(accountSelectedAtom);
  return isTransferAccount(account) ? account : void 0;
}));
accountTransferSelectedAtom.debugLabel = "accountTransferSelectedAtom";
export const oldCustomerForTransferAtom = globalThis.jotaiAtomCache.get("C:\\Users\\aintrona\\Desktop\\App\\react\\naj\\libs\\data-access\\src\\lib\\atoms\\account-selected-atoms.ts/oldCustomerForTransferAtom", atom(async (get) => {
  const transferAccount = await get(accountTransferSelectedAtom);
  return transferAccount?.oldCustomer;
}));
oldCustomerForTransferAtom.debugLabel = "oldCustomerForTransferAtom";
export const accountCodeAtom = globalThis.jotaiAtomCache.get("C:\\Users\\aintrona\\Desktop\\App\\react\\naj\\libs\\data-access\\src\\lib\\atoms\\account-selected-atoms.ts/accountCodeAtom", atom(async (get) => (await get(accountSelectedAtom))?.code));
accountCodeAtom.debugLabel = "accountCodeAtom";
export const supplyAddressSelectedAtom = atomWithNested(accountSelectedAtom, "supplyAddress");
export const supplyAddressAsStringAtom = atomWithNestedReadable(accountSelectedAtom, "supplyAddressAsString");
export const shippingAddressSelectedAtom = atomWithNested(accountSelectedAtom, "shippingAddress");
export const shippingAddressSameAsSupplyAtom = globalThis.jotaiAtomCache.get("C:\\Users\\aintrona\\Desktop\\App\\react\\naj\\libs\\data-access\\src\\lib\\atoms\\account-selected-atoms.ts/shippingAddressSameAsSupplyAtom", atom(async (get) => {
  const addressSupply = await get(supplyAddressSelectedAtom);
  const addressShipping = await get(shippingAddressSelectedAtom);
  return addressShipping?.egonCodeNumber === addressSupply?.egonCodeNumber;
}));
shippingAddressSameAsSupplyAtom.debugLabel = "shippingAddressSameAsSupplyAtom";
export const shippingAddressAsStringAtom = atomWithNestedReadable(accountSelectedAtom, "shippingAddressAsString");
export const paymentToolSelected$ = globalThis.jotaiAtomCache.get("C:\\Users\\aintrona\\Desktop\\App\\react\\naj\\libs\\data-access\\src\\lib\\atoms\\account-selected-atoms.ts/paymentToolSelected$", atom(async (get) => {
  const account = await get(accountSelectedAtom);
  if (!account) {
    throw new PreconditionFailedError("!account");
  }
  const paymentType = await get(account.paymentType$);
  if (paymentType !== Payment.DOMICILIATION) return;
  if (!account.paymentTool$) return;
  return get(account.paymentTool$);
}, async (get, set, tool) => {
  const account = await get(accountSelectedAtom);
  if (!account) {
    throw new PreconditionFailedError("!account");
  }
  const paymentType = await get(account.paymentType$);
  if (paymentType !== Payment.DOMICILIATION) {
    throw new PreconditionFailedError("account?.paymentType !== Payment.DIRECT");
  }
  const {
    ibanSeda
  } = await get(atomWithCheckIban(tool));
  if (tool.intestatario.type === "individual" && !await isSamePaymentHolder(get, account, tool.intestatario)) {
    await get(atomWithCheckTaxIdWithName(tool.intestatario));
  }
  if (tool.subscriber) {
    await get(atomWithCheckTaxIdWithName(tool.subscriber));
  }
  set(account.paymentTool$, {
    ...tool,
    ibanSeda
  });
}));
paymentToolSelected$.debugLabel = "paymentToolSelected$";
export const samePaymentHolderAtom = globalThis.jotaiAtomCache.get("C:\\Users\\aintrona\\Desktop\\App\\react\\naj\\libs\\data-access\\src\\lib\\atoms\\account-selected-atoms.ts/samePaymentHolderAtom", atom(async (get) => {
  const account = await get(accountSelectedAtom);
  if (!account) {
    throw new PreconditionFailedError("!account");
  }
  return get(account.samePaymentHolderAtom);
}));
samePaymentHolderAtom.debugLabel = "samePaymentHolderAtom";
export const checkCreditForCurrentPayment$ = globalThis.jotaiAtomCache.get("C:\\Users\\aintrona\\Desktop\\App\\react\\naj\\libs\\data-access\\src\\lib\\atoms\\account-selected-atoms.ts/checkCreditForCurrentPayment$", atom(async (get) => {
  const currentPayment = await get(accountSelectedAtom);
  const transferAccount = await get(accountTransferSelectedAtom);
  if (currentPayment == null) {
    throw new PreconditionFailedError("currentPayment is null");
  }
  if (currentPayment.checkCredit$ == null) {
    throw new PreconditionFailedError("cannot check currentPayment");
  }
  const {
    customerInWhitelist
  } = await get(currentPayment.checkCredit$);
  if (!customerInWhitelist && transferAccount) {
    await get(checkModelloAtom);
  }
}));
checkCreditForCurrentPayment$.debugLabel = "checkCreditForCurrentPayment$";
export const existingDomiciliation$ = globalThis.jotaiAtomCache.get("C:\\Users\\aintrona\\Desktop\\App\\react\\naj\\libs\\data-access\\src\\lib\\atoms\\account-selected-atoms.ts/existingDomiciliation$", atom(async (get) => {
  const account = await get(accountSelectedAtom);
  if (account && isExistingAccount(account)) {
    const p = await get(account.paymentTypeFromService$);
    return p === Payment.DOMICILIATION;
  }
}));
existingDomiciliation$.debugLabel = "existingDomiciliation$";
export const existingDigitalBill$ = globalThis.jotaiAtomCache.get("C:\\Users\\aintrona\\Desktop\\App\\react\\naj\\libs\\data-access\\src\\lib\\atoms\\account-selected-atoms.ts/existingDigitalBill$", atom(async (get) => {
  const account = await get(accountSelectedAtom);
  if (account && isExistingAccount(account)) {
    const p = await get(account.billTypeFromService$);
    return p === Bill.DIGITAL;
  }
}));
existingDigitalBill$.debugLabel = "existingDigitalBill$";
export const accountCommodity$ = globalThis.jotaiAtomCache.get("C:\\Users\\aintrona\\Desktop\\App\\react\\naj\\libs\\data-access\\src\\lib\\atoms\\account-selected-atoms.ts/accountCommodity$", atom(async (get) => {
  const account = await get(accountSelectedAtom);
  if (!account) {
    return;
  }
  return account.commodity;
}));
accountCommodity$.debugLabel = "accountCommodity$";

//# sourceMappingURL=data:application/json;base64,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Q0FBQyxDQUFDO0FBRUYwRCw4QkFBQXZDLGFBQUE7QUFHQSxhQUFBMkMseUJBQUE5QyxXQUFBQyxlQUFBQyxJQUFBLHVJQUFzQ3BCLEtBQUssT0FBT29CLFFBQVE7QUFDeEQsUUFBTVksVUFBVSxNQUFNWixJQUFJRyxtQkFBbUI7QUFDN0MsTUFBSVMsV0FBVzNCLGtCQUFrQjJCLE9BQU8sR0FBRztBQUN6QyxVQUFNaUMsSUFBSSxNQUFNN0MsSUFBSVksUUFBUWtDLHVCQUF1QjtBQUNuRCxXQUFPRCxNQUFNdEQsUUFBUXlDO0FBQUFBLEVBQ3ZCO0FBQ0YsQ0FBQyxDQUFDO0FBRUZZLHVCQUFBM0MsYUFBQTtBQUdBLGFBQUE4Qyx1QkFBQWpELFdBQUFDLGVBQUFDLElBQUEscUlBQW9DcEIsS0FBSyxPQUFPb0IsUUFBUTtBQUN0RCxRQUFNWSxVQUFVLE1BQU1aLElBQUlHLG1CQUFtQjtBQUM3QyxNQUFJUyxXQUFXM0Isa0JBQWtCMkIsT0FBTyxHQUFHO0FBQ3pDLFVBQU1pQyxJQUFJLE1BQU03QyxJQUFJWSxRQUFRb0Msb0JBQW9CO0FBQ2hELFdBQU9ILE1BQU12RCxLQUFLMkQ7QUFBQUEsRUFDcEI7QUFDRixDQUFDLENBQUM7QUFBQ0YscUJBQUE5QyxhQUFBO0FBRUgsYUFBQWlELG9CQUFBcEQsV0FBQUMsZUFBQUMsSUFBQSxrSUFBaUNwQixLQUFLLE9BQU9vQixRQUFRO0FBQ25ELFFBQU1ZLFVBQVUsTUFBTVosSUFBSUcsbUJBQW1CO0FBQzdDLE1BQUksQ0FBQ1MsU0FBUztBQUNaO0FBQUEsRUFDRjtBQUNBLFNBQU9BLFFBQVF1QztBQUNqQixDQUFDLENBQUM7QUFBQ0Qsa0JBQUFqRCxhQUFBIiwibmFtZXMiOlsiYXRvbUFjdGlvbiIsImNyZWF0ZU9wdGltaXN0aWNBdG9tIiwiUHJlY29uZGl0aW9uRmFpbGVkRXJyb3IiLCJhdG9tIiwiYXRvbVdpdGhDaGVja0liYW4iLCJjaGVja01vZGVsbG9BdG9tIiwiYXRvbVdpdGhDaGVja1RheElkV2l0aE5hbWUiLCJpc1NhbWVQYXltZW50SG9sZGVyIiwiaXNFeGlzdGluZ0FjY291bnQiLCJOZXdBY2NvdW50IiwiVHJhbnNmZXJBY2NvdW50IiwiZ2FzQXRvbSIsInBvd2VyQXRvbSIsIkJpbGwiLCJQYXltZW50IiwiY3VzdG9tZXJBdG9tIiwiYXRvbVdpdGhOZXN0ZWQiLCJhdG9tV2l0aE5lc3RlZFJlYWRhYmxlIiwiTkVXX0FDQ09VTlQiLCJTeW1ib2wiLCJhY2NvdW50Q29kZVNlbGVjdGVkQXRvbSIsImdsb2JhbFRoaXMiLCJqb3RhaUF0b21DYWNoZSIsImdldCIsImRlYnVnTGFiZWwiLCJvcHRpbWlzdGljQWNjb3VudENvZGVTZWxlY3RlZEF0b20iLCJhY2NvdW50U2VsZWN0ZWRBdG9tIiwiY29kZSIsInBvd2VyIiwiZ2FzIiwiY3VzdG9tZXIiLCJhY2NvdW50cyIsInVwZGF0ZUFjY291bnRGb3JUcmFuc2ZlciQiLCJzZXQiLCJhcmdzIiwiYWNjb3VudCIsIm5ldyQiLCJpc1RyYW5zZmVyQWNjb3VudCIsImFjY291bnRUcmFuc2ZlclNlbGVjdGVkQXRvbSIsInVuZGVmaW5lZCIsIm9sZEN1c3RvbWVyRm9yVHJhbnNmZXJBdG9tIiwidHJhbnNmZXJBY2NvdW50Iiwib2xkQ3VzdG9tZXIiLCJhY2NvdW50Q29kZUF0b20iLCJzdXBwbHlBZGRyZXNzU2VsZWN0ZWRBdG9tIiwic3VwcGx5QWRkcmVzc0FzU3RyaW5nQXRvbSIsInNoaXBwaW5nQWRkcmVzc1NlbGVjdGVkQXRvbSIsInNoaXBwaW5nQWRkcmVzc1NhbWVBc1N1cHBseUF0b20iLCJhZGRyZXNzU3VwcGx5IiwiYWRkcmVzc1NoaXBwaW5nIiwiZWdvbkNvZGVOdW1iZXIiLCJzaGlwcGluZ0FkZHJlc3NBc1N0cmluZ0F0b20iLCJwYXltZW50VG9vbFNlbGVjdGVkJCIsInBheW1lbnRUeXBlIiwicGF5bWVudFR5cGUkIiwiRE9NSUNJTElBVElPTiIsInBheW1lbnRUb29sJCIsInRvb2wiLCJpYmFuU2VkYSIsImludGVzdGF0YXJpbyIsInR5cGUiLCJzdWJzY3JpYmVyIiwic2FtZVBheW1lbnRIb2xkZXJBdG9tIiwiY2hlY2tDcmVkaXRGb3JDdXJyZW50UGF5bWVudCQiLCJjdXJyZW50UGF5bWVudCIsImNoZWNrQ3JlZGl0JCIsImN1c3RvbWVySW5XaGl0ZWxpc3QiLCJleGlzdGluZ0RvbWljaWxpYXRpb24kIiwicCIsInBheW1lbnRUeXBlRnJvbVNlcnZpY2UkIiwiZXhpc3RpbmdEaWdpdGFsQmlsbCQiLCJiaWxsVHlwZUZyb21TZXJ2aWNlJCIsIkRJR0lUQUwiLCJhY2NvdW50Q29tbW9kaXR5JCIsImNvbW1vZGl0eSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlcyI6WyJhY2NvdW50LXNlbGVjdGVkLWF0b21zLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgYXRvbUFjdGlvbixcclxuICBjcmVhdGVPcHRpbWlzdGljQXRvbSxcclxuICBQcmVjb25kaXRpb25GYWlsZWRFcnJvcixcclxufSBmcm9tICdAbmFqLXdvL3V0aWwnO1xyXG5pbXBvcnQgeyBBdG9tLCBhdG9tIH0gZnJvbSAnam90YWknO1xyXG5pbXBvcnQgeyBhdG9tV2l0aENoZWNrSWJhbiB9IGZyb20gJy4uL2FwaS93ZWJvcmRlci9jaGVja0liYW4nO1xyXG5pbXBvcnQgeyBjaGVja01vZGVsbG9BdG9tIH0gZnJvbSAnLi4vYXBpL3dlYm9yZGVyL2NoZWNrTW9kZWxsbyc7XHJcbmltcG9ydCB7IGF0b21XaXRoQ2hlY2tUYXhJZFdpdGhOYW1lIH0gZnJvbSAnLi4vYXBpL3dlYm9yZGVyL2NoZWNrVGF4SWRXaXRoTmFtZSc7XHJcbmltcG9ydCB7IGlzU2FtZVBheW1lbnRIb2xkZXIgfSBmcm9tICcuLi9hdG9tcy1nZW5lcmF0b3JzL2F0b21XaXRoUGF5bWVudEhvbGRlcic7XHJcbmltcG9ydCB7IGlzRXhpc3RpbmdBY2NvdW50IH0gZnJvbSAnLi4vYXRvbXMtZ2VuZXJhdG9ycy9FeGlzdGluZ0FjY291bnQnO1xyXG5pbXBvcnQgeyBOZXdBY2NvdW50IH0gZnJvbSAnLi4vYXRvbXMtZ2VuZXJhdG9ycy9OZXdBY2NvdW50JztcclxuaW1wb3J0IHsgVHJhbnNmZXJBY2NvdW50IH0gZnJvbSAnLi4vYXRvbXMtZ2VuZXJhdG9ycy9UcmFuc2ZlckFjY291bnQnO1xyXG5pbXBvcnQgeyBnYXNBdG9tLCBwb3dlckF0b20gfSBmcm9tICcuLi90cm91Ymxlc2hvb3RpbmcvYXRvbXMnO1xyXG5pbXBvcnQgeyBCaWxsLCBQYXltZW50IH0gZnJvbSAnLi4vdHJvdWJsZXNob290aW5nL3R5cGVzJztcclxuaW1wb3J0IHsgY3VzdG9tZXJBdG9tIH0gZnJvbSAnLi9jdXN0b21lci1hdG9tcyc7XHJcbmltcG9ydCB7IEFjY291bnQsIHR5cGUgTmV3UGF5bWVudFRvb2wsIHR5cGUgUGF5bWVudFRvb2wgfSBmcm9tICcuL3R5cGVzJztcclxuaW1wb3J0IHtcclxuICBhdG9tV2l0aE5lc3RlZCxcclxuICBhdG9tV2l0aE5lc3RlZFJlYWRhYmxlLFxyXG59IGZyb20gJy4vdXRpbHMvYXRvbS13aXRoLW5lc3RlZCc7XHJcblxyXG5leHBvcnQgY29uc3QgTkVXX0FDQ09VTlQ6IHVuaXF1ZSBzeW1ib2wgPSBTeW1ib2woJ05FV19BQ0NPVU5UJyk7XHJcblxyXG50eXBlIEFjY291bnRDb2RlID0gdHlwZW9mIE5FV19BQ0NPVU5UIHwgc3RyaW5nIHwgQWNjb3VudDtcclxuXHJcbi8vIFRPRE8gcHJlc2VsZXppb25lIGRhIGFyZWEgcHJpdmF0YT8gTWEgbGEgc2Vzc2lvbmUgZG92cmViYmUgZXNzZXJlIHZhbGlkYXRhIHByaW1hLi4uXHJcbmV4cG9ydCBjb25zdCBhY2NvdW50Q29kZVNlbGVjdGVkQXRvbSA9IGF0b208QWNjb3VudENvZGU+KE5FV19BQ0NPVU5UKTtcclxuXHJcbmV4cG9ydCBjb25zdCBvcHRpbWlzdGljQWNjb3VudENvZGVTZWxlY3RlZEF0b20gPVxyXG4gIGNyZWF0ZU9wdGltaXN0aWNBdG9tPEFjY291bnRDb2RlPihhY2NvdW50Q29kZVNlbGVjdGVkQXRvbSk7XHJcblxyXG4vKiogVG8gc2V0IHRoZSBhY2NvdW50LCB1c2Ugc2V0KGFjY291bnRDb2RlU2VsZWN0ZWRBdG9tLCB0cnVlKSAqL1xyXG5leHBvcnQgY29uc3QgYWNjb3VudFNlbGVjdGVkQXRvbTogQXRvbTxQcm9taXNlPEFjY291bnQgfCB1bmRlZmluZWQ+PiA9IGF0b20oXHJcbiAgYXN5bmMgKGdldCkgPT4ge1xyXG4gICAgY29uc3QgY29kZSA9IGdldChvcHRpbWlzdGljQWNjb3VudENvZGVTZWxlY3RlZEF0b20pO1xyXG4gICAgaWYgKCFjb2RlKSByZXR1cm47XHJcblxyXG4gICAgaWYgKHR5cGVvZiBjb2RlID09PSAnb2JqZWN0Jykge1xyXG4gICAgICByZXR1cm4gY29kZTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoY29kZSA9PT0gTkVXX0FDQ09VTlQpIHtcclxuICAgICAgY29uc3QgcG93ZXIgPSBnZXQocG93ZXJBdG9tKTtcclxuICAgICAgY29uc3QgZ2FzID0gZ2V0KGdhc0F0b20pO1xyXG5cclxuICAgICAgcmV0dXJuIG5ldyBOZXdBY2NvdW50KGN1c3RvbWVyQXRvbSwgISFwb3dlciwgISFnYXMpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGN1c3RvbWVyID0gYXdhaXQgZ2V0KGN1c3RvbWVyQXRvbSk7XHJcbiAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGdldChjdXN0b21lci5hY2NvdW50cyk7XHJcbiAgICByZXR1cm4gYWNjb3VudHM/LmdldChjb2RlKTtcclxuICB9XHJcbik7XHJcblxyXG5leHBvcnQgY29uc3QgdXBkYXRlQWNjb3VudEZvclRyYW5zZmVyJCA9IGF0b21BY3Rpb24oXHJcbiAgYXN5bmMgKFxyXG4gICAgZ2V0LFxyXG4gICAgc2V0LFxyXG4gICAgYXJnczoge1xyXG4gICAgICBwb2Q/OiBzdHJpbmc7XHJcbiAgICAgIHBkcj86IHN0cmluZztcclxuICAgICAgdGF4SWQ6IHN0cmluZztcclxuICAgIH1cclxuICApID0+IHtcclxuICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBzZXQoVHJhbnNmZXJBY2NvdW50Lm5ldyQsIGFyZ3MpO1xyXG4gICAgc2V0KGFjY291bnRDb2RlU2VsZWN0ZWRBdG9tLCBhY2NvdW50KTtcclxuICB9XHJcbik7XHJcblxyXG5mdW5jdGlvbiBpc1RyYW5zZmVyQWNjb3VudChcclxuICBhY2NvdW50OiBBY2NvdW50IHwgdW5kZWZpbmVkXHJcbik6IGFjY291bnQgaXMgVHJhbnNmZXJBY2NvdW50IHtcclxuICByZXR1cm4gYWNjb3VudCBpbnN0YW5jZW9mIFRyYW5zZmVyQWNjb3VudDtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGFjY291bnRUcmFuc2ZlclNlbGVjdGVkQXRvbSA9IGF0b20oYXN5bmMgKGdldCkgPT4ge1xyXG4gIGNvbnN0IGFjY291bnQgPSBhd2FpdCBnZXQoYWNjb3VudFNlbGVjdGVkQXRvbSk7XHJcbiAgcmV0dXJuIGlzVHJhbnNmZXJBY2NvdW50KGFjY291bnQpID8gYWNjb3VudCA6IHVuZGVmaW5lZDtcclxufSk7XHJcblxyXG5leHBvcnQgY29uc3Qgb2xkQ3VzdG9tZXJGb3JUcmFuc2ZlckF0b20gPSBhdG9tKGFzeW5jIChnZXQpID0+IHtcclxuICBjb25zdCB0cmFuc2ZlckFjY291bnQgPSBhd2FpdCBnZXQoYWNjb3VudFRyYW5zZmVyU2VsZWN0ZWRBdG9tKTtcclxuICByZXR1cm4gdHJhbnNmZXJBY2NvdW50Py5vbGRDdXN0b21lcjtcclxufSk7XHJcblxyXG5leHBvcnQgY29uc3QgYWNjb3VudENvZGVBdG9tID0gYXRvbShcclxuICBhc3luYyAoZ2V0KSA9PiAoYXdhaXQgZ2V0KGFjY291bnRTZWxlY3RlZEF0b20pKT8uY29kZVxyXG4pO1xyXG5cclxuZXhwb3J0IGNvbnN0IHN1cHBseUFkZHJlc3NTZWxlY3RlZEF0b20gPSBhdG9tV2l0aE5lc3RlZChcclxuICBhY2NvdW50U2VsZWN0ZWRBdG9tLFxyXG4gICdzdXBwbHlBZGRyZXNzJ1xyXG4pO1xyXG5cclxuZXhwb3J0IGNvbnN0IHN1cHBseUFkZHJlc3NBc1N0cmluZ0F0b20gPSBhdG9tV2l0aE5lc3RlZFJlYWRhYmxlKFxyXG4gIGFjY291bnRTZWxlY3RlZEF0b20sXHJcbiAgJ3N1cHBseUFkZHJlc3NBc1N0cmluZydcclxuKTtcclxuXHJcbmV4cG9ydCBjb25zdCBzaGlwcGluZ0FkZHJlc3NTZWxlY3RlZEF0b20gPSBhdG9tV2l0aE5lc3RlZChcclxuICBhY2NvdW50U2VsZWN0ZWRBdG9tLFxyXG4gICdzaGlwcGluZ0FkZHJlc3MnXHJcbik7XHJcblxyXG5leHBvcnQgY29uc3Qgc2hpcHBpbmdBZGRyZXNzU2FtZUFzU3VwcGx5QXRvbSA9IGF0b20oYXN5bmMgKGdldCkgPT4ge1xyXG4gIGNvbnN0IGFkZHJlc3NTdXBwbHkgPSBhd2FpdCBnZXQoc3VwcGx5QWRkcmVzc1NlbGVjdGVkQXRvbSk7XHJcbiAgY29uc3QgYWRkcmVzc1NoaXBwaW5nID0gYXdhaXQgZ2V0KHNoaXBwaW5nQWRkcmVzc1NlbGVjdGVkQXRvbSk7XHJcbiAgcmV0dXJuIGFkZHJlc3NTaGlwcGluZz8uZWdvbkNvZGVOdW1iZXIgPT09IGFkZHJlc3NTdXBwbHk/LmVnb25Db2RlTnVtYmVyO1xyXG59KTtcclxuXHJcbmV4cG9ydCBjb25zdCBzaGlwcGluZ0FkZHJlc3NBc1N0cmluZ0F0b20gPSBhdG9tV2l0aE5lc3RlZFJlYWRhYmxlKFxyXG4gIGFjY291bnRTZWxlY3RlZEF0b20sXHJcbiAgJ3NoaXBwaW5nQWRkcmVzc0FzU3RyaW5nJ1xyXG4pO1xyXG5cclxuZXhwb3J0IGNvbnN0IHBheW1lbnRUb29sU2VsZWN0ZWQkID0gYXRvbShcclxuICBhc3luYyAoZ2V0KSA9PiB7XHJcbiAgICBjb25zdCBhY2NvdW50ID0gYXdhaXQgZ2V0KGFjY291bnRTZWxlY3RlZEF0b20pO1xyXG4gICAgaWYgKCFhY2NvdW50KSB7XHJcbiAgICAgIHRocm93IG5ldyBQcmVjb25kaXRpb25GYWlsZWRFcnJvcignIWFjY291bnQnKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBwYXltZW50VHlwZSA9IGF3YWl0IGdldChhY2NvdW50LnBheW1lbnRUeXBlJCk7XHJcbiAgICBpZiAocGF5bWVudFR5cGUgIT09IFBheW1lbnQuRE9NSUNJTElBVElPTikgcmV0dXJuO1xyXG5cclxuICAgIGlmICghYWNjb3VudC5wYXltZW50VG9vbCQpIHJldHVybjtcclxuICAgIHJldHVybiBnZXQoYWNjb3VudC5wYXltZW50VG9vbCQpIGFzIFBheW1lbnRUb29sO1xyXG4gIH0sXHJcbiAgYXN5bmMgKGdldCwgc2V0LCB0b29sOiBOZXdQYXltZW50VG9vbCkgPT4ge1xyXG4gICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGdldChhY2NvdW50U2VsZWN0ZWRBdG9tKTtcclxuICAgIGlmICghYWNjb3VudCkge1xyXG4gICAgICB0aHJvdyBuZXcgUHJlY29uZGl0aW9uRmFpbGVkRXJyb3IoJyFhY2NvdW50Jyk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcGF5bWVudFR5cGUgPSBhd2FpdCBnZXQoYWNjb3VudC5wYXltZW50VHlwZSQpO1xyXG4gICAgaWYgKHBheW1lbnRUeXBlICE9PSBQYXltZW50LkRPTUlDSUxJQVRJT04pIHtcclxuICAgICAgdGhyb3cgbmV3IFByZWNvbmRpdGlvbkZhaWxlZEVycm9yKFxyXG4gICAgICAgICdhY2NvdW50Py5wYXltZW50VHlwZSAhPT0gUGF5bWVudC5ESVJFQ1QnXHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyBpYmFuU2VkYSB9ID0gYXdhaXQgZ2V0KGF0b21XaXRoQ2hlY2tJYmFuKHRvb2wpKTtcclxuXHJcbiAgICAvKiBDaGVjayBUQVggSUQgaWYgaW50ZXN0YXRhcmlvIGlzIEluZGl2aWR1YWwgYW5kIGRpZmZlcmVudCBmcm9tIGN1c3RvbWVyLiAqL1xyXG4gICAgaWYgKFxyXG4gICAgICB0b29sLmludGVzdGF0YXJpby50eXBlID09PSAnaW5kaXZpZHVhbCcgJiZcclxuICAgICAgIShhd2FpdCBpc1NhbWVQYXltZW50SG9sZGVyKGdldCwgYWNjb3VudCwgdG9vbC5pbnRlc3RhdGFyaW8pKVxyXG4gICAgKSB7XHJcbiAgICAgIGF3YWl0IGdldChhdG9tV2l0aENoZWNrVGF4SWRXaXRoTmFtZSh0b29sLmludGVzdGF0YXJpbykpO1xyXG4gICAgfVxyXG4gICAgaWYgKHRvb2wuc3Vic2NyaWJlcikge1xyXG4gICAgICBhd2FpdCBnZXQoYXRvbVdpdGhDaGVja1RheElkV2l0aE5hbWUodG9vbC5zdWJzY3JpYmVyKSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0KGFjY291bnQucGF5bWVudFRvb2wkLCB7IC4uLnRvb2wsIGliYW5TZWRhIH0pO1xyXG4gIH1cclxuKTtcclxuXHJcbi8qKlxyXG4gKiBAc2VlIGF0b21XaXRoUGF5bWVudEhvbGRlclxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IHNhbWVQYXltZW50SG9sZGVyQXRvbSA9IGF0b20oYXN5bmMgKGdldCkgPT4ge1xyXG4gIGNvbnN0IGFjY291bnQgPSBhd2FpdCBnZXQoYWNjb3VudFNlbGVjdGVkQXRvbSk7XHJcbiAgaWYgKCFhY2NvdW50KSB7XHJcbiAgICB0aHJvdyBuZXcgUHJlY29uZGl0aW9uRmFpbGVkRXJyb3IoJyFhY2NvdW50Jyk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gZ2V0KGFjY291bnQuc2FtZVBheW1lbnRIb2xkZXJBdG9tKTtcclxufSk7XHJcblxyXG5leHBvcnQgY29uc3QgY2hlY2tDcmVkaXRGb3JDdXJyZW50UGF5bWVudCQgPSBhdG9tKGFzeW5jIChnZXQpID0+IHtcclxuICBjb25zdCBjdXJyZW50UGF5bWVudCA9IGF3YWl0IGdldChhY2NvdW50U2VsZWN0ZWRBdG9tKTtcclxuICBjb25zdCB0cmFuc2ZlckFjY291bnQgPSBhd2FpdCBnZXQoYWNjb3VudFRyYW5zZmVyU2VsZWN0ZWRBdG9tKTtcclxuICBpZiAoY3VycmVudFBheW1lbnQgPT0gbnVsbCkge1xyXG4gICAgdGhyb3cgbmV3IFByZWNvbmRpdGlvbkZhaWxlZEVycm9yKCdjdXJyZW50UGF5bWVudCBpcyBudWxsJyk7XHJcbiAgfVxyXG4gIGlmIChjdXJyZW50UGF5bWVudC5jaGVja0NyZWRpdCQgPT0gbnVsbCkge1xyXG4gICAgdGhyb3cgbmV3IFByZWNvbmRpdGlvbkZhaWxlZEVycm9yKCdjYW5ub3QgY2hlY2sgY3VycmVudFBheW1lbnQnKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IHsgY3VzdG9tZXJJbldoaXRlbGlzdCB9ID0gYXdhaXQgZ2V0KGN1cnJlbnRQYXltZW50LmNoZWNrQ3JlZGl0JCk7XHJcbiAgaWYgKCFjdXN0b21lckluV2hpdGVsaXN0ICYmIHRyYW5zZmVyQWNjb3VudCkge1xyXG4gICAgYXdhaXQgZ2V0KGNoZWNrTW9kZWxsb0F0b20pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vKipcclxuICogVGhlIGFjY291bnQgaXMgYWxyZWFkeSBleGlzdGluZywgYW5kIGl0IGhhcyBkb21pY2lsaWF0aW9uLlxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IGV4aXN0aW5nRG9taWNpbGlhdGlvbiQgPSBhdG9tKGFzeW5jIChnZXQpID0+IHtcclxuICBjb25zdCBhY2NvdW50ID0gYXdhaXQgZ2V0KGFjY291bnRTZWxlY3RlZEF0b20pO1xyXG4gIGlmIChhY2NvdW50ICYmIGlzRXhpc3RpbmdBY2NvdW50KGFjY291bnQpKSB7XHJcbiAgICBjb25zdCBwID0gYXdhaXQgZ2V0KGFjY291bnQucGF5bWVudFR5cGVGcm9tU2VydmljZSQpO1xyXG4gICAgcmV0dXJuIHAgPT09IFBheW1lbnQuRE9NSUNJTElBVElPTjtcclxuICB9XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIFRoZSBhY2NvdW50IGlzIGFscmVhZHkgZXhpc3RpbmcsIGFuZCBpdCBoYXMgZGlnaXRhbCBiaWxsLlxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IGV4aXN0aW5nRGlnaXRhbEJpbGwkID0gYXRvbShhc3luYyAoZ2V0KSA9PiB7XHJcbiAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGdldChhY2NvdW50U2VsZWN0ZWRBdG9tKTtcclxuICBpZiAoYWNjb3VudCAmJiBpc0V4aXN0aW5nQWNjb3VudChhY2NvdW50KSkge1xyXG4gICAgY29uc3QgcCA9IGF3YWl0IGdldChhY2NvdW50LmJpbGxUeXBlRnJvbVNlcnZpY2UkKTtcclxuICAgIHJldHVybiBwID09PSBCaWxsLkRJR0lUQUw7XHJcbiAgfVxyXG59KTtcclxuXHJcbmV4cG9ydCBjb25zdCBhY2NvdW50Q29tbW9kaXR5JCA9IGF0b20oYXN5bmMgKGdldCkgPT4ge1xyXG4gIGNvbnN0IGFjY291bnQgPSBhd2FpdCBnZXQoYWNjb3VudFNlbGVjdGVkQXRvbSk7XHJcbiAgaWYgKCFhY2NvdW50KSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIHJldHVybiBhY2NvdW50LmNvbW1vZGl0eTtcclxufSk7XHJcbiJdLCJmaWxlIjoiQzovVXNlcnMvYWludHJvbmEvRGVza3RvcC9BcHAvcmVhY3QvbmFqL2xpYnMvZGF0YS1hY2Nlc3Mvc3JjL2xpYi9hdG9tcy9hY2NvdW50LXNlbGVjdGVkLWF0b21zLnRzIn0=