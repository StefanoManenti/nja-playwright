globalThis.jotaiAtomCache = globalThis.jotaiAtomCache || {
  cache: /* @__PURE__ */ new Map(),
  get(name, inst) {
    if (this.cache.has(name)) {
      return this.cache.get(name);
    }
    this.cache.set(name, inst);
    return inst;
  }
};
export class EgonAddress {
  constructor(data) {
    this.iso3 = data.iso3;
    this.istatCode = data.istatCode;
    this.streetToponym = data.streetToponym;
    this.streetName = data.streetName;
    this.number = data.number;
    this.exponent = data.exponent;
    this.city = data.city;
    this.zipcode = data.zipcode;
    this.extendedProvince = data.extendedProvince;
    this.province = data.province;
    this.country = data.country;
    this.region = data.region;
    this.egonCodeStreet = data.egonCodeStreet;
    this.egonCodeNumber = data.egonCodeNumber;
  }
  get numberComplete() {
    return `${this.number}${this.exponent}`;
  }
  static fromNormalizeAddressService(data) {
    const inr620 = data["INR_620"];
    return new EgonAddress({
      iso3: inr620["CDXISO"] || inr620["DSXPLCSIG"]["DSXCNY"],
      istatCode: inr620["CDXSTAPLCOBJ"]["CDXCNL"],
      streetToponym: inr620["DSXSTRUFF"]["DSXST1"]["DSXDUG"] || inr620["INRCND"][0]["ST1CND"].split(" ")[0],
      streetName: inr620["DSXSTRUFF"]["DSXST1"]["DSXVIA"],
      number: inr620["CIVICOST1"]["NRPNUMCIV"]["lValue"] || "",
      exponent: inr620["CIVICOST1"]["DSXESP"],
      city: inr620["DSXPLCUFF"]["DSXCNL"],
      zipcode: inr620["CDXZIP"],
      extendedProvince: inr620["DSXPLCUFF"]["DSXDPT"],
      province: inr620["DSXPLCSIG"]["DSXDPT"],
      country: inr620["DSXPLCUFF"]["DSXCNY"],
      region: inr620["DSXPLCUFF"]["DSXREG"],
      egonCodeStreet: inr620["CDPSTRST1"]["CDPSTR"]["lValue"],
      egonCodeNumber: inr620["CIVICOST1"]["CDPOBJCIV"]["lValue"]
    });
  }
  asLeadFormat(opts = {}) {
    if (opts.fallbackIfForeign && this.iso3 === EgonAddress.FOREIGN_ISO3) {
      return {
        ...opts.fallbackIfForeign.asLeadFormat(),
        foreignAddress: true
      };
    }
    return {
      toponymy: this.streetToponym,
      address: this.streetName,
      houseNumber: this.numberComplete,
      city: this.city,
      province: this.province,
      zipCode: this.zipcode,
      istatCode: this.istatCode,
      streetCode: this.egonCodeStreet,
      civicEgonCode: this.egonCodeNumber,
      extendedProvince: this.extendedProvince,
      country: this.country,
      region: this.region,
      foreignAddress: this.iso3 === EgonAddress.FOREIGN_ISO3
    };
  }
  static fromLeadFormat(data) {
    if (data == null) {
      return;
    }
    if (data.foreignAddress) {
      return EgonAddress.fromForeign();
    }
    let number = "", exponent = "";
    const houseNumberMatch = data.houseNumber?.match(/([\d+]*)([A-Za-z]*)/);
    if (houseNumberMatch) {
      number = houseNumberMatch[1] ?? "";
      exponent = houseNumberMatch[2] ?? "";
    } else {
      number = data.houseNumber;
    }
    return new EgonAddress({
      iso3: this.ITA_ISO3,
      streetToponym: data.toponymy,
      streetName: data.address,
      number,
      exponent,
      city: data.city,
      province: data.province,
      zipcode: data.zipCode,
      istatCode: data.istatCode,
      egonCodeStreet: data.streetCode,
      egonCodeNumber: data.civicEgonCode,
      extendedProvince: data.extendedProvince,
      country: data.country,
      region: data.region
    });
  }
  static fromCheckD365Format(data) {
    return new EgonAddress({
      // @ts-expect-error no map
      iso3: null,
      streetToponym: data.toponomastica,
      streetName: data.via,
      number: data.civico,
      exponent: "",
      city: data.comune,
      province: data.prov,
      zipcode: data.cap,
      istatCode: data.codiceIstatComune,
      egonCodeStreet: data.codiceEgon,
      egonCodeNumber: data.codiceEgon,
      // @ts-expect-error no map
      extendedProvince: null,
      // @ts-expect-error no map
      country: null,
      // @ts-expect-error no map
      region: null
    });
  }
  static {
    this.ITA_ISO3 = "ITA";
  }
  static {
    // XXX is used to represent a person of unspecified nationality.
    this.FOREIGN_ISO3 = "XXX";
  }
  static fromForeign() {
    return new EgonAddress({
      city: "",
      country: "",
      egonCodeNumber: 0,
      egonCodeStreet: 0,
      exponent: "",
      extendedProvince: "",
      istatCode: "",
      number: "",
      province: "",
      region: "",
      streetName: "",
      streetToponym: "",
      zipcode: "",
      iso3: this.FOREIGN_ISO3
    });
  }
  asSuggestion() {
    return {
      id: this.egonCodeStreet,
      iso3: this.iso3,
      level: "",
      country: this.country,
      exponent: this.exponent,
      number: this.number,
      region: this.region,
      province: this.province,
      city: this.city,
      zipcode: this.zipcode,
      street: `${this.streetToponym} ${this.streetName}`
    };
  }
  toString() {
    if (this.iso3 === EgonAddress.FOREIGN_ISO3) {
      return "Estero";
    }
    return egonToString(this.asSuggestion());
  }
}
export function egonToString({
  city = "",
  street = "",
  zipcode = "",
  exponent = "",
  province = "",
  number = ""
}) {
  return [street, [number, exponent].filter(Boolean).join(""), [zipcode, city, province].filter(Boolean).join(" ")].filter(Boolean).join(", ");
}

//# sourceMappingURL=data:application/json;base64,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LEdBQUcsS0FBSzVDLGFBQWEsSUFBSSxLQUFLQyxVQUFVO0FBQUEsSUFDbEQ7QUFBQSxFQUNGO0FBQUEsRUFFQTRDLFdBQVc7QUFDVCxRQUFJLEtBQUsvQyxTQUFTSCxZQUFZd0IsY0FBYztBQUMxQyxhQUFPO0FBQUEsSUFDVDtBQUNBLFdBQU8yQixhQUFhLEtBQUtMLGFBQWEsQ0FBQztBQUFBLEVBQ3pDO0FBQ0Y7QUF3Q08sZ0JBQVNLLGFBQWE7QUFBQSxFQUMzQjFDLE9BQU87QUFBQSxFQUNQd0MsU0FBUztBQUFBLEVBQ1R2QyxVQUFVO0FBQUEsRUFDVkYsV0FBVztBQUFBLEVBQ1hJLFdBQVc7QUFBQSxFQUNYTCxTQUFTO0FBQ0ssR0FBRztBQUNqQixTQUFPLENBQ0wwQyxRQUNBLENBQUMxQyxRQUFRQyxRQUFRLEVBQUU0QyxPQUFPQyxPQUFPLEVBQUVDLEtBQUssRUFBRSxHQUMxQyxDQUFDNUMsU0FBU0QsTUFBTUcsUUFBUSxFQUFFd0MsT0FBT0MsT0FBTyxFQUFFQyxLQUFLLEdBQUcsQ0FBQyxFQUVsREYsT0FBT0MsT0FBTyxFQUNkQyxLQUFLLElBQUk7QUFDZCIsIm5hbWVzIjpbIkVnb25BZGRyZXNzIiwiY29uc3RydWN0b3IiLCJkYXRhIiwiaXNvMyIsImlzdGF0Q29kZSIsInN0cmVldFRvcG9ueW0iLCJzdHJlZXROYW1lIiwibnVtYmVyIiwiZXhwb25lbnQiLCJjaXR5IiwiemlwY29kZSIsImV4dGVuZGVkUHJvdmluY2UiLCJwcm92aW5jZSIsImNvdW50cnkiLCJyZWdpb24iLCJlZ29uQ29kZVN0cmVldCIsImVnb25Db2RlTnVtYmVyIiwibnVtYmVyQ29tcGxldGUiLCJmcm9tTm9ybWFsaXplQWRkcmVzc1NlcnZpY2UiLCJpbnI2MjAiLCJzcGxpdCIsImFzTGVhZEZvcm1hdCIsIm9wdHMiLCJmYWxsYmFja0lmRm9yZWlnbiIsIkZPUkVJR05fSVNPMyIsImZvcmVpZ25BZGRyZXNzIiwidG9wb255bXkiLCJhZGRyZXNzIiwiaG91c2VOdW1iZXIiLCJ6aXBDb2RlIiwic3RyZWV0Q29kZSIsImNpdmljRWdvbkNvZGUiLCJmcm9tTGVhZEZvcm1hdCIsImZyb21Gb3JlaWduIiwiaG91c2VOdW1iZXJNYXRjaCIsIm1hdGNoIiwiSVRBX0lTTzMiLCJmcm9tQ2hlY2tEMzY1Rm9ybWF0IiwidG9wb25vbWFzdGljYSIsInZpYSIsImNpdmljbyIsImNvbXVuZSIsInByb3YiLCJjYXAiLCJjb2RpY2VJc3RhdENvbXVuZSIsImNvZGljZUVnb24iLCJhc1N1Z2dlc3Rpb24iLCJpZCIsImxldmVsIiwic3RyZWV0IiwidG9TdHJpbmciLCJlZ29uVG9TdHJpbmciLCJmaWx0ZXIiLCJCb29sZWFuIiwiam9pbiJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlcyI6WyJ0eXBlcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IExlYWRBZGRyZXNzIH0gZnJvbSAnLi4vbGVhZC9fdHlwZXMnO1xyXG5pbXBvcnQgdHlwZSB7IENoZWNrRDM2NVJlc3BvbnNlIH0gZnJvbSAnLi4vd2Vib3JkZXIvdHlwZXMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIEVnb25BZGRyZXNzIHtcclxuICBwdWJsaWMgcmVhZG9ubHkgaXNvMzogc3RyaW5nO1xyXG4gIHB1YmxpYyByZWFkb25seSBpc3RhdENvZGU6IHN0cmluZztcclxuICBwdWJsaWMgcmVhZG9ubHkgc3RyZWV0VG9wb255bTogc3RyaW5nO1xyXG4gIHB1YmxpYyByZWFkb25seSBzdHJlZXROYW1lOiBzdHJpbmc7XHJcbiAgcHVibGljIHJlYWRvbmx5IG51bWJlcjogc3RyaW5nO1xyXG4gIHB1YmxpYyByZWFkb25seSBleHBvbmVudDogc3RyaW5nO1xyXG4gIHB1YmxpYyByZWFkb25seSBjaXR5OiBzdHJpbmc7XHJcbiAgcHVibGljIHJlYWRvbmx5IHppcGNvZGU6IHN0cmluZztcclxuICBwdWJsaWMgcmVhZG9ubHkgZXh0ZW5kZWRQcm92aW5jZTogc3RyaW5nO1xyXG4gIHB1YmxpYyByZWFkb25seSBwcm92aW5jZTogc3RyaW5nO1xyXG4gIHB1YmxpYyByZWFkb25seSBjb3VudHJ5OiBzdHJpbmc7XHJcbiAgcHVibGljIHJlYWRvbmx5IHJlZ2lvbjogc3RyaW5nO1xyXG4gIHB1YmxpYyByZWFkb25seSBlZ29uQ29kZVN0cmVldDogbnVtYmVyO1xyXG4gIHB1YmxpYyByZWFkb25seSBlZ29uQ29kZU51bWJlcjogbnVtYmVyO1xyXG5cclxuICBjb25zdHJ1Y3RvcihkYXRhOiB7XHJcbiAgICBpc28zOiBzdHJpbmc7XHJcbiAgICBpc3RhdENvZGU6IHN0cmluZztcclxuICAgIHN0cmVldFRvcG9ueW06IHN0cmluZztcclxuICAgIHN0cmVldE5hbWU6IHN0cmluZztcclxuICAgIG51bWJlcjogc3RyaW5nO1xyXG4gICAgZXhwb25lbnQ6IHN0cmluZztcclxuICAgIGNpdHk6IHN0cmluZztcclxuICAgIHppcGNvZGU6IHN0cmluZztcclxuICAgIGV4dGVuZGVkUHJvdmluY2U6IHN0cmluZztcclxuICAgIHByb3ZpbmNlOiBzdHJpbmc7XHJcbiAgICBjb3VudHJ5OiBzdHJpbmc7XHJcbiAgICByZWdpb246IHN0cmluZztcclxuICAgIGVnb25Db2RlU3RyZWV0OiBudW1iZXI7XHJcbiAgICBlZ29uQ29kZU51bWJlcjogbnVtYmVyO1xyXG4gIH0pIHtcclxuICAgIHRoaXMuaXNvMyA9IGRhdGEuaXNvMztcclxuICAgIHRoaXMuaXN0YXRDb2RlID0gZGF0YS5pc3RhdENvZGU7XHJcbiAgICB0aGlzLnN0cmVldFRvcG9ueW0gPSBkYXRhLnN0cmVldFRvcG9ueW07XHJcbiAgICB0aGlzLnN0cmVldE5hbWUgPSBkYXRhLnN0cmVldE5hbWU7XHJcbiAgICB0aGlzLm51bWJlciA9IGRhdGEubnVtYmVyO1xyXG4gICAgdGhpcy5leHBvbmVudCA9IGRhdGEuZXhwb25lbnQ7XHJcbiAgICB0aGlzLmNpdHkgPSBkYXRhLmNpdHk7XHJcbiAgICB0aGlzLnppcGNvZGUgPSBkYXRhLnppcGNvZGU7XHJcbiAgICB0aGlzLmV4dGVuZGVkUHJvdmluY2UgPSBkYXRhLmV4dGVuZGVkUHJvdmluY2U7XHJcbiAgICB0aGlzLnByb3ZpbmNlID0gZGF0YS5wcm92aW5jZTtcclxuICAgIHRoaXMuY291bnRyeSA9IGRhdGEuY291bnRyeTtcclxuICAgIHRoaXMucmVnaW9uID0gZGF0YS5yZWdpb247XHJcbiAgICB0aGlzLmVnb25Db2RlU3RyZWV0ID0gZGF0YS5lZ29uQ29kZVN0cmVldDtcclxuICAgIHRoaXMuZWdvbkNvZGVOdW1iZXIgPSBkYXRhLmVnb25Db2RlTnVtYmVyO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBudW1iZXJDb21wbGV0ZSgpIHtcclxuICAgIHJldHVybiBgJHt0aGlzLm51bWJlcn0ke3RoaXMuZXhwb25lbnR9YDtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBmcm9tTm9ybWFsaXplQWRkcmVzc1NlcnZpY2UoZGF0YTogYW55KSB7XHJcbiAgICBjb25zdCBpbnI2MjAgPSBkYXRhWydJTlJfNjIwJ107XHJcbiAgICByZXR1cm4gbmV3IEVnb25BZGRyZXNzKHtcclxuICAgICAgaXNvMzogaW5yNjIwWydDRFhJU08nXSB8fCBpbnI2MjBbJ0RTWFBMQ1NJRyddWydEU1hDTlknXSxcclxuICAgICAgaXN0YXRDb2RlOiBpbnI2MjBbJ0NEWFNUQVBMQ09CSiddWydDRFhDTkwnXSxcclxuICAgICAgc3RyZWV0VG9wb255bTpcclxuICAgICAgICBpbnI2MjBbJ0RTWFNUUlVGRiddWydEU1hTVDEnXVsnRFNYRFVHJ10gfHxcclxuICAgICAgICBpbnI2MjBbJ0lOUkNORCddWzBdWydTVDFDTkQnXS5zcGxpdCgnICcpWzBdLFxyXG4gICAgICBzdHJlZXROYW1lOiBpbnI2MjBbJ0RTWFNUUlVGRiddWydEU1hTVDEnXVsnRFNYVklBJ10sXHJcbiAgICAgIG51bWJlcjogaW5yNjIwWydDSVZJQ09TVDEnXVsnTlJQTlVNQ0lWJ11bJ2xWYWx1ZSddIHx8ICcnLFxyXG4gICAgICBleHBvbmVudDogaW5yNjIwWydDSVZJQ09TVDEnXVsnRFNYRVNQJ10sXHJcbiAgICAgIGNpdHk6IGlucjYyMFsnRFNYUExDVUZGJ11bJ0RTWENOTCddLFxyXG4gICAgICB6aXBjb2RlOiBpbnI2MjBbJ0NEWFpJUCddLFxyXG4gICAgICBleHRlbmRlZFByb3ZpbmNlOiBpbnI2MjBbJ0RTWFBMQ1VGRiddWydEU1hEUFQnXSxcclxuICAgICAgcHJvdmluY2U6IGlucjYyMFsnRFNYUExDU0lHJ11bJ0RTWERQVCddLFxyXG4gICAgICBjb3VudHJ5OiBpbnI2MjBbJ0RTWFBMQ1VGRiddWydEU1hDTlknXSxcclxuICAgICAgcmVnaW9uOiBpbnI2MjBbJ0RTWFBMQ1VGRiddWydEU1hSRUcnXSxcclxuICAgICAgZWdvbkNvZGVTdHJlZXQ6IGlucjYyMFsnQ0RQU1RSU1QxJ11bJ0NEUFNUUiddWydsVmFsdWUnXSxcclxuICAgICAgZWdvbkNvZGVOdW1iZXI6IGlucjYyMFsnQ0lWSUNPU1QxJ11bJ0NEUE9CSkNJViddWydsVmFsdWUnXSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYXNMZWFkRm9ybWF0KFxyXG4gICAgb3B0czoge1xyXG4gICAgICBmYWxsYmFja0lmRm9yZWlnbj86IEVnb25BZGRyZXNzO1xyXG4gICAgfSA9IHt9XHJcbiAgKTogTGVhZEFkZHJlc3Mge1xyXG4gICAgaWYgKG9wdHMuZmFsbGJhY2tJZkZvcmVpZ24gJiYgdGhpcy5pc28zID09PSBFZ29uQWRkcmVzcy5GT1JFSUdOX0lTTzMpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICAuLi5vcHRzLmZhbGxiYWNrSWZGb3JlaWduLmFzTGVhZEZvcm1hdCgpLFxyXG4gICAgICAgIGZvcmVpZ25BZGRyZXNzOiB0cnVlLFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHRvcG9ueW15OiB0aGlzLnN0cmVldFRvcG9ueW0sXHJcbiAgICAgIGFkZHJlc3M6IHRoaXMuc3RyZWV0TmFtZSxcclxuICAgICAgaG91c2VOdW1iZXI6IHRoaXMubnVtYmVyQ29tcGxldGUsXHJcbiAgICAgIGNpdHk6IHRoaXMuY2l0eSxcclxuICAgICAgcHJvdmluY2U6IHRoaXMucHJvdmluY2UsXHJcbiAgICAgIHppcENvZGU6IHRoaXMuemlwY29kZSxcclxuICAgICAgaXN0YXRDb2RlOiB0aGlzLmlzdGF0Q29kZSxcclxuICAgICAgc3RyZWV0Q29kZTogdGhpcy5lZ29uQ29kZVN0cmVldCxcclxuICAgICAgY2l2aWNFZ29uQ29kZTogdGhpcy5lZ29uQ29kZU51bWJlcixcclxuICAgICAgZXh0ZW5kZWRQcm92aW5jZTogdGhpcy5leHRlbmRlZFByb3ZpbmNlLFxyXG4gICAgICBjb3VudHJ5OiB0aGlzLmNvdW50cnksXHJcbiAgICAgIHJlZ2lvbjogdGhpcy5yZWdpb24sXHJcbiAgICAgIGZvcmVpZ25BZGRyZXNzOiB0aGlzLmlzbzMgPT09IEVnb25BZGRyZXNzLkZPUkVJR05fSVNPMyxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgZnJvbUxlYWRGb3JtYXQoZGF0YTogTGVhZEFkZHJlc3MpOiBFZ29uQWRkcmVzcztcclxuICBzdGF0aWMgZnJvbUxlYWRGb3JtYXQoZGF0YTogTGVhZEFkZHJlc3MgfCB1bmRlZmluZWQpOiBFZ29uQWRkcmVzcyB8IHVuZGVmaW5lZDtcclxuICBzdGF0aWMgZnJvbUxlYWRGb3JtYXQoXHJcbiAgICBkYXRhOiBMZWFkQWRkcmVzcyB8IHVuZGVmaW5lZFxyXG4gICk6IEVnb25BZGRyZXNzIHwgdW5kZWZpbmVkIHtcclxuICAgIGlmIChkYXRhID09IG51bGwpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChkYXRhLmZvcmVpZ25BZGRyZXNzKSB7XHJcbiAgICAgIHJldHVybiBFZ29uQWRkcmVzcy5mcm9tRm9yZWlnbigpO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBudW1iZXIgPSAnJyxcclxuICAgICAgZXhwb25lbnQgPSAnJztcclxuICAgIGNvbnN0IGhvdXNlTnVtYmVyTWF0Y2ggPSBkYXRhLmhvdXNlTnVtYmVyPy5tYXRjaCgvKFtcXGQrXSopKFtBLVphLXpdKikvKTtcclxuICAgIGlmIChob3VzZU51bWJlck1hdGNoKSB7XHJcbiAgICAgIG51bWJlciA9IGhvdXNlTnVtYmVyTWF0Y2hbMV0gPz8gJyc7XHJcbiAgICAgIGV4cG9uZW50ID0gaG91c2VOdW1iZXJNYXRjaFsyXSA/PyAnJztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIG51bWJlciA9IGRhdGEuaG91c2VOdW1iZXI7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG5ldyBFZ29uQWRkcmVzcyh7XHJcbiAgICAgIGlzbzM6IHRoaXMuSVRBX0lTTzMsXHJcbiAgICAgIHN0cmVldFRvcG9ueW06IGRhdGEudG9wb255bXksXHJcbiAgICAgIHN0cmVldE5hbWU6IGRhdGEuYWRkcmVzcyxcclxuICAgICAgbnVtYmVyOiBudW1iZXIsXHJcbiAgICAgIGV4cG9uZW50OiBleHBvbmVudCxcclxuICAgICAgY2l0eTogZGF0YS5jaXR5LFxyXG4gICAgICBwcm92aW5jZTogZGF0YS5wcm92aW5jZSxcclxuICAgICAgemlwY29kZTogZGF0YS56aXBDb2RlLFxyXG4gICAgICBpc3RhdENvZGU6IGRhdGEuaXN0YXRDb2RlLFxyXG4gICAgICBlZ29uQ29kZVN0cmVldDogZGF0YS5zdHJlZXRDb2RlLFxyXG4gICAgICBlZ29uQ29kZU51bWJlcjogZGF0YS5jaXZpY0Vnb25Db2RlISxcclxuICAgICAgZXh0ZW5kZWRQcm92aW5jZTogZGF0YS5leHRlbmRlZFByb3ZpbmNlISxcclxuICAgICAgY291bnRyeTogZGF0YS5jb3VudHJ5ISxcclxuICAgICAgcmVnaW9uOiBkYXRhLnJlZ2lvbiEsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBmcm9tQ2hlY2tEMzY1Rm9ybWF0KFxyXG4gICAgZGF0YTogUGljazxcclxuICAgICAgQ2hlY2tEMzY1UmVzcG9uc2VbJ2luZGlyaXp6byddLFxyXG4gICAgICB8ICd0b3Bvbm9tYXN0aWNhJ1xyXG4gICAgICB8ICd2aWEnXHJcbiAgICAgIHwgJ2NpdmljbydcclxuICAgICAgfCAnY29tdW5lJ1xyXG4gICAgICB8ICdwcm92J1xyXG4gICAgICB8ICdjYXAnXHJcbiAgICAgIHwgJ2NvZGljZUlzdGF0Q29tdW5lJ1xyXG4gICAgICB8ICdjb2RpY2VFZ29uJ1xyXG4gICAgPlxyXG4gICkge1xyXG4gICAgcmV0dXJuIG5ldyBFZ29uQWRkcmVzcyh7XHJcbiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3Igbm8gbWFwXHJcbiAgICAgIGlzbzM6IG51bGwsXHJcbiAgICAgIHN0cmVldFRvcG9ueW06IGRhdGEudG9wb25vbWFzdGljYSxcclxuICAgICAgc3RyZWV0TmFtZTogZGF0YS52aWEsXHJcbiAgICAgIG51bWJlcjogZGF0YS5jaXZpY28sXHJcbiAgICAgIGV4cG9uZW50OiAnJyxcclxuICAgICAgY2l0eTogZGF0YS5jb211bmUsXHJcbiAgICAgIHByb3ZpbmNlOiBkYXRhLnByb3YsXHJcbiAgICAgIHppcGNvZGU6IGRhdGEuY2FwLFxyXG4gICAgICBpc3RhdENvZGU6IGRhdGEuY29kaWNlSXN0YXRDb211bmUsXHJcbiAgICAgIGVnb25Db2RlU3RyZWV0OiBkYXRhLmNvZGljZUVnb24sXHJcbiAgICAgIGVnb25Db2RlTnVtYmVyOiBkYXRhLmNvZGljZUVnb24sXHJcbiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3Igbm8gbWFwXHJcbiAgICAgIGV4dGVuZGVkUHJvdmluY2U6IG51bGwsXHJcbiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3Igbm8gbWFwXHJcbiAgICAgIGNvdW50cnk6IG51bGwsXHJcbiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3Igbm8gbWFwXHJcbiAgICAgIHJlZ2lvbjogbnVsbCxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIHJlYWRvbmx5IElUQV9JU08zID0gJ0lUQSc7XHJcbiAgLy8gWFhYIGlzIHVzZWQgdG8gcmVwcmVzZW50IGEgcGVyc29uIG9mIHVuc3BlY2lmaWVkIG5hdGlvbmFsaXR5LlxyXG4gIHN0YXRpYyByZWFkb25seSBGT1JFSUdOX0lTTzMgPSAnWFhYJztcclxuXHJcbiAgc3RhdGljIGZyb21Gb3JlaWduKCkge1xyXG4gICAgcmV0dXJuIG5ldyBFZ29uQWRkcmVzcyh7XHJcbiAgICAgIGNpdHk6ICcnLFxyXG4gICAgICBjb3VudHJ5OiAnJyxcclxuICAgICAgZWdvbkNvZGVOdW1iZXI6IDAsXHJcbiAgICAgIGVnb25Db2RlU3RyZWV0OiAwLFxyXG4gICAgICBleHBvbmVudDogJycsXHJcbiAgICAgIGV4dGVuZGVkUHJvdmluY2U6ICcnLFxyXG4gICAgICBpc3RhdENvZGU6ICcnLFxyXG4gICAgICBudW1iZXI6ICcnLFxyXG4gICAgICBwcm92aW5jZTogJycsXHJcbiAgICAgIHJlZ2lvbjogJycsXHJcbiAgICAgIHN0cmVldE5hbWU6ICcnLFxyXG4gICAgICBzdHJlZXRUb3BvbnltOiAnJyxcclxuICAgICAgemlwY29kZTogJycsXHJcbiAgICAgIGlzbzM6IHRoaXMuRk9SRUlHTl9JU08zLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhc1N1Z2dlc3Rpb24oKTogRWdvblN1Z2dlc3Rpb24ge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaWQ6IHRoaXMuZWdvbkNvZGVTdHJlZXQsXHJcbiAgICAgIGlzbzM6IHRoaXMuaXNvMyxcclxuICAgICAgbGV2ZWw6ICcnLFxyXG4gICAgICBjb3VudHJ5OiB0aGlzLmNvdW50cnksXHJcbiAgICAgIGV4cG9uZW50OiB0aGlzLmV4cG9uZW50LFxyXG4gICAgICBudW1iZXI6IHRoaXMubnVtYmVyLFxyXG4gICAgICByZWdpb246IHRoaXMucmVnaW9uLFxyXG4gICAgICBwcm92aW5jZTogdGhpcy5wcm92aW5jZSxcclxuICAgICAgY2l0eTogdGhpcy5jaXR5LFxyXG4gICAgICB6aXBjb2RlOiB0aGlzLnppcGNvZGUsXHJcbiAgICAgIHN0cmVldDogYCR7dGhpcy5zdHJlZXRUb3BvbnltfSAke3RoaXMuc3RyZWV0TmFtZX1gLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHRvU3RyaW5nKCkge1xyXG4gICAgaWYgKHRoaXMuaXNvMyA9PT0gRWdvbkFkZHJlc3MuRk9SRUlHTl9JU08zKSB7XHJcbiAgICAgIHJldHVybiAnRXN0ZXJvJztcclxuICAgIH1cclxuICAgIHJldHVybiBlZ29uVG9TdHJpbmcodGhpcy5hc1N1Z2dlc3Rpb24oKSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEVnb25TdWdnZXN0aW9uIHtcclxuICAvKiogQGV4YW1wbGUgMzgwMDAwODMyNjkgKi9cclxuICBpZDogbnVtYmVyO1xyXG5cclxuICAvKiogQGV4YW1wbGUgXCJJVEFcIiAqL1xyXG4gIGlzbzM6IHN0cmluZztcclxuXHJcbiAgLyoqIEBleGFtcGxlIFwic3RyZWV0XCIgKi9cclxuICBsZXZlbDogc3RyaW5nO1xyXG5cclxuICAvKiogQGV4YW1wbGUgXCJJVEFMSUFcIiAqL1xyXG4gIGNvdW50cnk6IHN0cmluZztcclxuXHJcbiAgLyoqIEBleGFtcGxlIFwiYVwiICovXHJcbiAgZXhwb25lbnQ6IHN0cmluZztcclxuXHJcbiAgLyoqIEBleGFtcGxlIFwiMVwiICovXHJcbiAgbnVtYmVyOiBzdHJpbmc7XHJcblxyXG4gIC8qKiBAZXhhbXBsZSBcIkxBWklPXCIgKi9cclxuICByZWdpb246IHN0cmluZztcclxuXHJcbiAgLyoqIEBleGFtcGxlIFwiUk1cIiAqL1xyXG4gIHByb3ZpbmNlOiBzdHJpbmc7XHJcblxyXG4gIC8qKiBAZXhhbXBsZSBcIlJPTUFcIiAqL1xyXG4gIGNpdHk6IHN0cmluZztcclxuXHJcbiAgLyoqIEBleGFtcGxlIFwiMDAxNjVcIiAqL1xyXG4gIHppcGNvZGU6IHN0cmluZztcclxuXHJcbiAgLyoqIEBleGFtcGxlIFwiUElBWlpBTEUgR0lVU0VQUEUgR0FSSUJBTERJXCIgKi9cclxuICBzdHJlZXQ6IHN0cmluZztcclxufVxyXG5cclxuLyoqXHJcbiAqIEBleGFtcGxlIFwiVmlhIFNhbmRybyBTYW5kcmksIDFBLCAyMDEyMSBNaWxhbm8gTUlcIlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGVnb25Ub1N0cmluZyh7XHJcbiAgY2l0eSA9ICcnLFxyXG4gIHN0cmVldCA9ICcnLFxyXG4gIHppcGNvZGUgPSAnJyxcclxuICBleHBvbmVudCA9ICcnLFxyXG4gIHByb3ZpbmNlID0gJycsXHJcbiAgbnVtYmVyID0gJycsXHJcbn06IEVnb25TdWdnZXN0aW9uKSB7XHJcbiAgcmV0dXJuIFtcclxuICAgIHN0cmVldCxcclxuICAgIFtudW1iZXIsIGV4cG9uZW50XS5maWx0ZXIoQm9vbGVhbikuam9pbignJyksXHJcbiAgICBbemlwY29kZSwgY2l0eSwgcHJvdmluY2VdLmZpbHRlcihCb29sZWFuKS5qb2luKCcgJyksXHJcbiAgXVxyXG4gICAgLmZpbHRlcihCb29sZWFuKVxyXG4gICAgLmpvaW4oJywgJyk7XHJcbn1cclxuIl0sImZpbGUiOiJDOi9Vc2Vycy9haW50cm9uYS9EZXNrdG9wL0FwcC9yZWFjdC9uYWovbGlicy9kYXRhLWFjY2Vzcy9zcmMvbGliL2FwaS9lZ29uL3R5cGVzLnRzIn0=