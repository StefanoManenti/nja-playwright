import { createHotContext as __vite__createHotContext } from "/@vite/client";import.meta.hot = __vite__createHotContext("/src/app/Nav/nav2.tsx");import __vite__cjsImport0_react_jsxDevRuntime from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/node_modules/.vite/apps/naj/deps/react_jsx-dev-runtime.js?v=0189a8d1"; const jsxDEV = __vite__cjsImport0_react_jsxDevRuntime["jsxDEV"];
import RefreshRuntime from "/@react-refresh";
const inWebWorker = typeof WorkerGlobalScope !== "undefined" && self instanceof WorkerGlobalScope;
let prevRefreshReg;
let prevRefreshSig;
if (import.meta.hot && !inWebWorker) {
  if (!window.__vite_plugin_react_preamble_installed__) {
    throw new Error("@vitejs/plugin-react can't detect preamble. Something is wrong. See https://github.com/vitejs/vite-plugin-react/pull/11#discussion_r430879201");
  }
  prevRefreshReg = window.$RefreshReg$;
  prevRefreshSig = window.$RefreshSig$;
  window.$RefreshReg$ = (type, id) => {
    RefreshRuntime.register(type, "C:/Users/aintrona/Desktop/App/react/naj/apps/naj/src/app/Nav/nav2.tsx " + id);
  };
  window.$RefreshSig$ = RefreshRuntime.createSignatureFunctionForTransform;
}
var _s = $RefreshSig$();
globalThis.jotaiAtomCache = globalThis.jotaiAtomCache || { cache: /* @__PURE__ */ new Map(), get(name, inst) {
  if (this.cache.has(name)) {
    return this.cache.get(name);
  }
  this.cache.set(name, inst);
  return inst;
} };
import { OperativeMode } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/index.ts";
import { ButtonPln } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/ui-atoms/src/index.ts";
import __vite__cjsImport5_react from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/node_modules/.vite/apps/naj/deps/react.js?v=0189a8d1"; const useState = __vite__cjsImport5_react["useState"];
import { getCommodityLabel, isCommodityCompatible } from "/src/app/Nav/commodities.tsx";
import { flags } from "/src/app/Nav/flags.tsx";
import classes from "/src/app/Nav/nav2.module.css";
import { NavSelect } from "/src/app/Nav/NavSelect.tsx";
import { allCommodities, isOfferCompatible, offers } from "/src/app/Nav/offers.tsx";
import { operativeModes } from "/src/app/Nav/operativeModes.tsx";
import { Commodity } from "/src/app/Nav/types.ts";
export function Nav() {
  _s();
  const [operativeMode, setOperativeMode] = useState(
    OperativeMode.NOT_SELECTED
  );
  const [offerName, setOfferName] = useState("");
  const offer = offers.find((o) => o.name === offerName);
  const [commodity, setCommodity] = useState(Commodity.NOT_SELECTED);
  const [loading, setLoading] = useState(false);
  if (loading) {
    return null;
  }
  return /* @__PURE__ */ jsxDEV(
    "form",
    {
      className: classes.root,
      onSubmit: (event) => {
        event.preventDefault();
        const form = event.currentTarget;
        const formData = new FormData(form);
        window.location.href = getUrl(formData);
        setLoading(true);
      },
      children: [
        /* @__PURE__ */ jsxDEV("div", { children: [
          /* @__PURE__ */ jsxDEV("h2", { children: "Flags" }, void 0, false, {
            fileName: "C:/Users/aintrona/Desktop/App/react/naj/apps/naj/src/app/Nav/nav2.tsx",
            lineNumber: 38,
            columnNumber: 9
          }, this),
          flags.map(
            (flag) => /* @__PURE__ */ jsxDEV("label", { children: [
              /* @__PURE__ */ jsxDEV(
                "input",
                {
                  type: "checkbox",
                  name: flag.name,
                  defaultChecked: flag.defaultChecked
                },
                void 0,
                false,
                {
                  fileName: "C:/Users/aintrona/Desktop/App/react/naj/apps/naj/src/app/Nav/nav2.tsx",
                  lineNumber: 41,
                  columnNumber: 13
                },
                this
              ),
              /* @__PURE__ */ jsxDEV("b", { children: flag.name }, void 0, false, {
                fileName: "C:/Users/aintrona/Desktop/App/react/naj/apps/naj/src/app/Nav/nav2.tsx",
                lineNumber: 46,
                columnNumber: 13
              }, this),
              flag.label && `: ${flag.label}`
            ] }, flag.name, true, {
              fileName: "C:/Users/aintrona/Desktop/App/react/naj/apps/naj/src/app/Nav/nav2.tsx",
              lineNumber: 40,
              columnNumber: 9
            }, this)
          )
        ] }, void 0, true, {
          fileName: "C:/Users/aintrona/Desktop/App/react/naj/apps/naj/src/app/Nav/nav2.tsx",
          lineNumber: 37,
          columnNumber: 7
        }, this),
        /* @__PURE__ */ jsxDEV(
          NavSelect,
          {
            title: "ModalitÃ  operativa",
            name: "operativeMode",
            value: operativeMode,
            setValue: setOperativeMode,
            options: operativeModes,
            getValue: (op) => op.value,
            getLabel: (op) => op.name
          },
          void 0,
          false,
          {
            fileName: "C:/Users/aintrona/Desktop/App/react/naj/apps/naj/src/app/Nav/nav2.tsx",
            lineNumber: 52,
            columnNumber: 7
          },
          this
        ),
        operativeMode && /* @__PURE__ */ jsxDEV(
          NavSelect,
          {
            title: "Offerta",
            name: "offer",
            value: offerName,
            setValue: setOfferName,
            options: offers,
            getValue: (offer2) => offer2.name,
            getLabel: (offer2) => offer2.name,
            isDisabled: (offer2) => !isOfferCompatible(offer2, operativeMode)
          },
          void 0,
          false,
          {
            fileName: "C:/Users/aintrona/Desktop/App/react/naj/apps/naj/src/app/Nav/nav2.tsx",
            lineNumber: 63,
            columnNumber: 7
          },
          this
        ),
        offer && /* @__PURE__ */ jsxDEV(
          NavSelect,
          {
            title: "Commodity",
            name: "commodity",
            value: commodity,
            setValue: setCommodity,
            options: [...allCommodities, Commodity.NOTHING],
            getValue: (commodity2) => commodity2,
            getLabel: getCommodityLabel,
            isDisabled: (commodity2) => !isCommodityCompatible(commodity2, offer, operativeMode)
          },
          void 0,
          false,
          {
            fileName: "C:/Users/aintrona/Desktop/App/react/naj/apps/naj/src/app/Nav/nav2.tsx",
            lineNumber: 76,
            columnNumber: 7
          },
          this
        ),
        operativeMode && offer && commodity && /* @__PURE__ */ jsxDEV(ButtonPln, { color: "primary", component: "button", type: "submit", children: "Vai" }, void 0, false, {
          fileName: "C:/Users/aintrona/Desktop/App/react/naj/apps/naj/src/app/Nav/nav2.tsx",
          lineNumber: 91,
          columnNumber: 7
        }, this)
      ]
    },
    void 0,
    true,
    {
      fileName: "C:/Users/aintrona/Desktop/App/react/naj/apps/naj/src/app/Nav/nav2.tsx",
      lineNumber: 27,
      columnNumber: 5
    },
    this
  );
}
_s(Nav, "K7/sFd+DYezZ1wH8gcGPeyq49K8=");
_c = Nav;
function getUrl(formData) {
  const commodity = formData.get("commodity");
  const offerName = formData.get("offer");
  const offer = offers.find((o) => o.name === offerName);
  const op = formData.get("operativeMode");
  const BASE = "/configura-offerta?";
  const params = new URLSearchParams({
    codiceProdotto: offer.codiceProdotto,
    codiceCanale: offer.codiceCanale,
    codiceTpCanale: offer.codiceTpCanale,
    "direct-debit": "true",
    "bill-type": "digitale"
  });
  if (commodity !== Commodity.NOTHING) {
    params.set("commodity", commodity);
  }
  if (op !== "TROUBLESHOOTING") {
    params.set("salesProcess", op);
  }
  offer.extras?.forEach((extra) => {
    params.set(extra, "");
  });
  let address = "";
  if (offer.name.match(/Fibra/)) {
    address = "&egonid=380100013650019";
  }
  function addFlag(flag) {
    if (formData.get(flag) === "on") {
      return `&${flag}`;
    }
    return "";
  }
  const flagsQs = flags.reduce((acc, flag) => acc + addFlag(flag.name), "");
  return `${BASE}${params}${address}${flagsQs}`;
}
var _c;
$RefreshReg$(_c, "Nav");
if (import.meta.hot && !inWebWorker) {
  window.$RefreshReg$ = prevRefreshReg;
  window.$RefreshSig$ = prevRefreshSig;
}
if (import.meta.hot && !inWebWorker) {
  RefreshRuntime.__hmr_import(import.meta.url).then((currentExports) => {
    RefreshRuntime.registerExportsForReactRefresh("C:/Users/aintrona/Desktop/App/react/naj/apps/naj/src/app/Nav/nav2.tsx", currentExports);
    import.meta.hot.accept((nextExports) => {
      if (!nextExports) return;
      const invalidateMessage = RefreshRuntime.validateRefreshBoundaryAndEnqueueUpdate(currentExports, nextExports);
      if (invalidateMessage) import.meta.hot.invalidate(invalidateMessage);
    });
  });
}

//# sourceMappingURL=data:application/json;base64,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dEJDLGNBQWNoQyxNQUFNZ0M7QUFBQUEsSUFDcEJDLGdCQUFnQmpDLE1BQU1pQztBQUFBQSxJQUN0QixnQkFBZ0I7QUFBQSxJQUNoQixhQUFhO0FBQUEsRUFDZixDQUFDO0FBRUQsTUFBSTdCLGNBQWNaLFVBQVVpQyxTQUFTO0FBQ25DSSxXQUFPSyxJQUFJLGFBQWE5QixTQUFTO0FBQUEsRUFDbkM7QUFFQSxNQUFJbUIsT0FBTyxtQkFBbUI7QUFDNUJNLFdBQU9LLElBQUksZ0JBQWdCWCxFQUFFO0FBQUEsRUFDL0I7QUFFQXZCLFFBQU1tQyxRQUFRQyxRQUFRLENBQUNDLFVBQVU7QUFDL0JSLFdBQU9LLElBQUlHLE9BQU8sRUFBRTtBQUFBLEVBQ3RCLENBQUM7QUFFRCxNQUFJQyxVQUFVO0FBR2QsTUFBSXRDLE1BQU1HLEtBQUtvQyxNQUFNLE9BQU8sR0FBRztBQUM3QkQsY0FBVTtBQUFBLEVBQ1o7QUFFQSxXQUFTRSxRQUFRcEIsTUFBYztBQUM3QixRQUFJUCxTQUFTYyxJQUFJUCxJQUFJLE1BQU0sTUFBTTtBQUMvQixhQUFPLElBQUlBLElBQUk7QUFBQSxJQUNqQjtBQUNBLFdBQU87QUFBQSxFQUNUO0FBRUEsUUFBTXFCLFVBQVV4RCxNQUFNeUQsT0FBTyxDQUFDQyxLQUFLdkIsU0FBU3VCLE1BQU1ILFFBQVFwQixLQUFLakIsSUFBSSxHQUFHLEVBQUU7QUFFeEUsU0FBTyxHQUFHeUIsSUFBSSxHQUFHQyxNQUFNLEdBQUdTLE9BQU8sR0FBR0csT0FBTztBQUM3QztBQUFDLElBQUFmO0FBQUFrQixhQUFBbEIsSUFBQSIsIm5hbWVzIjpbIk9wZXJhdGl2ZU1vZGUiLCJCdXR0b25QbG4iLCJ1c2VTdGF0ZSIsImdldENvbW1vZGl0eUxhYmVsIiwiaXNDb21tb2RpdHlDb21wYXRpYmxlIiwiZmxhZ3MiLCJjbGFzc2VzIiwiTmF2U2VsZWN0IiwiYWxsQ29tbW9kaXRpZXMiLCJpc09mZmVyQ29tcGF0aWJsZSIsIm9mZmVycyIsIm9wZXJhdGl2ZU1vZGVzIiwiQ29tbW9kaXR5IiwiTmF2IiwiX3MiLCJvcGVyYXRpdmVNb2RlIiwic2V0T3BlcmF0aXZlTW9kZSIsIk5PVF9TRUxFQ1RFRCIsIm9mZmVyTmFtZSIsInNldE9mZmVyTmFtZSIsIm9mZmVyIiwiZmluZCIsIm8iLCJuYW1lIiwiY29tbW9kaXR5Iiwic2V0Q29tbW9kaXR5IiwibG9hZGluZyIsInNldExvYWRpbmciLCJyb290IiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsImZvcm0iLCJjdXJyZW50VGFyZ2V0IiwiZm9ybURhdGEiLCJGb3JtRGF0YSIsIndpbmRvdyIsImxvY2F0aW9uIiwiaHJlZiIsImdldFVybCIsIm1hcCIsImZsYWciLCJkZWZhdWx0Q2hlY2tlZCIsImxhYmVsIiwib3AiLCJ2YWx1ZSIsIk5PVEhJTkciLCJfYyIsImdldCIsIkJBU0UiLCJwYXJhbXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJjb2RpY2VQcm9kb3R0byIsImNvZGljZUNhbmFsZSIsImNvZGljZVRwQ2FuYWxlIiwic2V0IiwiZXh0cmFzIiwiZm9yRWFjaCIsImV4dHJhIiwiYWRkcmVzcyIsIm1hdGNoIiwiYWRkRmxhZyIsImZsYWdzUXMiLCJyZWR1Y2UiLCJhY2MiLCIkUmVmcmVzaFJlZyQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZXMiOlsibmF2Mi50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgT3BlcmF0aXZlTW9kZSB9IGZyb20gJ0BuYWotd28vZGF0YS1hY2Nlc3MnO1xyXG5pbXBvcnQgeyBCdXR0b25QbG4gfSBmcm9tICdAbmFqLXdvL3VpLWF0b21zJztcclxuaW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBnZXRDb21tb2RpdHlMYWJlbCwgaXNDb21tb2RpdHlDb21wYXRpYmxlIH0gZnJvbSAnLi9jb21tb2RpdGllcyc7XHJcbmltcG9ydCB7IGZsYWdzIH0gZnJvbSAnLi9mbGFncyc7XHJcbmltcG9ydCBjbGFzc2VzIGZyb20gJy4vbmF2Mi5tb2R1bGUuY3NzJztcclxuaW1wb3J0IHsgTmF2U2VsZWN0IH0gZnJvbSAnLi9OYXZTZWxlY3QnO1xyXG5pbXBvcnQgeyBhbGxDb21tb2RpdGllcywgaXNPZmZlckNvbXBhdGlibGUsIG9mZmVycyB9IGZyb20gJy4vb2ZmZXJzJztcclxuaW1wb3J0IHsgb3BlcmF0aXZlTW9kZXMgfSBmcm9tICcuL29wZXJhdGl2ZU1vZGVzJztcclxuaW1wb3J0IHsgQ29tbW9kaXR5LCB0eXBlIE9wT3JUciB9IGZyb20gJy4vdHlwZXMnO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIE5hdigpIHtcclxuICBjb25zdCBbb3BlcmF0aXZlTW9kZSwgc2V0T3BlcmF0aXZlTW9kZV0gPSB1c2VTdGF0ZTxPcE9yVHI+KFxyXG4gICAgT3BlcmF0aXZlTW9kZS5OT1RfU0VMRUNURURcclxuICApO1xyXG5cclxuICBjb25zdCBbb2ZmZXJOYW1lLCBzZXRPZmZlck5hbWVdID0gdXNlU3RhdGUoJycpO1xyXG4gIGNvbnN0IG9mZmVyID0gb2ZmZXJzLmZpbmQoKG8pID0+IG8ubmFtZSA9PT0gb2ZmZXJOYW1lKTtcclxuICBjb25zdCBbY29tbW9kaXR5LCBzZXRDb21tb2RpdHldID0gdXNlU3RhdGUoQ29tbW9kaXR5Lk5PVF9TRUxFQ1RFRCk7XHJcbiAgY29uc3QgW2xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xyXG5cclxuICBpZiAobG9hZGluZykge1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gKFxyXG4gICAgPGZvcm1cclxuICAgICAgY2xhc3NOYW1lPXtjbGFzc2VzLnJvb3R9XHJcbiAgICAgIG9uU3VibWl0PXsoZXZlbnQpID0+IHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGNvbnN0IGZvcm0gPSBldmVudC5jdXJyZW50VGFyZ2V0O1xyXG4gICAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKGZvcm0pO1xyXG4gICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gZ2V0VXJsKGZvcm1EYXRhKTtcclxuICAgICAgICBzZXRMb2FkaW5nKHRydWUpO1xyXG4gICAgICB9fVxyXG4gICAgPlxyXG4gICAgICA8ZGl2PlxyXG4gICAgICAgIDxoMj5GbGFnczwvaDI+XHJcbiAgICAgICAge2ZsYWdzLm1hcCgoZmxhZykgPT4gKFxyXG4gICAgICAgICAgPGxhYmVsIGtleT17ZmxhZy5uYW1lfT5cclxuICAgICAgICAgICAgPGlucHV0XHJcbiAgICAgICAgICAgICAgdHlwZT1cImNoZWNrYm94XCJcclxuICAgICAgICAgICAgICBuYW1lPXtmbGFnLm5hbWV9XHJcbiAgICAgICAgICAgICAgZGVmYXVsdENoZWNrZWQ9e2ZsYWcuZGVmYXVsdENoZWNrZWR9XHJcbiAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgIDxiPntmbGFnLm5hbWV9PC9iPlxyXG4gICAgICAgICAgICB7ZmxhZy5sYWJlbCAmJiBgOiAke2ZsYWcubGFiZWx9YH1cclxuICAgICAgICAgIDwvbGFiZWw+XHJcbiAgICAgICAgKSl9XHJcbiAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgPE5hdlNlbGVjdFxyXG4gICAgICAgIHRpdGxlPVwiTW9kYWxpdMOgIG9wZXJhdGl2YVwiXHJcbiAgICAgICAgbmFtZT1cIm9wZXJhdGl2ZU1vZGVcIlxyXG4gICAgICAgIHZhbHVlPXtvcGVyYXRpdmVNb2RlfVxyXG4gICAgICAgIHNldFZhbHVlPXtzZXRPcGVyYXRpdmVNb2RlfVxyXG4gICAgICAgIG9wdGlvbnM9e29wZXJhdGl2ZU1vZGVzfVxyXG4gICAgICAgIGdldFZhbHVlPXsob3ApID0+IG9wLnZhbHVlfVxyXG4gICAgICAgIGdldExhYmVsPXsob3ApID0+IG9wLm5hbWV9XHJcbiAgICAgIC8+XHJcblxyXG4gICAgICB7b3BlcmF0aXZlTW9kZSAmJiAoXHJcbiAgICAgICAgPE5hdlNlbGVjdFxyXG4gICAgICAgICAgdGl0bGU9XCJPZmZlcnRhXCJcclxuICAgICAgICAgIG5hbWU9XCJvZmZlclwiXHJcbiAgICAgICAgICB2YWx1ZT17b2ZmZXJOYW1lfVxyXG4gICAgICAgICAgc2V0VmFsdWU9e3NldE9mZmVyTmFtZX1cclxuICAgICAgICAgIG9wdGlvbnM9e29mZmVyc31cclxuICAgICAgICAgIGdldFZhbHVlPXsob2ZmZXIpID0+IG9mZmVyLm5hbWV9XHJcbiAgICAgICAgICBnZXRMYWJlbD17KG9mZmVyKSA9PiBvZmZlci5uYW1lfVxyXG4gICAgICAgICAgaXNEaXNhYmxlZD17KG9mZmVyKSA9PiAhaXNPZmZlckNvbXBhdGlibGUob2ZmZXIsIG9wZXJhdGl2ZU1vZGUpfVxyXG4gICAgICAgIC8+XHJcbiAgICAgICl9XHJcblxyXG4gICAgICB7b2ZmZXIgJiYgKFxyXG4gICAgICAgIDxOYXZTZWxlY3RcclxuICAgICAgICAgIHRpdGxlPVwiQ29tbW9kaXR5XCJcclxuICAgICAgICAgIG5hbWU9XCJjb21tb2RpdHlcIlxyXG4gICAgICAgICAgdmFsdWU9e2NvbW1vZGl0eX1cclxuICAgICAgICAgIHNldFZhbHVlPXtzZXRDb21tb2RpdHl9XHJcbiAgICAgICAgICBvcHRpb25zPXtbLi4uYWxsQ29tbW9kaXRpZXMsIENvbW1vZGl0eS5OT1RISU5HXX1cclxuICAgICAgICAgIGdldFZhbHVlPXsoY29tbW9kaXR5KSA9PiBjb21tb2RpdHl9XHJcbiAgICAgICAgICBnZXRMYWJlbD17Z2V0Q29tbW9kaXR5TGFiZWx9XHJcbiAgICAgICAgICBpc0Rpc2FibGVkPXsoY29tbW9kaXR5KSA9PlxyXG4gICAgICAgICAgICAhaXNDb21tb2RpdHlDb21wYXRpYmxlKGNvbW1vZGl0eSwgb2ZmZXIsIG9wZXJhdGl2ZU1vZGUpXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgLz5cclxuICAgICAgKX1cclxuXHJcbiAgICAgIHtvcGVyYXRpdmVNb2RlICYmIG9mZmVyICYmIGNvbW1vZGl0eSAmJiAoXHJcbiAgICAgICAgPEJ1dHRvblBsbiBjb2xvcj1cInByaW1hcnlcIiBjb21wb25lbnQ9XCJidXR0b25cIiB0eXBlPVwic3VibWl0XCI+XHJcbiAgICAgICAgICBWYWlcclxuICAgICAgICA8L0J1dHRvblBsbj5cclxuICAgICAgKX1cclxuICAgIDwvZm9ybT5cclxuICApO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRVcmwoZm9ybURhdGE6IEZvcm1EYXRhKTogc3RyaW5nIHtcclxuICBjb25zdCBjb21tb2RpdHkgPSBmb3JtRGF0YS5nZXQoJ2NvbW1vZGl0eScpIGFzIENvbW1vZGl0eTtcclxuICBjb25zdCBvZmZlck5hbWUgPSBmb3JtRGF0YS5nZXQoJ29mZmVyJyk7XHJcbiAgY29uc3Qgb2ZmZXIgPSBvZmZlcnMuZmluZCgobykgPT4gby5uYW1lID09PSBvZmZlck5hbWUpITtcclxuICBjb25zdCBvcCA9IGZvcm1EYXRhLmdldCgnb3BlcmF0aXZlTW9kZScpIGFzIE9wT3JUcjtcclxuXHJcbiAgY29uc3QgQkFTRSA9ICcvY29uZmlndXJhLW9mZmVydGE/JztcclxuXHJcbiAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7XHJcbiAgICBjb2RpY2VQcm9kb3R0bzogb2ZmZXIuY29kaWNlUHJvZG90dG8sXHJcbiAgICBjb2RpY2VDYW5hbGU6IG9mZmVyLmNvZGljZUNhbmFsZSxcclxuICAgIGNvZGljZVRwQ2FuYWxlOiBvZmZlci5jb2RpY2VUcENhbmFsZSxcclxuICAgICdkaXJlY3QtZGViaXQnOiAndHJ1ZScsXHJcbiAgICAnYmlsbC10eXBlJzogJ2RpZ2l0YWxlJyxcclxuICB9KTtcclxuXHJcbiAgaWYgKGNvbW1vZGl0eSAhPT0gQ29tbW9kaXR5Lk5PVEhJTkcpIHtcclxuICAgIHBhcmFtcy5zZXQoJ2NvbW1vZGl0eScsIGNvbW1vZGl0eSk7XHJcbiAgfVxyXG5cclxuICBpZiAob3AgIT09ICdUUk9VQkxFU0hPT1RJTkcnKSB7XHJcbiAgICBwYXJhbXMuc2V0KCdzYWxlc1Byb2Nlc3MnLCBvcCk7XHJcbiAgfVxyXG5cclxuICBvZmZlci5leHRyYXM/LmZvckVhY2goKGV4dHJhKSA9PiB7XHJcbiAgICBwYXJhbXMuc2V0KGV4dHJhLCAnJyk7XHJcbiAgfSk7XHJcblxyXG4gIGxldCBhZGRyZXNzID0gJyc7XHJcblxyXG4gIC8vVHJpZ2dlciBoYXMgQWRkcmVzcyAtLT4gc2tpcCBBZGRyZXNzU3RlcFxyXG4gIGlmIChvZmZlci5uYW1lLm1hdGNoKC9GaWJyYS8pKSB7XHJcbiAgICBhZGRyZXNzID0gJyZlZ29uaWQ9MzgwMTAwMDEzNjUwMDE5JztcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGFkZEZsYWcoZmxhZzogc3RyaW5nKSB7XHJcbiAgICBpZiAoZm9ybURhdGEuZ2V0KGZsYWcpID09PSAnb24nKSB7XHJcbiAgICAgIHJldHVybiBgJiR7ZmxhZ31gO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICcnO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgZmxhZ3NRcyA9IGZsYWdzLnJlZHVjZSgoYWNjLCBmbGFnKSA9PiBhY2MgKyBhZGRGbGFnKGZsYWcubmFtZSksICcnKTtcclxuXHJcbiAgcmV0dXJuIGAke0JBU0V9JHtwYXJhbXN9JHthZGRyZXNzfSR7ZmxhZ3NRc31gO1xyXG59XHJcbiJdLCJmaWxlIjoiQzovVXNlcnMvYWludHJvbmEvRGVza3RvcC9BcHAvcmVhY3QvbmFqL2FwcHMvbmFqL3NyYy9hcHAvTmF2L25hdjIudHN4In0=