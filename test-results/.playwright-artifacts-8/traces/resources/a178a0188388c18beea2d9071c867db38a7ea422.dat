globalThis.jotaiAtomCache = globalThis.jotaiAtomCache || {
  cache: /* @__PURE__ */ new Map(),
  get(name, inst) {
    if (this.cache.has(name)) {
      return this.cache.get(name);
    }
    this.cache.set(name, inst);
    return inst;
  }
};
import { tryOr } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/util/src/index.ts";
import { atom } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/node_modules/.vite/apps/naj/deps/jotai.js?v=0189a8d1";
import { getQuerystringFromAnswersGas, getQuerystringFromAnswersPower } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/troubleshooting/activation-questions.tsx";
import { gasAtom, operativeModeAtom, powerAtom } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/troubleshooting/atoms.ts";
import { getSearchParamsFromUrl } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/troubleshooting/state-url.ts";
import { tsActivationGas$, tsActivationPower$ } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/troubleshooting/troubleshooting.ts";
import { OperativeMode } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/troubleshooting/types.ts";
import { TipoTroubleshooting } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/data-access/src/lib/atoms/activations/types.ts";
function cleanQs(qs) {
  return {
    contatorePresente: cleanQSItem(qs.get("contatorePresente")),
    attaccoPresente: cleanQSItem(qs.get("attaccoPresente")),
    pdrPresente: cleanQSItem(qs.get("pdrPresente")),
    impiantoModificato: cleanQSItem(qs.get("impiantoModificato")),
    aperto: cleanQSItem(qs.get("aperto")),
    predisposizioneImpianto: cleanQSItem(qs.get("predisposizioneImpianto"))
  };
}
function cleanQSItem(value) {
  if (value == null) {
    throw Error("Un parametro obbligatorio non Ã¨ stato passato.");
  }
  if (value === "null" || value === "true" || value === "false") {
    return JSON.parse(value);
  }
  throw Error("Un parametro obbligatorio non ha un valore valido.");
}
function getTipoTroubleShootingPower(qs) {
  const checkNull = qs.attaccoPresente == null && qs.impiantoModificato == null && qs.pdrPresente == null;
  if (!checkNull) {
    throw Error("attaccoPresente, impiantoModificato, pdrPresente dovrebbero essere null per una fornitura POWER");
  }
  if (qs.contatorePresente && qs.aperto && qs.predisposizioneImpianto == null) {
    return "TROUBLESHOOTING_VOLTURA";
  } else if (qs.contatorePresente && !qs.aperto && qs.predisposizioneImpianto == null) {
    return TipoTroubleshooting.PowerS01;
  } else if (!qs.contatorePresente && qs.aperto == null && !qs.predisposizioneImpianto) {
    return TipoTroubleshooting.PowerN02;
  } else if (!qs.contatorePresente && qs.aperto == null && qs.predisposizioneImpianto) {
    return TipoTroubleshooting.PowerA01;
  } else if (qs.contatorePresente && !qs.aperto && qs.predisposizioneImpianto) {
    return TipoTroubleshooting.PowerA01;
  }
  throw Error("Impossibile individuare il tipo troubleshooting.");
}
function getTipoTroubleShootingGas(qs) {
  const checkNull = qs.predisposizioneImpianto == null;
  if (!checkNull) {
    throw Error("predisposizioneImpianto dovrebbe essere null per una fornitura GAS");
  }
  if (qs.contatorePresente && qs.aperto && qs.attaccoPresente == null && qs.impiantoModificato == null && qs.pdrPresente == null) {
    return "TROUBLESHOOTING_VOLTURA";
  } else if (qs.contatorePresente && !qs.aperto && qs.attaccoPresente == null && qs.impiantoModificato && qs.pdrPresente == null) {
    return TipoTroubleshooting.GasA40_c;
  } else if (qs.contatorePresente && !qs.aperto && qs.attaccoPresente == null && !qs.impiantoModificato && qs.pdrPresente == null) {
    return TipoTroubleshooting.GasA01_c;
  } else if (!qs.contatorePresente && qs.aperto == null && !qs.attaccoPresente && qs.impiantoModificato == null && qs.pdrPresente == null) {
    return TipoTroubleshooting.GasPN1;
  } else if (!qs.contatorePresente && qs.aperto == null && qs.attaccoPresente && qs.impiantoModificato && qs.pdrPresente) {
    return TipoTroubleshooting.GasA40_n;
  } else if (!qs.contatorePresente && qs.aperto == null && qs.attaccoPresente && !qs.impiantoModificato && qs.pdrPresente) {
    return TipoTroubleshooting.GasA01_n;
  } else if (!qs.contatorePresente && qs.aperto == null && qs.attaccoPresente && qs.impiantoModificato == null && !qs.pdrPresente) {
    return TipoTroubleshooting.GasPN1_;
  }
  throw Error("Impossibile individuare il tipo troubleshooting.");
}
export const tipoTroubleshootingGas$ = globalThis.jotaiAtomCache.get("C:\\Users\\aintrona\\Desktop\\App\\react\\naj\\libs\\data-access\\src\\lib\\atoms\\activations\\tipo-troubleshooting.ts/tipoTroubleshootingGas$", atom((get) => {
  const operativeMode = get(operativeModeAtom);
  if (operativeMode !== OperativeMode.NEW_ACTIVATION) {
    return;
  }
  if (!get(gasAtom)) {
    return;
  }
  return tryOr(() => getTipoTroubleShootingGas(cleanQs(getSearchParamsFromUrl()))) || tryOr(() => getTipoTroubleShootingGas(cleanQs(getQuerystringFromAnswersGas(get(tsActivationGas$)))));
}));
tipoTroubleshootingGas$.debugLabel = "tipoTroubleshootingGas$";
export const tipoTroubleshootingPower$ = globalThis.jotaiAtomCache.get("C:\\Users\\aintrona\\Desktop\\App\\react\\naj\\libs\\data-access\\src\\lib\\atoms\\activations\\tipo-troubleshooting.ts/tipoTroubleshootingPower$", atom((get) => {
  const operativeMode = get(operativeModeAtom);
  if (operativeMode !== OperativeMode.NEW_ACTIVATION) {
    return;
  }
  if (!get(powerAtom)) {
    return;
  }
  return tryOr(() => getTipoTroubleShootingPower(cleanQs(getSearchParamsFromUrl()))) || tryOr(() => getTipoTroubleShootingPower(cleanQs(getQuerystringFromAnswersPower(get(tsActivationPower$)))));
}));
tipoTroubleshootingPower$.debugLabel = "tipoTroubleshootingPower$";
export const tipoTroubleshooting$ = globalThis.jotaiAtomCache.get("C:\\Users\\aintrona\\Desktop\\App\\react\\naj\\libs\\data-access\\src\\lib\\atoms\\activations\\tipo-troubleshooting.ts/tipoTroubleshooting$", atom((get) => {
  const operativeMode = get(operativeModeAtom);
  if (operativeMode !== OperativeMode.NEW_ACTIVATION) {
    return;
  }
  const power = !!get(powerAtom);
  const gas = !!get(gasAtom);
  if (power && gas) {
    return;
  }
  return power ? get(tipoTroubleshootingPower$) : get(tipoTroubleshootingGas$);
}));
tipoTroubleshooting$.debugLabel = "tipoTroubleshooting$";
export const overriddenTipoTroubleshootingPower$ = globalThis.jotaiAtomCache.get("C:\\Users\\aintrona\\Desktop\\App\\react\\naj\\libs\\data-access\\src\\lib\\atoms\\activations\\tipo-troubleshooting.ts/overriddenTipoTroubleshootingPower$", atom());
overriddenTipoTroubleshootingPower$.debugLabel = "overriddenTipoTroubleshootingPower$";
export const overriddenTipoTroubleshootingGas$ = globalThis.jotaiAtomCache.get("C:\\Users\\aintrona\\Desktop\\App\\react\\naj\\libs\\data-access\\src\\lib\\atoms\\activations\\tipo-troubleshooting.ts/overriddenTipoTroubleshootingGas$", atom());
overriddenTipoTroubleshootingGas$.debugLabel = "overriddenTipoTroubleshootingGas$";
export const tipoTroubleshootingCalcolato$ = globalThis.jotaiAtomCache.get("C:\\Users\\aintrona\\Desktop\\App\\react\\naj\\libs\\data-access\\src\\lib\\atoms\\activations\\tipo-troubleshooting.ts/tipoTroubleshootingCalcolato$", atom(async (get) => {
  const power = get(powerAtom);
  const gas = get(gasAtom);
  if (power && gas) {
    return;
  }
  const tipoTroubleshooting = get(tipoTroubleshooting$);
  if (!tipoTroubleshooting) {
    return;
  }
  if (power) {
    const overridden = get(overriddenTipoTroubleshootingPower$);
    if (overridden) {
      return overridden;
    }
  }
  if (gas) {
    const overridden = get(overriddenTipoTroubleshootingGas$);
    if (overridden) {
      return overridden;
    }
  }
  return tipoTroubleshooting;
}));
tipoTroubleshootingCalcolato$.debugLabel = "tipoTroubleshootingCalcolato$";

//# sourceMappingURL=data:application/json;base64,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QUlWLFNBQVM7QUFDM0IsUUFBTXlDLE1BQU0vQixJQUFJWixPQUFPO0FBRXZCLE1BQUkwQyxTQUFTQyxLQUFLO0FBQ2hCO0FBQUEsRUFDRjtBQUVBLFFBQU1JLHNCQUFzQm5DLElBQUk2QixvQkFBb0I7QUFFcEQsTUFBSSxDQUFDTSxxQkFBcUI7QUFDeEI7QUFBQSxFQUNGO0FBRUEsTUFBSUwsT0FBTztBQUNULFVBQU1NLGFBQWFwQyxJQUFJZ0MsbUNBQW1DO0FBQzFELFFBQUlJLFlBQVk7QUFDZCxhQUFPQTtBQUFBQSxJQUNUO0FBQUEsRUFDRjtBQUNBLE1BQUlMLEtBQUs7QUFDUCxVQUFNSyxhQUFhcEMsSUFBSWlDLGlDQUFpQztBQUN4RCxRQUFJRyxZQUFZO0FBQ2QsYUFBT0E7QUFBQUEsSUFDVDtBQUFBLEVBQ0Y7QUFFQSxTQUFPRDtBQUNULENBQUMsQ0FBQztBQUFDRCw4QkFBQVAsYUFBQSIsIm5hbWVzIjpbInRyeU9yIiwiYXRvbSIsImdldFF1ZXJ5c3RyaW5nRnJvbUFuc3dlcnNHYXMiLCJnZXRRdWVyeXN0cmluZ0Zyb21BbnN3ZXJzUG93ZXIiLCJnYXNBdG9tIiwib3BlcmF0aXZlTW9kZUF0b20iLCJwb3dlckF0b20iLCJnZXRTZWFyY2hQYXJhbXNGcm9tVXJsIiwidHNBY3RpdmF0aW9uR2FzJCIsInRzQWN0aXZhdGlvblBvd2VyJCIsIk9wZXJhdGl2ZU1vZGUiLCJUaXBvVHJvdWJsZXNob290aW5nIiwiY2xlYW5RcyIsInFzIiwiY29udGF0b3JlUHJlc2VudGUiLCJjbGVhblFTSXRlbSIsImdldCIsImF0dGFjY29QcmVzZW50ZSIsInBkclByZXNlbnRlIiwiaW1waWFudG9Nb2RpZmljYXRvIiwiYXBlcnRvIiwicHJlZGlzcG9zaXppb25lSW1waWFudG8iLCJ2YWx1ZSIsIkVycm9yIiwiSlNPTiIsInBhcnNlIiwiZ2V0VGlwb1Ryb3VibGVTaG9vdGluZ1Bvd2VyIiwiY2hlY2tOdWxsIiwiUG93ZXJTMDEiLCJQb3dlck4wMiIsIlBvd2VyQTAxIiwiZ2V0VGlwb1Ryb3VibGVTaG9vdGluZ0dhcyIsIkdhc0E0MF9jIiwiR2FzQTAxX2MiLCJHYXNQTjEiLCJHYXNBNDBfbiIsIkdhc0EwMV9uIiwiR2FzUE4xXyIsInRpcG9Ucm91Ymxlc2hvb3RpbmdHYXMkIiwiZ2xvYmFsVGhpcyIsImpvdGFpQXRvbUNhY2hlIiwib3BlcmF0aXZlTW9kZSIsIk5FV19BQ1RJVkFUSU9OIiwiZGVidWdMYWJlbCIsInRpcG9Ucm91Ymxlc2hvb3RpbmdQb3dlciQiLCJ0aXBvVHJvdWJsZXNob290aW5nJCIsInBvd2VyIiwiZ2FzIiwib3ZlcnJpZGRlblRpcG9Ucm91Ymxlc2hvb3RpbmdQb3dlciQiLCJvdmVycmlkZGVuVGlwb1Ryb3VibGVzaG9vdGluZ0dhcyQiLCJ0aXBvVHJvdWJsZXNob290aW5nQ2FsY29sYXRvJCIsInRpcG9Ucm91Ymxlc2hvb3RpbmciLCJvdmVycmlkZGVuIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VzIjpbInRpcG8tdHJvdWJsZXNob290aW5nLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHRyeU9yIH0gZnJvbSAnQG5hai13by91dGlsJztcclxuaW1wb3J0IHsgYXRvbSB9IGZyb20gJ2pvdGFpJztcclxuaW1wb3J0IHtcclxuICBnZXRRdWVyeXN0cmluZ0Zyb21BbnN3ZXJzR2FzLFxyXG4gIGdldFF1ZXJ5c3RyaW5nRnJvbUFuc3dlcnNQb3dlcixcclxufSBmcm9tICcuLi8uLi90cm91Ymxlc2hvb3RpbmcvYWN0aXZhdGlvbi1xdWVzdGlvbnMnO1xyXG5pbXBvcnQge1xyXG4gIGdhc0F0b20sXHJcbiAgb3BlcmF0aXZlTW9kZUF0b20sXHJcbiAgcG93ZXJBdG9tLFxyXG59IGZyb20gJy4uLy4uL3Ryb3VibGVzaG9vdGluZy9hdG9tcyc7XHJcbmltcG9ydCB7IGdldFNlYXJjaFBhcmFtc0Zyb21VcmwgfSBmcm9tICcuLi8uLi90cm91Ymxlc2hvb3Rpbmcvc3RhdGUtdXJsJztcclxuaW1wb3J0IHtcclxuICB0c0FjdGl2YXRpb25HYXMkLFxyXG4gIHRzQWN0aXZhdGlvblBvd2VyJCxcclxufSBmcm9tICcuLi8uLi90cm91Ymxlc2hvb3RpbmcvdHJvdWJsZXNob290aW5nJztcclxuaW1wb3J0IHsgT3BlcmF0aXZlTW9kZSB9IGZyb20gJy4uLy4uL3Ryb3VibGVzaG9vdGluZy90eXBlcyc7XHJcbmltcG9ydCB7IFRpcG9Ucm91Ymxlc2hvb3RpbmcgfSBmcm9tICcuL3R5cGVzJztcclxuXHJcbmZ1bmN0aW9uIGNsZWFuUXMocXM6IFVSTFNlYXJjaFBhcmFtcyk6IFFTQ2xlYW5lZCB7XHJcbiAgcmV0dXJuIHtcclxuICAgIGNvbnRhdG9yZVByZXNlbnRlOiBjbGVhblFTSXRlbShxcy5nZXQoJ2NvbnRhdG9yZVByZXNlbnRlJykpLFxyXG4gICAgYXR0YWNjb1ByZXNlbnRlOiBjbGVhblFTSXRlbShxcy5nZXQoJ2F0dGFjY29QcmVzZW50ZScpKSxcclxuICAgIHBkclByZXNlbnRlOiBjbGVhblFTSXRlbShxcy5nZXQoJ3BkclByZXNlbnRlJykpLFxyXG4gICAgaW1waWFudG9Nb2RpZmljYXRvOiBjbGVhblFTSXRlbShxcy5nZXQoJ2ltcGlhbnRvTW9kaWZpY2F0bycpKSxcclxuICAgIGFwZXJ0bzogY2xlYW5RU0l0ZW0ocXMuZ2V0KCdhcGVydG8nKSksXHJcbiAgICBwcmVkaXNwb3NpemlvbmVJbXBpYW50bzogY2xlYW5RU0l0ZW0ocXMuZ2V0KCdwcmVkaXNwb3NpemlvbmVJbXBpYW50bycpKSxcclxuICB9O1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbGVhblFTSXRlbSh2YWx1ZTogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZCkge1xyXG4gIGlmICh2YWx1ZSA9PSBudWxsKSB7XHJcbiAgICB0aHJvdyBFcnJvcignVW4gcGFyYW1ldHJvIG9iYmxpZ2F0b3JpbyBub24gw6ggc3RhdG8gcGFzc2F0by4nKTtcclxuICB9XHJcblxyXG4gIGlmICh2YWx1ZSA9PT0gJ251bGwnIHx8IHZhbHVlID09PSAndHJ1ZScgfHwgdmFsdWUgPT09ICdmYWxzZScpIHtcclxuICAgIHJldHVybiBKU09OLnBhcnNlKHZhbHVlKTtcclxuICB9XHJcblxyXG4gIHRocm93IEVycm9yKCdVbiBwYXJhbWV0cm8gb2JibGlnYXRvcmlvIG5vbiBoYSB1biB2YWxvcmUgdmFsaWRvLicpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRUaXBvVHJvdWJsZVNob290aW5nUG93ZXIocXM6IFFTQ2xlYW5lZCkge1xyXG4gIGNvbnN0IGNoZWNrTnVsbCA9XHJcbiAgICBxcy5hdHRhY2NvUHJlc2VudGUgPT0gbnVsbCAmJlxyXG4gICAgcXMuaW1waWFudG9Nb2RpZmljYXRvID09IG51bGwgJiZcclxuICAgIHFzLnBkclByZXNlbnRlID09IG51bGw7XHJcblxyXG4gIGlmICghY2hlY2tOdWxsKSB7XHJcbiAgICB0aHJvdyBFcnJvcihcclxuICAgICAgJ2F0dGFjY29QcmVzZW50ZSwgaW1waWFudG9Nb2RpZmljYXRvLCBwZHJQcmVzZW50ZSBkb3ZyZWJiZXJvIGVzc2VyZSBudWxsIHBlciB1bmEgZm9ybml0dXJhIFBPV0VSJ1xyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGlmIChxcy5jb250YXRvcmVQcmVzZW50ZSAmJiBxcy5hcGVydG8gJiYgcXMucHJlZGlzcG9zaXppb25lSW1waWFudG8gPT0gbnVsbCkge1xyXG4gICAgcmV0dXJuICdUUk9VQkxFU0hPT1RJTkdfVk9MVFVSQScgYXMgbmV2ZXI7XHJcbiAgfSBlbHNlIGlmIChcclxuICAgIHFzLmNvbnRhdG9yZVByZXNlbnRlICYmXHJcbiAgICAhcXMuYXBlcnRvICYmXHJcbiAgICBxcy5wcmVkaXNwb3NpemlvbmVJbXBpYW50byA9PSBudWxsXHJcbiAgKSB7XHJcbiAgICByZXR1cm4gVGlwb1Ryb3VibGVzaG9vdGluZy5Qb3dlclMwMTtcclxuICB9IGVsc2UgaWYgKFxyXG4gICAgIXFzLmNvbnRhdG9yZVByZXNlbnRlICYmXHJcbiAgICBxcy5hcGVydG8gPT0gbnVsbCAmJlxyXG4gICAgIXFzLnByZWRpc3Bvc2l6aW9uZUltcGlhbnRvXHJcbiAgKSB7XHJcbiAgICByZXR1cm4gVGlwb1Ryb3VibGVzaG9vdGluZy5Qb3dlck4wMjtcclxuICB9IGVsc2UgaWYgKFxyXG4gICAgIXFzLmNvbnRhdG9yZVByZXNlbnRlICYmXHJcbiAgICBxcy5hcGVydG8gPT0gbnVsbCAmJlxyXG4gICAgcXMucHJlZGlzcG9zaXppb25lSW1waWFudG9cclxuICApIHtcclxuICAgIHJldHVybiBUaXBvVHJvdWJsZXNob290aW5nLlBvd2VyQTAxO1xyXG4gIH0gZWxzZSBpZiAocXMuY29udGF0b3JlUHJlc2VudGUgJiYgIXFzLmFwZXJ0byAmJiBxcy5wcmVkaXNwb3NpemlvbmVJbXBpYW50bykge1xyXG4gICAgcmV0dXJuIFRpcG9Ucm91Ymxlc2hvb3RpbmcuUG93ZXJBMDE7XHJcbiAgfVxyXG5cclxuICB0aHJvdyBFcnJvcignSW1wb3NzaWJpbGUgaW5kaXZpZHVhcmUgaWwgdGlwbyB0cm91Ymxlc2hvb3RpbmcuJyk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFRpcG9Ucm91YmxlU2hvb3RpbmdHYXMocXM6IFFTQ2xlYW5lZCkge1xyXG4gIGNvbnN0IGNoZWNrTnVsbCA9IHFzLnByZWRpc3Bvc2l6aW9uZUltcGlhbnRvID09IG51bGw7XHJcblxyXG4gIGlmICghY2hlY2tOdWxsKSB7XHJcbiAgICB0aHJvdyBFcnJvcihcclxuICAgICAgJ3ByZWRpc3Bvc2l6aW9uZUltcGlhbnRvIGRvdnJlYmJlIGVzc2VyZSBudWxsIHBlciB1bmEgZm9ybml0dXJhIEdBUydcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBpZiAoXHJcbiAgICBxcy5jb250YXRvcmVQcmVzZW50ZSAmJlxyXG4gICAgcXMuYXBlcnRvICYmXHJcbiAgICBxcy5hdHRhY2NvUHJlc2VudGUgPT0gbnVsbCAmJlxyXG4gICAgcXMuaW1waWFudG9Nb2RpZmljYXRvID09IG51bGwgJiZcclxuICAgIHFzLnBkclByZXNlbnRlID09IG51bGxcclxuICApIHtcclxuICAgIHJldHVybiAnVFJPVUJMRVNIT09USU5HX1ZPTFRVUkEnIGFzIG5ldmVyO1xyXG4gIH0gZWxzZSBpZiAoXHJcbiAgICBxcy5jb250YXRvcmVQcmVzZW50ZSAmJlxyXG4gICAgIXFzLmFwZXJ0byAmJlxyXG4gICAgcXMuYXR0YWNjb1ByZXNlbnRlID09IG51bGwgJiZcclxuICAgIHFzLmltcGlhbnRvTW9kaWZpY2F0byAmJlxyXG4gICAgcXMucGRyUHJlc2VudGUgPT0gbnVsbFxyXG4gICkge1xyXG4gICAgcmV0dXJuIFRpcG9Ucm91Ymxlc2hvb3RpbmcuR2FzQTQwX2M7XHJcbiAgfSBlbHNlIGlmIChcclxuICAgIHFzLmNvbnRhdG9yZVByZXNlbnRlICYmXHJcbiAgICAhcXMuYXBlcnRvICYmXHJcbiAgICBxcy5hdHRhY2NvUHJlc2VudGUgPT0gbnVsbCAmJlxyXG4gICAgIXFzLmltcGlhbnRvTW9kaWZpY2F0byAmJlxyXG4gICAgcXMucGRyUHJlc2VudGUgPT0gbnVsbFxyXG4gICkge1xyXG4gICAgcmV0dXJuIFRpcG9Ucm91Ymxlc2hvb3RpbmcuR2FzQTAxX2M7XHJcbiAgfSBlbHNlIGlmIChcclxuICAgICFxcy5jb250YXRvcmVQcmVzZW50ZSAmJlxyXG4gICAgcXMuYXBlcnRvID09IG51bGwgJiZcclxuICAgICFxcy5hdHRhY2NvUHJlc2VudGUgJiZcclxuICAgIHFzLmltcGlhbnRvTW9kaWZpY2F0byA9PSBudWxsICYmXHJcbiAgICBxcy5wZHJQcmVzZW50ZSA9PSBudWxsXHJcbiAgKSB7XHJcbiAgICByZXR1cm4gVGlwb1Ryb3VibGVzaG9vdGluZy5HYXNQTjE7XHJcbiAgfSBlbHNlIGlmIChcclxuICAgICFxcy5jb250YXRvcmVQcmVzZW50ZSAmJlxyXG4gICAgcXMuYXBlcnRvID09IG51bGwgJiZcclxuICAgIHFzLmF0dGFjY29QcmVzZW50ZSAmJlxyXG4gICAgcXMuaW1waWFudG9Nb2RpZmljYXRvICYmXHJcbiAgICBxcy5wZHJQcmVzZW50ZVxyXG4gICkge1xyXG4gICAgcmV0dXJuIFRpcG9Ucm91Ymxlc2hvb3RpbmcuR2FzQTQwX247XHJcbiAgfSBlbHNlIGlmIChcclxuICAgICFxcy5jb250YXRvcmVQcmVzZW50ZSAmJlxyXG4gICAgcXMuYXBlcnRvID09IG51bGwgJiZcclxuICAgIHFzLmF0dGFjY29QcmVzZW50ZSAmJlxyXG4gICAgIXFzLmltcGlhbnRvTW9kaWZpY2F0byAmJlxyXG4gICAgcXMucGRyUHJlc2VudGVcclxuICApIHtcclxuICAgIHJldHVybiBUaXBvVHJvdWJsZXNob290aW5nLkdhc0EwMV9uO1xyXG4gIH0gZWxzZSBpZiAoXHJcbiAgICAhcXMuY29udGF0b3JlUHJlc2VudGUgJiZcclxuICAgIHFzLmFwZXJ0byA9PSBudWxsICYmXHJcbiAgICBxcy5hdHRhY2NvUHJlc2VudGUgJiZcclxuICAgIHFzLmltcGlhbnRvTW9kaWZpY2F0byA9PSBudWxsICYmXHJcbiAgICAhcXMucGRyUHJlc2VudGVcclxuICApIHtcclxuICAgIHJldHVybiBUaXBvVHJvdWJsZXNob290aW5nLkdhc1BOMV87XHJcbiAgfVxyXG5cclxuICB0aHJvdyBFcnJvcignSW1wb3NzaWJpbGUgaW5kaXZpZHVhcmUgaWwgdGlwbyB0cm91Ymxlc2hvb3RpbmcuJyk7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCB0aXBvVHJvdWJsZXNob290aW5nR2FzJCA9IGF0b20oKGdldCkgPT4ge1xyXG4gIGNvbnN0IG9wZXJhdGl2ZU1vZGUgPSBnZXQob3BlcmF0aXZlTW9kZUF0b20pO1xyXG4gIGlmIChvcGVyYXRpdmVNb2RlICE9PSBPcGVyYXRpdmVNb2RlLk5FV19BQ1RJVkFUSU9OKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIGlmICghZ2V0KGdhc0F0b20pKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICByZXR1cm4gKFxyXG4gICAgdHJ5T3IoKCkgPT4gZ2V0VGlwb1Ryb3VibGVTaG9vdGluZ0dhcyhjbGVhblFzKGdldFNlYXJjaFBhcmFtc0Zyb21VcmwoKSkpKSB8fFxyXG4gICAgdHJ5T3IoKCkgPT5cclxuICAgICAgZ2V0VGlwb1Ryb3VibGVTaG9vdGluZ0dhcyhcclxuICAgICAgICBjbGVhblFzKGdldFF1ZXJ5c3RyaW5nRnJvbUFuc3dlcnNHYXMoZ2V0KHRzQWN0aXZhdGlvbkdhcyQpKSlcclxuICAgICAgKVxyXG4gICAgKVxyXG4gICk7XHJcbn0pO1xyXG5cclxuZXhwb3J0IGNvbnN0IHRpcG9Ucm91Ymxlc2hvb3RpbmdQb3dlciQgPSBhdG9tKChnZXQpID0+IHtcclxuICBjb25zdCBvcGVyYXRpdmVNb2RlID0gZ2V0KG9wZXJhdGl2ZU1vZGVBdG9tKTtcclxuICBpZiAob3BlcmF0aXZlTW9kZSAhPT0gT3BlcmF0aXZlTW9kZS5ORVdfQUNUSVZBVElPTikge1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBpZiAoIWdldChwb3dlckF0b20pKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICByZXR1cm4gKFxyXG4gICAgdHJ5T3IoKCkgPT5cclxuICAgICAgZ2V0VGlwb1Ryb3VibGVTaG9vdGluZ1Bvd2VyKGNsZWFuUXMoZ2V0U2VhcmNoUGFyYW1zRnJvbVVybCgpKSlcclxuICAgICkgfHxcclxuICAgIHRyeU9yKCgpID0+XHJcbiAgICAgIGdldFRpcG9Ucm91YmxlU2hvb3RpbmdQb3dlcihcclxuICAgICAgICBjbGVhblFzKGdldFF1ZXJ5c3RyaW5nRnJvbUFuc3dlcnNQb3dlcihnZXQodHNBY3RpdmF0aW9uUG93ZXIkKSkpXHJcbiAgICAgIClcclxuICAgIClcclxuICApO1xyXG59KTtcclxuXHJcbmV4cG9ydCBjb25zdCB0aXBvVHJvdWJsZXNob290aW5nJCA9IGF0b20oKGdldCkgPT4ge1xyXG4gIGNvbnN0IG9wZXJhdGl2ZU1vZGUgPSBnZXQob3BlcmF0aXZlTW9kZUF0b20pO1xyXG4gIGlmIChvcGVyYXRpdmVNb2RlICE9PSBPcGVyYXRpdmVNb2RlLk5FV19BQ1RJVkFUSU9OKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBjb25zdCBwb3dlciA9ICEhZ2V0KHBvd2VyQXRvbSk7XHJcbiAgY29uc3QgZ2FzID0gISFnZXQoZ2FzQXRvbSk7XHJcbiAgLy8gUGVyIG9yYSBub24gc3VwcG9ydGlhbW8gbGUgRFVBTFxyXG4gIGlmIChwb3dlciAmJiBnYXMpIHtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIHJldHVybiBwb3dlciA/IGdldCh0aXBvVHJvdWJsZXNob290aW5nUG93ZXIkKSA6IGdldCh0aXBvVHJvdWJsZXNob290aW5nR2FzJCk7XHJcbn0pO1xyXG5cclxudHlwZSBWYWx1ZSA9IG51bGwgfCBmYWxzZSB8IHRydWU7XHJcblxyXG50eXBlIFFTQ2xlYW5lZCA9IHtcclxuICBjb250YXRvcmVQcmVzZW50ZTogVmFsdWU7XHJcbiAgYXR0YWNjb1ByZXNlbnRlOiBWYWx1ZTtcclxuICBwZHJQcmVzZW50ZTogVmFsdWU7XHJcbiAgaW1waWFudG9Nb2RpZmljYXRvOiBWYWx1ZTtcclxuICBhcGVydG86IFZhbHVlO1xyXG4gIHByZWRpc3Bvc2l6aW9uZUltcGlhbnRvOiBWYWx1ZTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBvdmVycmlkZGVuVGlwb1Ryb3VibGVzaG9vdGluZ1Bvd2VyJCA9IGF0b208XHJcbiAgVGlwb1Ryb3VibGVzaG9vdGluZyB8IHVuZGVmaW5lZFxyXG4+KCk7XHJcbmV4cG9ydCBjb25zdCBvdmVycmlkZGVuVGlwb1Ryb3VibGVzaG9vdGluZ0dhcyQgPSBhdG9tPFxyXG4gIFRpcG9Ucm91Ymxlc2hvb3RpbmcgfCB1bmRlZmluZWRcclxuPigpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHRpcG9Ucm91Ymxlc2hvb3RpbmdDYWxjb2xhdG8kID0gYXRvbShhc3luYyAoZ2V0KSA9PiB7XHJcbiAgY29uc3QgcG93ZXIgPSBnZXQocG93ZXJBdG9tKTtcclxuICBjb25zdCBnYXMgPSBnZXQoZ2FzQXRvbSk7XHJcblxyXG4gIGlmIChwb3dlciAmJiBnYXMpIHtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIGNvbnN0IHRpcG9Ucm91Ymxlc2hvb3RpbmcgPSBnZXQodGlwb1Ryb3VibGVzaG9vdGluZyQpO1xyXG5cclxuICBpZiAoIXRpcG9Ucm91Ymxlc2hvb3RpbmcpIHtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIGlmIChwb3dlcikge1xyXG4gICAgY29uc3Qgb3ZlcnJpZGRlbiA9IGdldChvdmVycmlkZGVuVGlwb1Ryb3VibGVzaG9vdGluZ1Bvd2VyJCk7XHJcbiAgICBpZiAob3ZlcnJpZGRlbikge1xyXG4gICAgICByZXR1cm4gb3ZlcnJpZGRlbjtcclxuICAgIH1cclxuICB9XHJcbiAgaWYgKGdhcykge1xyXG4gICAgY29uc3Qgb3ZlcnJpZGRlbiA9IGdldChvdmVycmlkZGVuVGlwb1Ryb3VibGVzaG9vdGluZ0dhcyQpO1xyXG4gICAgaWYgKG92ZXJyaWRkZW4pIHtcclxuICAgICAgcmV0dXJuIG92ZXJyaWRkZW47XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXR1cm4gdGlwb1Ryb3VibGVzaG9vdGluZztcclxufSk7XHJcbiJdLCJmaWxlIjoiQzovVXNlcnMvYWludHJvbmEvRGVza3RvcC9BcHAvcmVhY3QvbmFqL2xpYnMvZGF0YS1hY2Nlc3Mvc3JjL2xpYi9hdG9tcy9hY3RpdmF0aW9ucy90aXBvLXRyb3VibGVzaG9vdGluZy50cyJ9