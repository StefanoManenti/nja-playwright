import { createHotContext as __vite__createHotContext } from "/@vite/client";import.meta.hot = __vite__createHotContext("/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/ui-atoms/src/lib/CalendarField.tsx");import __vite__cjsImport0_react_jsxDevRuntime from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/node_modules/.vite/apps/naj/deps/react_jsx-dev-runtime.js?v=0189a8d1"; const jsxDEV = __vite__cjsImport0_react_jsxDevRuntime["jsxDEV"];
import RefreshRuntime from "/@react-refresh";
const inWebWorker = typeof WorkerGlobalScope !== "undefined" && self instanceof WorkerGlobalScope;
let prevRefreshReg;
let prevRefreshSig;
if (import.meta.hot && !inWebWorker) {
  if (!window.__vite_plugin_react_preamble_installed__) {
    throw new Error("@vitejs/plugin-react can't detect preamble. Something is wrong. See https://github.com/vitejs/vite-plugin-react/pull/11#discussion_r430879201");
  }
  prevRefreshReg = window.$RefreshReg$;
  prevRefreshSig = window.$RefreshSig$;
  window.$RefreshReg$ = (type, id) => {
    RefreshRuntime.register(type, "C:/Users/aintrona/Desktop/App/react/naj/libs/ui-atoms/src/lib/CalendarField.tsx " + id);
  };
  window.$RefreshSig$ = RefreshRuntime.createSignatureFunctionForTransform;
}
var _s = $RefreshSig$();
globalThis.jotaiAtomCache = globalThis.jotaiAtomCache || { cache: /* @__PURE__ */ new Map(), get(name, inst) {
  if (this.cache.has(name)) {
    return this.cache.get(name);
  }
  this.cache.set(name, inst);
  return inst;
} };
import { CloseIcon, SvgIcon } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/ui-icons/src/index.ts";
import clsx from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/node_modules/.vite/apps/naj/deps/clsx.js?v=0189a8d1";
import __vite__cjsImport5_react from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/node_modules/.vite/apps/naj/deps/react.js?v=0189a8d1"; const useEffect = __vite__cjsImport5_react["useEffect"]; const useRef = __vite__cjsImport5_react["useRef"]; const useState = __vite__cjsImport5_react["useState"];
import Calendar from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/node_modules/.vite/apps/naj/deps/react-calendar.js?v=0189a8d1";
import "/@fs/C:/Users/aintrona/Desktop/App/react/naj/node_modules/react-calendar/dist/Calendar.css";
import calendarClasses from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/ui-atoms/src/lib/CalendarField.module.less";
import { FormHelperText } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/ui-atoms/src/lib/FormHelperText.tsx";
import { TextField } from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/ui-atoms/src/lib/TextField.tsx";
import classes from "/@fs/C:/Users/aintrona/Desktop/App/react/naj/libs/ui-atoms/src/lib/TextField.module.less";
const formatDate = (date) => date.toLocaleDateString("it-IT");
const parseDate = (str) => {
  if (!str) return null;
  const [day, month, year] = str.split("/").map(Number);
  if (!day || !month || !year) return null;
  const date = new Date(year, month - 1, day);
  return isNaN(date.getTime()) ? null : date;
};
const DATE_LENGTH = 10;
const hideAfter = 250;
export function CalendarField({
  value,
  onChange,
  onBlur,
  error,
  label,
  placeholder,
  helperText,
  readOnly = true,
  showClear,
  ...calendarProps
}) {
  _s();
  const [show, setShow] = useState(false);
  const inputRef = useRef(null);
  const [inputValue, setInputValue] = useState(value ?? "");
  useEffect(() => {
    setInputValue(value ?? "");
  }, [value]);
  const parsedDate = value ? parseDate(value) : null;
  const previousValue = useRef("");
  const handleInputChange = (event) => {
    let value2 = event.target.value;
    const isBackspace = previousValue.current.length > value2.length && previousValue.current.startsWith(value2);
    value2 = value2.replace(/[^0-9/]/g, "");
    if (isBackspace && previousValue.current[value2.length] === "/") {
      value2 = value2.slice(0, -1);
    }
    if (value2.length > DATE_LENGTH) {
      value2 = value2.slice(0, DATE_LENGTH);
    } else if (!isBackspace) {
      if (value2.length === 2 || value2.length === 5) {
        value2 += "/";
      }
    }
    const parts = value2.split("/");
    const day = parts[0] ? parseInt(parts[0], 10) : NaN;
    const month = parts[1] ? parseInt(parts[1], 10) : NaN;
    if (!isNaN(day) && (day < 1 || day > 31)) {
      value2 = previousValue.current;
    }
    if (!isNaN(month) && (month < 1 || month > 12)) {
      value2 = previousValue.current;
    }
    event.target.value = value2;
    previousValue.current = value2;
    setInputValue(value2);
    if (value2.length === DATE_LENGTH) {
      const parsed = parseDate(value2);
      if (parsed) {
        onChange(formatDate(parsed));
      } else {
        onChange(value2);
      }
    } else {
      onChange(value2);
    }
  };
  return /* @__PURE__ */ jsxDEV("div", { className: calendarClasses.calendarWrapper, children: [
    /* @__PURE__ */ jsxDEV("div", { className: clsx(classes.root, [error && classes.error]), children: [
      /* @__PURE__ */ jsxDEV(
        TextField,
        {
          label,
          placeholder,
          autoComplete: "off",
          ref: inputRef,
          type: "text",
          readOnly,
          value: inputValue,
          onChange: !readOnly ? handleInputChange : void 0,
          onFocus: () => setShow(true),
          endAdornment: showClear && value && /* @__PURE__ */ jsxDEV(
            "button",
            {
              onClick: () => {
                onChange("");
                setInputValue("");
              },
              type: "button",
              className: calendarClasses.btnNoStyle,
              children: /* @__PURE__ */ jsxDEV(CloseIcon, {}, void 0, false, {
                fileName: "C:/Users/aintrona/Desktop/App/react/naj/libs/ui-atoms/src/lib/CalendarField.tsx",
                lineNumber: 153,
                columnNumber: 17
              }, this)
            },
            void 0,
            false,
            {
              fileName: "C:/Users/aintrona/Desktop/App/react/naj/libs/ui-atoms/src/lib/CalendarField.tsx",
              lineNumber: 145,
              columnNumber: 11
            },
            this
          ),
          onBlur: () => {
            setTimeout(() => {
              if (onBlur) onBlur();
            }, hideAfter);
          },
          className: clsx([error && classes.error])
        },
        void 0,
        false,
        {
          fileName: "C:/Users/aintrona/Desktop/App/react/naj/libs/ui-atoms/src/lib/CalendarField.tsx",
          lineNumber: 132,
          columnNumber: 9
        },
        this
      ),
      helperText && /* @__PURE__ */ jsxDEV(FormHelperText, { error, children: helperText }, void 0, false, {
        fileName: "C:/Users/aintrona/Desktop/App/react/naj/libs/ui-atoms/src/lib/CalendarField.tsx",
        lineNumber: 167,
        columnNumber: 9
      }, this)
    ] }, void 0, true, {
      fileName: "C:/Users/aintrona/Desktop/App/react/naj/libs/ui-atoms/src/lib/CalendarField.tsx",
      lineNumber: 131,
      columnNumber: 7
    }, this),
    show && /* @__PURE__ */ jsxDEV("div", { className: calendarClasses.calendarContainer, children: /* @__PURE__ */ jsxDEV(
      Calendar,
      {
        className: calendarClasses.calendar,
        onChange: (val) => {
          if (val instanceof Date) {
            const formatted = formatDate(val);
            onChange(formatted);
            setInputValue(formatted);
            setShow(false);
            if (onBlur) onBlur();
          }
        },
        value: parsedDate ?? void 0,
        ...calendarProps,
        next2Label: null,
        prev2Label: null,
        nextLabel: /* @__PURE__ */ jsxDEV(NextIcon, {}, void 0, false, {
          fileName: "C:/Users/aintrona/Desktop/App/react/naj/libs/ui-atoms/src/lib/CalendarField.tsx",
          lineNumber: 187,
          columnNumber: 22
        }, this),
        prevLabel: /* @__PURE__ */ jsxDEV(NextIcon, {}, void 0, false, {
          fileName: "C:/Users/aintrona/Desktop/App/react/naj/libs/ui-atoms/src/lib/CalendarField.tsx",
          lineNumber: 188,
          columnNumber: 22
        }, this)
      },
      void 0,
      false,
      {
        fileName: "C:/Users/aintrona/Desktop/App/react/naj/libs/ui-atoms/src/lib/CalendarField.tsx",
        lineNumber: 172,
        columnNumber: 11
      },
      this
    ) }, void 0, false, {
      fileName: "C:/Users/aintrona/Desktop/App/react/naj/libs/ui-atoms/src/lib/CalendarField.tsx",
      lineNumber: 171,
      columnNumber: 7
    }, this)
  ] }, void 0, true, {
    fileName: "C:/Users/aintrona/Desktop/App/react/naj/libs/ui-atoms/src/lib/CalendarField.tsx",
    lineNumber: 130,
    columnNumber: 5
  }, this);
}
_s(CalendarField, "N51svqQtxs6zBnxgGBUQQ+59wI4=");
_c = CalendarField;
function NextIcon(props) {
  return /* @__PURE__ */ jsxDEV(SvgIcon, { ...props, viewBox: "0 0 24 24", children: /* @__PURE__ */ jsxDEV("path", { d: "M8.19427 22.5424C7.82124 22.8976 7.23761 22.8831 6.88212 22.5117C6.70213 22.3382 6.6001 22.0967 6.6001 21.8439C6.6001 21.5924 6.70213 21.3509 6.88212 21.1774L16.2835 11.9987L6.88212 2.82C6.70213 2.64653 6.6001 2.40499 6.6001 2.1535C6.6001 1.90076 6.70213 1.65922 6.88212 1.48575C7.04782 1.29609 7.28862 1.19234 7.53758 1.20022C7.77961 1.20189 8.01265 1.29111 8.19427 1.45504L18.3148 11.2998H18.3132C18.4964 11.4849 18.6001 11.736 18.6001 11.9987C18.6001 12.2614 18.4964 12.5125 18.3132 12.6976L8.19427 22.5424Z" }, void 0, false, {
    fileName: "C:/Users/aintrona/Desktop/App/react/naj/libs/ui-atoms/src/lib/CalendarField.tsx",
    lineNumber: 199,
    columnNumber: 7
  }, this) }, void 0, false, {
    fileName: "C:/Users/aintrona/Desktop/App/react/naj/libs/ui-atoms/src/lib/CalendarField.tsx",
    lineNumber: 198,
    columnNumber: 5
  }, this);
}
_c2 = NextIcon;
var _c, _c2;
$RefreshReg$(_c, "CalendarField");
$RefreshReg$(_c2, "NextIcon");
if (import.meta.hot && !inWebWorker) {
  window.$RefreshReg$ = prevRefreshReg;
  window.$RefreshSig$ = prevRefreshSig;
}
if (import.meta.hot && !inWebWorker) {
  RefreshRuntime.__hmr_import(import.meta.url).then((currentExports) => {
    RefreshRuntime.registerExportsForReactRefresh("C:/Users/aintrona/Desktop/App/react/naj/libs/ui-atoms/src/lib/CalendarField.tsx", currentExports);
    import.meta.hot.accept((nextExports) => {
      if (!nextExports) return;
      const invalidateMessage = RefreshRuntime.validateRefreshBoundaryAndEnqueueUpdate(currentExports, nextExports);
      if (invalidateMessage) import.meta.hot.invalidate(invalidateMessage);
    });
  });
}

//# sourceMappingURL=data:application/json;base64,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QUFBO0FBQUE7QUFBQSxXQW1CQTtBQUFBLE9BNURKO0FBQUE7QUFBQTtBQUFBO0FBQUEsU0E4REE7QUFFSjtBQUFDQyxHQTNJZVgsZUFBYTtBQUFBeUMsS0FBYnpDO0FBNkloQixTQUFTMEMsU0FBU0MsT0FBb0M7QUFDcEQsU0FDRSx1QkFBQyxXQUFRLEdBQUlBLE9BQU8sU0FBUSxhQUMxQixpQ0FBQyxVQUFLLEdBQUUsb2dCQUFSO0FBQUE7QUFBQTtBQUFBO0FBQUEsU0FBd2dCLEtBRDFnQjtBQUFBO0FBQUE7QUFBQTtBQUFBLFNBRUE7QUFFSjtBQUFDQyxNQU5RRjtBQUFRLElBQUFELElBQUFHO0FBQUFDLGFBQUFKLElBQUE7QUFBQUksYUFBQUQsS0FBQSIsIm5hbWVzIjpbIkNsb3NlSWNvbiIsImNsc3giLCJ1c2VFZmZlY3QiLCJ1c2VSZWYiLCJ1c2VTdGF0ZSIsIkNhbGVuZGFyIiwiY2FsZW5kYXJDbGFzc2VzIiwiRm9ybUhlbHBlclRleHQiLCJUZXh0RmllbGQiLCJjbGFzc2VzIiwiZm9ybWF0RGF0ZSIsImRhdGUiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJwYXJzZURhdGUiLCJzdHIiLCJkYXkiLCJtb250aCIsInllYXIiLCJzcGxpdCIsIm1hcCIsIk51bWJlciIsIkRhdGUiLCJpc05hTiIsImdldFRpbWUiLCJEQVRFX0xFTkdUSCIsImhpZGVBZnRlciIsIkNhbGVuZGFyRmllbGQiLCJ2YWx1ZSIsIm9uQ2hhbmdlIiwib25CbHVyIiwiZXJyb3IiLCJsYWJlbCIsInBsYWNlaG9sZGVyIiwiaGVscGVyVGV4dCIsInJlYWRPbmx5Iiwic2hvd0NsZWFyIiwiY2FsZW5kYXJQcm9wcyIsIl9zIiwic2hvdyIsInNldFNob3ciLCJpbnB1dFJlZiIsImlucHV0VmFsdWUiLCJzZXRJbnB1dFZhbHVlIiwicGFyc2VkRGF0ZSIsInByZXZpb3VzVmFsdWUiLCJoYW5kbGVJbnB1dENoYW5nZSIsImV2ZW50IiwidGFyZ2V0IiwiaXNCYWNrc3BhY2UiLCJjdXJyZW50IiwibGVuZ3RoIiwic3RhcnRzV2l0aCIsInJlcGxhY2UiLCJzbGljZSIsInBhcnRzIiwicGFyc2VJbnQiLCJOYU4iLCJwYXJzZWQiLCJjYWxlbmRhcldyYXBwZXIiLCJyb290IiwidW5kZWZpbmVkIiwiYnRuTm9TdHlsZSIsInNldFRpbWVvdXQiLCJjYWxlbmRhckNvbnRhaW5lciIsImNhbGVuZGFyIiwidmFsIiwiZm9ybWF0dGVkIiwiX2MiLCJOZXh0SWNvbiIsInByb3BzIiwiX2MyIiwiJFJlZnJlc2hSZWckIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VzIjpbIkNhbGVuZGFyRmllbGQudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENsb3NlSWNvbiwgU3ZnSWNvbiB9IGZyb20gJ0BuYWotd28vdWktaWNvbnMnO1xyXG5pbXBvcnQgY2xzeCBmcm9tICdjbHN4JztcclxuaW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCwgdXNlUmVmLCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IENhbGVuZGFyLCB7IENhbGVuZGFyUHJvcHMgfSBmcm9tICdyZWFjdC1jYWxlbmRhcic7XHJcbmltcG9ydCAncmVhY3QtY2FsZW5kYXIvZGlzdC9DYWxlbmRhci5jc3MnO1xyXG5pbXBvcnQgY2FsZW5kYXJDbGFzc2VzIGZyb20gJy4vQ2FsZW5kYXJGaWVsZC5tb2R1bGUubGVzcyc7XHJcbmltcG9ydCB7IEZvcm1IZWxwZXJUZXh0IH0gZnJvbSAnLi9Gb3JtSGVscGVyVGV4dCc7XHJcbmltcG9ydCB7IFRleHRGaWVsZCB9IGZyb20gJy4vVGV4dEZpZWxkJztcclxuaW1wb3J0IGNsYXNzZXMgZnJvbSAnLi9UZXh0RmllbGQubW9kdWxlLmxlc3MnO1xyXG5cclxudHlwZSBQcm9wcyA9IHtcclxuICB2YWx1ZTogc3RyaW5nIHwgbnVsbDtcclxuICBvbkNoYW5nZTogKGRhdGU6IHN0cmluZykgPT4gdm9pZDtcclxuICBvbkJsdXI/OiAoKSA9PiB2b2lkO1xyXG4gIGxhYmVsPzogc3RyaW5nO1xyXG4gIHBsYWNlaG9sZGVyPzogc3RyaW5nO1xyXG4gIGVycm9yPzogYm9vbGVhbjtcclxuICBoZWxwZXJUZXh0Pzogc3RyaW5nO1xyXG4gIHJlYWRPbmx5PzogYm9vbGVhbjtcclxuICBzaG93Q2xlYXI/OiBib29sZWFuO1xyXG59ICYgQ2FsZW5kYXJQcm9wcztcclxuXHJcbmNvbnN0IGZvcm1hdERhdGUgPSAoZGF0ZTogRGF0ZSk6IHN0cmluZyA9PiBkYXRlLnRvTG9jYWxlRGF0ZVN0cmluZygnaXQtSVQnKTtcclxuXHJcbmNvbnN0IHBhcnNlRGF0ZSA9IChzdHI6IHN0cmluZyk6IERhdGUgfCBudWxsID0+IHtcclxuICBpZiAoIXN0cikgcmV0dXJuIG51bGw7XHJcbiAgY29uc3QgW2RheSwgbW9udGgsIHllYXJdID0gc3RyLnNwbGl0KCcvJykubWFwKE51bWJlcik7XHJcbiAgaWYgKCFkYXkgfHwgIW1vbnRoIHx8ICF5ZWFyKSByZXR1cm4gbnVsbDtcclxuICBjb25zdCBkYXRlID0gbmV3IERhdGUoeWVhciwgbW9udGggLSAxLCBkYXkpO1xyXG4gIHJldHVybiBpc05hTihkYXRlLmdldFRpbWUoKSkgPyBudWxsIDogZGF0ZTtcclxufTtcclxuXHJcbmNvbnN0IERBVEVfTEVOR1RIID0gMTA7XHJcbmNvbnN0IGhpZGVBZnRlciA9IDI1MDtcclxuXHJcbi8qKlxyXG4gKiBBIGZpZWxkIHRvIGlucHV0IGEgZGF0ZSBpbiBmb3JtYXQgREQvTU0vWVlZWS5cclxuICogQHBhcmFtIHtvYmplY3R9IHByb3BzXHJcbiAqIEBwYXJhbSB7c3RyaW5nIHwgbnVsbH0gW3Byb3BzLnZhbHVlXSAtIFRoZSBpbnB1dCB2YWx1ZS5cclxuICogQHBhcmFtIHsoZGF0ZTogc3RyaW5nKSA9PiB2b2lkfSBbcHJvcHMub25DaGFuZ2VdIC0gQ2FsbGVkIHdoZW4gdGhlIGlucHV0IHZhbHVlIGNoYW5nZXMuXHJcbiAqIEBwYXJhbSB7KCkgPT4gdm9pZH0gW3Byb3BzLm9uQmx1cl0gLSBDYWxsZWQgd2hlbiB0aGUgaW5wdXQgbG9zZXMgZm9jdXMuXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gW3Byb3BzLmVycm9yXSAtIElmIHRydWUsIHRoZSBmaWVsZCB3aWxsIHNob3cgYW4gZXJyb3Igc3R5bGUuXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBbcHJvcHMubGFiZWxdIC0gVGhlIGlucHV0IGxhYmVsLlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gW3Byb3BzLnBsYWNlaG9sZGVyXSAtIFRoZSBpbnB1dCBwbGFjZWhvbGRlci5cclxuICogQHBhcmFtIHtzdHJpbmd9IFtwcm9wcy5oZWxwZXJUZXh0XSAtIFRoZSBoZWxwZXIgdGV4dCBiZWxvdyB0aGUgaW5wdXQuXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gW3Byb3BzLnJlYWRPbmx5XSAtIElmIHRydWUsIHRoZSBmaWVsZCB3aWxsIGJlIHJlYWQtb25seS5cclxuICogQHBhcmFtIHtib29sZWFufSBbcHJvcHMuc2hvd0NsZWFyXSAtIElmIHRydWUsIHRoZSBmaWVsZCB3aWxsIHNob3cgYSBjbGVhciBidXR0b24uXHJcbiAqIEBwYXJhbSB7b2JqZWN0fSBbcHJvcHMuY2FsZW5kYXJQcm9wc10gLSBQcm9wcyB0byBwYXNzIHRvIHRoZSBgQ2FsZW5kYXJgIGNvbXBvbmVudC5cclxuICogQGV4YW1wbGVcclxuICogPENhbGVuZGFyRmllbGRcclxuICogICB2YWx1ZT17ZGF0ZX1cclxuICogICBvbkNoYW5nZT17KGRhdGUpID0+IHNldERhdGUoZGF0ZSl9XHJcbiAqICAgbGFiZWw9XCJEYXRhIGRpIG5hc2NpdGFcIlxyXG4gKiovXHJcbmV4cG9ydCBmdW5jdGlvbiBDYWxlbmRhckZpZWxkKHtcclxuICB2YWx1ZSxcclxuICBvbkNoYW5nZSxcclxuICBvbkJsdXIsXHJcbiAgZXJyb3IsXHJcbiAgbGFiZWwsXHJcbiAgcGxhY2Vob2xkZXIsXHJcbiAgaGVscGVyVGV4dCxcclxuICByZWFkT25seSA9IHRydWUsXHJcbiAgc2hvd0NsZWFyLFxyXG4gIC4uLmNhbGVuZGFyUHJvcHNcclxufTogUHJvcHMpIHtcclxuICBjb25zdCBbc2hvdywgc2V0U2hvd10gPSB1c2VTdGF0ZShmYWxzZSk7XHJcbiAgY29uc3QgaW5wdXRSZWYgPSB1c2VSZWY8SFRNTElucHV0RWxlbWVudD4obnVsbCk7XHJcbiAgY29uc3QgW2lucHV0VmFsdWUsIHNldElucHV0VmFsdWVdID0gdXNlU3RhdGUodmFsdWUgPz8gJycpO1xyXG5cclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgc2V0SW5wdXRWYWx1ZSh2YWx1ZSA/PyAnJyk7XHJcbiAgfSwgW3ZhbHVlXSk7XHJcblxyXG4gIGNvbnN0IHBhcnNlZERhdGUgPSB2YWx1ZSA/IHBhcnNlRGF0ZSh2YWx1ZSkgOiBudWxsO1xyXG5cclxuICBjb25zdCBwcmV2aW91c1ZhbHVlID0gdXNlUmVmPHN0cmluZz4oJycpO1xyXG4gIGNvbnN0IGhhbmRsZUlucHV0Q2hhbmdlID0gKGV2ZW50OiBSZWFjdC5DaGFuZ2VFdmVudDxIVE1MSW5wdXRFbGVtZW50PikgPT4ge1xyXG4gICAgbGV0IHZhbHVlID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xyXG4gICAgY29uc3QgaXNCYWNrc3BhY2UgPVxyXG4gICAgICBwcmV2aW91c1ZhbHVlLmN1cnJlbnQubGVuZ3RoID4gdmFsdWUubGVuZ3RoICYmXHJcbiAgICAgIHByZXZpb3VzVmFsdWUuY3VycmVudC5zdGFydHNXaXRoKHZhbHVlKTtcclxuXHJcbiAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL1teMC05L10vZywgJycpO1xyXG5cclxuICAgIGlmIChpc0JhY2tzcGFjZSAmJiBwcmV2aW91c1ZhbHVlLmN1cnJlbnRbdmFsdWUubGVuZ3RoXSA9PT0gJy8nKSB7XHJcbiAgICAgIHZhbHVlID0gdmFsdWUuc2xpY2UoMCwgLTEpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh2YWx1ZS5sZW5ndGggPiBEQVRFX0xFTkdUSCkge1xyXG4gICAgICB2YWx1ZSA9IHZhbHVlLnNsaWNlKDAsIERBVEVfTEVOR1RIKTtcclxuICAgIH0gZWxzZSBpZiAoIWlzQmFja3NwYWNlKSB7XHJcbiAgICAgIGlmICh2YWx1ZS5sZW5ndGggPT09IDIgfHwgdmFsdWUubGVuZ3RoID09PSA1KSB7XHJcbiAgICAgICAgdmFsdWUgKz0gJy8nO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcGFydHMgPSB2YWx1ZS5zcGxpdCgnLycpO1xyXG4gICAgY29uc3QgZGF5ID0gcGFydHNbMF0gPyBwYXJzZUludChwYXJ0c1swXSwgMTApIDogTmFOO1xyXG4gICAgY29uc3QgbW9udGggPSBwYXJ0c1sxXSA/IHBhcnNlSW50KHBhcnRzWzFdLCAxMCkgOiBOYU47XHJcblxyXG4gICAgaWYgKCFpc05hTihkYXkpICYmIChkYXkgPCAxIHx8IGRheSA+IDMxKSkge1xyXG4gICAgICB2YWx1ZSA9IHByZXZpb3VzVmFsdWUuY3VycmVudDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIWlzTmFOKG1vbnRoKSAmJiAobW9udGggPCAxIHx8IG1vbnRoID4gMTIpKSB7XHJcbiAgICAgIHZhbHVlID0gcHJldmlvdXNWYWx1ZS5jdXJyZW50O1xyXG4gICAgfVxyXG5cclxuICAgIGV2ZW50LnRhcmdldC52YWx1ZSA9IHZhbHVlO1xyXG4gICAgcHJldmlvdXNWYWx1ZS5jdXJyZW50ID0gdmFsdWU7XHJcblxyXG4gICAgc2V0SW5wdXRWYWx1ZSh2YWx1ZSk7XHJcblxyXG4gICAgaWYgKHZhbHVlLmxlbmd0aCA9PT0gREFURV9MRU5HVEgpIHtcclxuICAgICAgY29uc3QgcGFyc2VkID0gcGFyc2VEYXRlKHZhbHVlKTtcclxuICAgICAgaWYgKHBhcnNlZCkge1xyXG4gICAgICAgIG9uQ2hhbmdlKGZvcm1hdERhdGUocGFyc2VkKSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gRGF0YSBjb21wbGV0YSBtYSBub24gdmFsaWRhIChlcy4gMzEvMDIvMjAyNClcclxuICAgICAgICBvbkNoYW5nZSh2YWx1ZSk7IC8vIGludmlhIGNvbXVucXVlIGlsIHZhbG9yZSBhbCBjb250cm9sbGVyXHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIERhdGEgaW5jb21wbGV0YSwgbWEgaW52aWEgY29tdW5xdWUgaWwgdmFsb3JlIHBlciB0cmlnZ2VyYXJlIHZhbGlkYXppb25lXHJcbiAgICAgIG9uQ2hhbmdlKHZhbHVlKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICByZXR1cm4gKFxyXG4gICAgPGRpdiBjbGFzc05hbWU9e2NhbGVuZGFyQ2xhc3Nlcy5jYWxlbmRhcldyYXBwZXJ9PlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT17Y2xzeChjbGFzc2VzLnJvb3QsIFtlcnJvciAmJiBjbGFzc2VzLmVycm9yXSl9PlxyXG4gICAgICAgIDxUZXh0RmllbGRcclxuICAgICAgICAgIGxhYmVsPXtsYWJlbH1cclxuICAgICAgICAgIHBsYWNlaG9sZGVyPXtwbGFjZWhvbGRlcn1cclxuICAgICAgICAgIGF1dG9Db21wbGV0ZT1cIm9mZlwiXHJcbiAgICAgICAgICByZWY9e2lucHV0UmVmfVxyXG4gICAgICAgICAgdHlwZT1cInRleHRcIlxyXG4gICAgICAgICAgcmVhZE9ubHk9e3JlYWRPbmx5fVxyXG4gICAgICAgICAgdmFsdWU9e2lucHV0VmFsdWV9XHJcbiAgICAgICAgICBvbkNoYW5nZT17IXJlYWRPbmx5ID8gaGFuZGxlSW5wdXRDaGFuZ2UgOiB1bmRlZmluZWR9XHJcbiAgICAgICAgICBvbkZvY3VzPXsoKSA9PiBzZXRTaG93KHRydWUpfVxyXG4gICAgICAgICAgZW5kQWRvcm5tZW50PXtcclxuICAgICAgICAgICAgc2hvd0NsZWFyICYmXHJcbiAgICAgICAgICAgIHZhbHVlICYmIChcclxuICAgICAgICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlKCcnKTtcclxuICAgICAgICAgICAgICAgICAgc2V0SW5wdXRWYWx1ZSgnJyk7XHJcbiAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgdHlwZT1cImJ1dHRvblwiXHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2NhbGVuZGFyQ2xhc3Nlcy5idG5Ob1N0eWxlfVxyXG4gICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgIDxDbG9zZUljb24gLz5cclxuICAgICAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgb25CbHVyPXsoKSA9PiB7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgIC8vIElmIHNldCB0byB0cnVlLCB0aGUgY2FsZW5kYXIgd2lsbCBiZSBoaWRkZW4gd2hlbiBjbGlja2VkIGFsc28gdGhlIG5leHQvcHJldiBidXR0b25cclxuICAgICAgICAgICAgICAvLyBzZXRTaG93KGZhbHNlKTtcclxuICAgICAgICAgICAgICBpZiAob25CbHVyKSBvbkJsdXIoKTtcclxuICAgICAgICAgICAgfSwgaGlkZUFmdGVyKTtcclxuICAgICAgICAgIH19XHJcbiAgICAgICAgICBjbGFzc05hbWU9e2Nsc3goW2Vycm9yICYmIGNsYXNzZXMuZXJyb3JdKX1cclxuICAgICAgICAvPlxyXG4gICAgICAgIHtoZWxwZXJUZXh0ICYmIChcclxuICAgICAgICAgIDxGb3JtSGVscGVyVGV4dCBlcnJvcj17ZXJyb3J9PntoZWxwZXJUZXh0fTwvRm9ybUhlbHBlclRleHQ+XHJcbiAgICAgICAgKX1cclxuICAgICAgPC9kaXY+XHJcbiAgICAgIHtzaG93ICYmIChcclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT17Y2FsZW5kYXJDbGFzc2VzLmNhbGVuZGFyQ29udGFpbmVyfT5cclxuICAgICAgICAgIDxDYWxlbmRhclxyXG4gICAgICAgICAgICBjbGFzc05hbWU9e2NhbGVuZGFyQ2xhc3Nlcy5jYWxlbmRhcn1cclxuICAgICAgICAgICAgb25DaGFuZ2U9eyh2YWwpID0+IHtcclxuICAgICAgICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgRGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkID0gZm9ybWF0RGF0ZSh2YWwpO1xyXG4gICAgICAgICAgICAgICAgb25DaGFuZ2UoZm9ybWF0dGVkKTtcclxuICAgICAgICAgICAgICAgIHNldElucHV0VmFsdWUoZm9ybWF0dGVkKTtcclxuICAgICAgICAgICAgICAgIHNldFNob3coZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG9uQmx1cikgb25CbHVyKCk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICB2YWx1ZT17cGFyc2VkRGF0ZSA/PyB1bmRlZmluZWR9XHJcbiAgICAgICAgICAgIHsuLi5jYWxlbmRhclByb3BzfVxyXG4gICAgICAgICAgICBuZXh0MkxhYmVsPXtudWxsfVxyXG4gICAgICAgICAgICBwcmV2MkxhYmVsPXtudWxsfVxyXG4gICAgICAgICAgICBuZXh0TGFiZWw9ezxOZXh0SWNvbiAvPn1cclxuICAgICAgICAgICAgcHJldkxhYmVsPXs8TmV4dEljb24gLz59XHJcbiAgICAgICAgICAvPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICApfVxyXG4gICAgPC9kaXY+XHJcbiAgKTtcclxufVxyXG5cclxuZnVuY3Rpb24gTmV4dEljb24ocHJvcHM6IFJlYWN0LkNvbXBvbmVudFByb3BzPCdzdmcnPikge1xyXG4gIHJldHVybiAoXHJcbiAgICA8U3ZnSWNvbiB7Li4ucHJvcHN9IHZpZXdCb3g9XCIwIDAgMjQgMjRcIj5cclxuICAgICAgPHBhdGggZD1cIk04LjE5NDI3IDIyLjU0MjRDNy44MjEyNCAyMi44OTc2IDcuMjM3NjEgMjIuODgzMSA2Ljg4MjEyIDIyLjUxMTdDNi43MDIxMyAyMi4zMzgyIDYuNjAwMSAyMi4wOTY3IDYuNjAwMSAyMS44NDM5QzYuNjAwMSAyMS41OTI0IDYuNzAyMTMgMjEuMzUwOSA2Ljg4MjEyIDIxLjE3NzRMMTYuMjgzNSAxMS45OTg3TDYuODgyMTIgMi44MkM2LjcwMjEzIDIuNjQ2NTMgNi42MDAxIDIuNDA0OTkgNi42MDAxIDIuMTUzNUM2LjYwMDEgMS45MDA3NiA2LjcwMjEzIDEuNjU5MjIgNi44ODIxMiAxLjQ4NTc1QzcuMDQ3ODIgMS4yOTYwOSA3LjI4ODYyIDEuMTkyMzQgNy41Mzc1OCAxLjIwMDIyQzcuNzc5NjEgMS4yMDE4OSA4LjAxMjY1IDEuMjkxMTEgOC4xOTQyNyAxLjQ1NTA0TDE4LjMxNDggMTEuMjk5OEgxOC4zMTMyQzE4LjQ5NjQgMTEuNDg0OSAxOC42MDAxIDExLjczNiAxOC42MDAxIDExLjk5ODdDMTguNjAwMSAxMi4yNjE0IDE4LjQ5NjQgMTIuNTEyNSAxOC4zMTMyIDEyLjY5NzZMOC4xOTQyNyAyMi41NDI0WlwiIC8+XHJcbiAgICA8L1N2Z0ljb24+XHJcbiAgKTtcclxufVxyXG4iXSwiZmlsZSI6IkM6L1VzZXJzL2FpbnRyb25hL0Rlc2t0b3AvQXBwL3JlYWN0L25hai9saWJzL3VpLWF0b21zL3NyYy9saWIvQ2FsZW5kYXJGaWVsZC50c3gifQ==